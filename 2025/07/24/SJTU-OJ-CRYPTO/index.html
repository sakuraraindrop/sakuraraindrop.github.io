<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>SJTU-OJ-CRYPTO | cheng_xing's blog</title><meta name="robots" content="noindex"><meta name="author" content="cheng_xing"><meta name="copyright" content="cheng_xing"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="substitution1密文kimaizqaktiaaqkkqxpmz 一眼凯撒，偏移量-8  0ops{caesarisclassiccipher}  substitution2密文 1mnhb krnbd pfz kdudf cdpbk psn nhb mpixdbk qbnhsxi mnbix nf ixjk rnfijfdfi, p fdo fpijnf, rnfrdjudz jf aj">
<meta property="og:type" content="article">
<meta property="og:title" content="SJTU-OJ-CRYPTO">
<meta property="og:url" content="https://sakuraraindrop.github.io/2025/07/24/SJTU-OJ-CRYPTO/index.html">
<meta property="og:site_name" content="cheng_xing&#39;s blog">
<meta property="og:description" content="substitution1密文kimaizqaktiaaqkkqxpmz 一眼凯撒，偏移量-8  0ops{caesarisclassiccipher}  substitution2密文 1mnhb krnbd pfz kdudf cdpbk psn nhb mpixdbk qbnhsxi mnbix nf ixjk rnfijfdfi, p fdo fpijnf, rnfrdjudz jf aj">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://sakuraraindrop.github.io/img/ltx.jpg">
<meta property="article:published_time" content="2025-07-23T16:28:18.000Z">
<meta property="article:modified_time" content="2025-09-19T06:46:27.803Z">
<meta property="article:author" content="cheng_xing">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://sakuraraindrop.github.io/img/ltx.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "SJTU-OJ-CRYPTO",
  "url": "https://sakuraraindrop.github.io/2025/07/24/SJTU-OJ-CRYPTO/",
  "image": "https://sakuraraindrop.github.io/img/ltx.jpg",
  "datePublished": "2025-07-23T16:28:18.000Z",
  "dateModified": "2025-09-19T06:46:27.803Z",
  "author": [
    {
      "@type": "Person",
      "name": "cheng_xing",
      "url": "https://sakuraraindrop.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/ltx-icon.jpg"><link rel="canonical" href="https://sakuraraindrop.github.io/2025/07/24/SJTU-OJ-CRYPTO/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'SJTU-OJ-CRYPTO',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/img/hk.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/ltx.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">61</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">147</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/hk.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/ltx-icon.jpg" alt="Logo"><span class="site-name">cheng_xing's blog</span></a><a class="nav-page-title" href="/"><span class="site-name">SJTU-OJ-CRYPTO</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">SJTU-OJ-CRYPTO</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-07-23T16:28:18.000Z" title="发表于 2025-07-24 00:28:18">2025-07-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-09-19T06:46:27.803Z" title="更新于 2025-09-19 14:46:27">2025-09-19</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h2 id="substitution1"><a href="#substitution1" class="headerlink" title="substitution1"></a>substitution1</h2><p>密文kimaizqaktiaaqkkqxpmz</p>
<p>一眼凯撒，偏移量-8</p>
<blockquote>
<p>0ops{caesarisclassiccipher}</p>
</blockquote>
<h2 id="substitution2"><a href="#substitution2" class="headerlink" title="substitution2"></a>substitution2</h2><p>密文</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mnhb krnbd pfz kdudf cdpbk psn nhb mpixdbk qbnhsxi mnbix nf ixjk rnfijfdfi, p fdo fpijnf, rnfrdjudz jf ajqdbic, pfz zdzjrpidz in ixd vbnvnkjijnf ixpi paa ldf pbd rbdpidz dehpa. fno od pbd dfspsdz jf p sbdpi rjuja opb, idkijfs oxdixdb ixpi fpijnf, nb pfc fpijnf kn rnfrdjudz pfz kn zdzjrpidz, rpf anfs dfzhbd. od pbd ldi nf p sbdpi qpiiad-mjdaz nm ixpi opb. od xpud rnld in zdzjrpid p vnbijnf nm ixpi mjdaz, pk p mjfpa bdkijfs vaprd mnb ixnkd oxn xdbd spud ixdjb ajudk ixpi ixpi fpijnf ljsxi ajud. ji jk painsdixdb mjiijfs pfz vbnvdb ixpi od kxnhaz zn ixjk. qhi, jf p apbsdb kdfkd, od rpf fni zdzjrpid -- od rpf fni rnfkdrbpid -- od rpf fni xpaano -- ixjk sbnhfz. ixd qbpud ldf, ajujfs pfz zdpz, oxn kibhssadz xdbd, xpud rnfkdrbpidz ji, mpb pqnud nhb vnnb vnodb in pzz nb zdibpri. ixd onbaz ojaa ajiiad fnid, fnb anfs bdldlqdb oxpi od kpc xdbd, qhi ji rpf fdudb mnbsdi oxpi ixdc zjz xdbd. ji jk mnb hk ixd ajujfs, bpixdb, in qd zdzjrpidz xdbd in ixd hfmjfjkxdz onby oxjrx ixdc oxn mnhsxi xdbd xpud ixhk mpb kn fnqac pzupfrdz. ji jk bpixdb mnb hk in qd xdbd zdzjrpidz in ixd sbdpi ipky bdlpjfjfs qdmnbd hk -- ixpi mbnl ixdkd xnfnbdz zdpz od ipyd jfrbdpkdz zdunijnf in ixpi rphkd mnb oxjrx ixdc spud ixd apki mhaa ldpkhbd nm zdunijnf -- ixpi od xdbd xjsxac bdknaud ixpi ixdkd zdpz kxpaa fni xpud zjdz jf upjf -- ixpi ixjk fpijnf, hfzdb snz, kxpaa xpud p fdo qjbix nm mbddznl -- pfz ixpi snudbfldfi nm ixd vdnvad, qc ixd vdnvad, mnb ixd vdnvad, kxpaa fni vdbjkx mbnl ixd dpbix. 0nvk&#123;zncnhyfnoehjvejhv&#125;</span><br></pre></td></tr></table></figure>

<p>用 <code>https://www.quipqiup.com/</code> 去解</p>
<blockquote>
<p>0ops{doyouknowquipqiup}</p>
</blockquote>
<h2 id="easyrsa0"><a href="#easyrsa0" class="headerlink" title="easyrsa0"></a>easyrsa0</h2><p>最基本的rsa,factordb直接分解n即可</p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">9589753</span></span><br><span class="line">q = <span class="number">10338697</span></span><br><span class="line">n = <span class="number">99145550571841</span></span><br><span class="line">phin = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">c = <span class="number">96034585716955</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e, phin)</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line">plain = gmpy2.powmod(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(plain)</span><br><span class="line"><span class="comment"># print(long_to_bytes(plain))</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{9407222675465}</p>
</blockquote>
<h2 id="easyrsa1"><a href="#easyrsa1" class="headerlink" title="easyrsa1"></a>easyrsa1</h2><p>跟上题一样，factordb直接分</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">12403119145035876589</span></span><br><span class="line">q = <span class="number">18346637734095243361</span></span><br><span class="line">n = <span class="number">227555533726794346965771272677917575629</span></span><br><span class="line">phin = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">c = <span class="number">77962178294800447517109647217867140264</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e, phin)</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line">plain = gmpy2.powmod(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(plain)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(plain))</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{e4syr5a}</p>
</blockquote>
<h2 id="easyrsa2"><a href="#easyrsa2" class="headerlink" title="easyrsa2"></a>easyrsa2</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">n1 = p*q1</span><br><span class="line">n2 = p*q2</span><br><span class="line"></span><br><span class="line">c1 = pow(plain,e,n1)</span><br><span class="line">c2 = pow(plain,e,n2)</span><br></pre></td></tr></table></figure>

<p>考点是模不互素<br>这个题目就是两个n然后共用一个e，之后是两个密文<br>适用情况：存在两个或更多模数 ，且gcd(n1,n2)!&#x3D;1。</p>
<p>多个模数n共用质数，则可以很容易利用欧几里得算法求得他们的质因数之一gcd(n1,n2)，然后这个最大公约数可用于分解模数分别得到对应的p和q，即可进行解密</p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gcd2</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">while</span> b:</span><br><span class="line">        a, b = b, a % b</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line">n1 = <span class="number">21625767443834708096392892774328189860060754513275908028294345510420748194882754018911203211362465558586841976381462873050507360801589039235225244082861166319421979738914186892059484949806535554062245253290330123467048783996350636737484343200878982965010131888563619327893974949388881839482558198830741967610439000572011923123876379403738941985909738971550788386512445557542800980441366295263755736400304268528932309073258918565257197792854745240731544461809947995313207112589526702135980331727235588684479165739087173548415428301099311329764446094053941555927350556594367931954161510533802388893190150143476189275393</span></span><br><span class="line">n2 = <span class="number">26629903094385504764016909443409440503392051524586912519597893563563297677800068252417563000066625886816831290393257888364686548009896341377711253700833856016132614499610667903607411733290993726531341114084468723501090090898946115455615353557624138622136680633395103564143733038564582110915400971683855988428281340374200014871264412462251570943112747478146356686492417714007058334474156965534105390581279833973886172957494107258660671021681564187435357831530059948085586399278807784992444109077817573529005275345216868236241563652007778799266646895973151043268869280114681696296070427187113676256969001206934835016119</span></span><br><span class="line">p = gcd2(n1, n2)</span><br><span class="line"></span><br><span class="line">n = <span class="number">21625767443834708096392892774328189860060754513275908028294345510420748194882754018911203211362465558586841976381462873050507360801589039235225244082861166319421979738914186892059484949806535554062245253290330123467048783996350636737484343200878982965010131888563619327893974949388881839482558198830741967610439000572011923123876379403738941985909738971550788386512445557542800980441366295263755736400304268528932309073258918565257197792854745240731544461809947995313207112589526702135980331727235588684479165739087173548415428301099311329764446094053941555927350556594367931954161510533802388893190150143476189275393</span></span><br><span class="line">q = n // p</span><br><span class="line">phin = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">c = <span class="number">12408521460040906074903008129253214511313955982369572572378807879003652364607583433934403618446464622106226719761372913545977650067660558570358767123913911001606976678088871380795122148597703637472036818261910162601161832688068707339174728964646835582567018577569304986673611166308460783283079267934444437498306288110384721630660839496521202874607212943186863048868135138638892192552534284066892219914416489820201538990526683122691861843227110129439573745449696104197613972776487415717190140123206282079768975376386520023946954548690492705029991264775133912518497214239596673394194613017839709460353541562603273838114</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = gmpy2.invert(e, phin)</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line">plain = gmpy2.powmod(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(plain)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(plain))</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{n0_common_d1vi5or}</p>
</blockquote>
<h2 id="easyrsa3"><a href="#easyrsa3" class="headerlink" title="easyrsa3"></a>easyrsa3</h2><p>给了n和c，e&#x3D;3</p>
<p>考点是低加密指数攻击（e很小）<br>适用情况：n很大但是e很小，一般e&#x3D;3</p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">de</span>(<span class="params">c, e, n</span>):</span><br><span class="line">    k = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        m = c + n*k</span><br><span class="line">        result, flag = gmpy2.iroot(m, e)</span><br><span class="line">        <span class="keyword">if</span> <span class="literal">True</span> == flag:</span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line">        k += <span class="number">1</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">n = <span class="number">16477140917959022317790766413839731704430228097732029109496328701195745766077928135487358329928598956176328155003460918273499589398227276937994548242743758902585813828450818525269657999844216782007329684712692781267880216564688706263345808564578390297763780460146030570264595536971605193094889545124425707997199050612558975655064826212413858388418029690673585861270965456589875110250957880664465654682818419077200601860425302339065277171055170386127747819090266634956257661384162058718344377192899487571887352391501656278597515363229214610705628070917190045895498676190079875870068682428502660966554571915340197741523</span></span><br><span class="line">c = <span class="number">9122523617404508528563973400630277772267716397477859985745199677249085475329951281085905171128124020133403141158580251233992194316316747975295280288252341933678256601121909864165977903767578159596123525667847654842824460662940955815349327438423880559899750450497421732571549759213896853825175374922855669941381411476365695727881736283465791492633463804853263016197663065298640746076399525663204249797392795220160367352416148155823571997194470898275676259945645609614617322956393424465482163796758241488297580219760298689887439890545267155107132860250431556815725439764832676543159738161168291455039344758377983743827</span></span><br><span class="line"> </span><br><span class="line">m = de(c,e,n)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{5m4ll_3xpon3nt_i5_s0000000000000_W3ak}</p>
</blockquote>
<h2 id="easyrsa4"><a href="#easyrsa4" class="headerlink" title="easyrsa4"></a>easyrsa4</h2><p>给了n,c,e，但是</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = gmpy2.next_prime(p+<span class="number">0xdddd</span>)</span><br></pre></td></tr></table></figure>

<p>那么相邻质数可以用fermat分解<br>fermat.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">factor</span>(<span class="params">n</span>):</span><br><span class="line">    a = gmpy2.iroot(n, <span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        B2 = <span class="built_in">pow</span>(a, <span class="number">2</span>) - n</span><br><span class="line">        <span class="keyword">if</span> gmpy2.is_square(B2):</span><br><span class="line">            b = gmpy2.iroot(B2, <span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">            p = a + b</span><br><span class="line">            q = a - b</span><br><span class="line">            <span class="keyword">return</span> p, q</span><br><span class="line">        a += <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">n = <span class="number">30476923628485893137508140138279153348450538574944005428720380356862264977366950869213544766851682426640749288627561569612545396727392957440729808721587134909385668734954872806639453514605837342839370575249796396036438855514362909700661397748748394532623677198552761538331564771410506657907789412718823498857091633159939346074095917138524993541714305025148220175932960161048253918835684902023773154185229174448722038746273595422584206255273361677943153693302811452372398891911826515065149720999563475451163550067374787975227584938787641072811827513366882467945719394005911195215083790033217705306156714733815829192329</span></span><br><span class="line"><span class="built_in">print</span>(factor(n))</span><br><span class="line"></span><br><span class="line"><span class="comment"># (mpz(174576412004846442649665214026516535830715350459074333733578473253261558544066118085875454229781671076851723600853495490153971634992897647768902085910556837325655755065356589911733146341368734012191614874360673666837987382304905555658286064331966161418824735205836665185987469195485959439175292131959906115453), mpz(174576412004846442649665214026516535830715350459074333733578473253261558544066118085875454229781671076851723600853495490153971634992897647768902085910556837325655755065356589911733146341368734012191614874360673666837987382304905555658286064331966161418824735205836665185987469195485959439175292131959906058493))</span></span><br></pre></td></tr></table></figure>

<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">174576412004846442649665214026516535830715350459074333733578473253261558544066118085875454229781671076851723600853495490153971634992897647768902085910556837325655755065356589911733146341368734012191614874360673666837987382304905555658286064331966161418824735205836665185987469195485959439175292131959906115453</span></span><br><span class="line">q = <span class="number">174576412004846442649665214026516535830715350459074333733578473253261558544066118085875454229781671076851723600853495490153971634992897647768902085910556837325655755065356589911733146341368734012191614874360673666837987382304905555658286064331966161418824735205836665185987469195485959439175292131959906058493</span></span><br><span class="line">n = <span class="number">30476923628485893137508140138279153348450538574944005428720380356862264977366950869213544766851682426640749288627561569612545396727392957440729808721587134909385668734954872806639453514605837342839370575249796396036438855514362909700661397748748394532623677198552761538331564771410506657907789412718823498857091633159939346074095917138524993541714305025148220175932960161048253918835684902023773154185229174448722038746273595422584206255273361677943153693302811452372398891911826515065149720999563475451163550067374787975227584938787641072811827513366882467945719394005911195215083790033217705306156714733815829192329</span></span><br><span class="line">phin = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">c = <span class="number">490928852586008274258134550938009540736044480462359519066805288734663724363395921807813043268507445016018950549657391415266153189513695009046003157308855349271903564984633016007202890672335501364055225225635692614605244187549740009111241693024453318117075239763738029284525594352325334256350880651112431148461710631670987967767418352945350322193479278813456759673612994327181670229814993296529571959465986009615071645703328286206411414690527782242637865045298729770412388773616971282385924326597931710877319406430760195191273062731582947106605791837940142655616540331853170697543746618218840245684178098376668077548</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e, phin)</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line">plain = gmpy2.powmod(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(plain)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(plain))</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{f3rm4t_1s_useFull}</p>
</blockquote>
<h2 id="easyrsa5"><a href="#easyrsa5" class="headerlink" title="easyrsa5"></a>easyrsa5</h2><p>给了3组n和c，e&#x3D;3</p>
<p>考点是低指数加密广播攻击（e很小;多组n,c）<br>适用情况：很多组不同的n和c，但用的是同一个e且很小。</p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy.ntheory.modular <span class="keyword">import</span> crt</span><br><span class="line"> </span><br><span class="line">n1 = <span class="number">10256130058275655830488031920465885128421290884493232641785438342004335682420203521313857881525404338312898461203087746526934825891296526658513296139544193679845726105481115968920853671518433548349006827650322983569601327515948610151743212113126847067674922296152762633842814836279952169020441058531336286542463617368862329921871179709400507681394373629617745305537616392328158108235533235365602918821582696943326207074948319471296971108528795058779490067296526800713392761368195225129900089643292021618063793317365199815089558781197828806231859862396250927314598896375132910232014824208896622424736679658766887817401</span></span><br><span class="line">c1 = <span class="number">5507446216880917455462986489650261956301468877547432802130520031412839216535657779413177203125680342007742717021317723658728367984167580557768480248356644886233992803250502940306862707504025474593016768629786360864326235789499984217028266913595154263818377333592891167255297227636407842596395236777128844380892790285971246316812253738182860134415359799876446780829412729638583306360182550835438433245134309547159915847584792074034290675737940971731871711439015937686472475388074953779468870933842620884043621250798717170751349869832339163188944678820106139974943434340377783874809925817476704262229926780378472381264</span></span><br><span class="line"></span><br><span class="line">n2 = <span class="number">15357578724599441993052401751254651768481226024360438680042082688746744984656195498564049585286967649904438731805537194327459563805608835272799188739485382895816810453745538422540704119249871226712213262980469497039696882878442369221975896449360553423927481112986022428753102255139680939078284320066019619106489955079569365075102141410117191999624242236715626529105212619597823105703253424578180923198518367950314590659193307930554264397093925775827042236176268007759803582690137843840980772386705480164449778083483285188291484676381242507814851169263482260203814644716543083180451405668819072808330429718567506062709</span></span><br><span class="line">c2 = <span class="number">610128496841462726317506833425685643376834477248581421936289767191157231169877273183670135484878362728645097146468409759041600018012537864965547811439857448464828540773235726178920818294827674781948113255623633839285430654248748870253648833070499790126380247202207754889468929052915267409652159437633870989343563581051402656368193984289733650178890073336193074539112885382859827344976118474202079130801988013675989748389416639822638361617695956152724949838018366316114995037607804462136201579832417071595352634765191415200245101123286308956900978729673956327795478929511443812164927929050130648551821651470507368915</span></span><br><span class="line"> </span><br><span class="line">n3 = <span class="number">15706573883662793739180426124824346478737100750556689571302762666876649831280571602948746690262778388942314949908911977727419329827787818300535881483619026949045102356233720193077375483188473492311257521059754651024634417328380269412960158500971730983460808989304694429812828742240003652685953972610313471058677277924211777470659070571788912136262813207526510546671118755260943383957825959169657967941446137557170285428705475456867454692625170389547696471536617998814182521062823270091563374756300824962495253118280758541061585938613014265436520554086744112978557060027701878804415916848369237236060118599601808527041</span></span><br><span class="line">c3 = <span class="number">14732860321673314016181562632739555343415389097691339548188061768789344417115312458263622661053638328106171152657248665030646553428774841093901930704607536222323830652714219053258315203725973271888561008346423615263403247187378300091206842009223596217015587472233370894801414183441500718615204598597126312580207085587076603035353740651154509705013388670036319201682633010878676501472218856086428718160858012452623504181094346896177954376698418748732056754583388969344538258469123805829389256575587438028395767538856823010993087812097264132756253387201310757805260415962787707898397609109598269131540975221626904515164</span></span><br><span class="line"> </span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">n = [n1,n2,n3]</span><br><span class="line">c = [c1,c2,c3]</span><br><span class="line">resultant, mod = crt(n, c)</span><br><span class="line">value, is_perfect = gmpy2.iroot(resultant, e)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(value))</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{3_1s_d4ng3r0us!!!!!}</p>
</blockquote>
<h2 id="easyrsa6"><a href="#easyrsa6" class="headerlink" title="easyrsa6"></a>easyrsa6</h2><p>给了n,c1,c2,e1,e2</p>
<p>考点是共模攻击<br>适用情况，多组c,e但模数n相同，且e之间最好互质。</p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"> </span><br><span class="line">e1 = <span class="number">65537</span></span><br><span class="line">e2 = <span class="number">54049</span></span><br><span class="line">n = <span class="number">10141648834107918816625292635322981547731785386163076968497735061950396621479482429691233819125375428329407641191788636780304504564762122427827858113391543405978044029412297197295612613286443654152370825731830841535534151628906619328563328078476907350745757510495652070139413210215531611808626797442281895280316864805512743971285412961954267943706950928418081800611964346570551696849652757533801560612034306751031456735842620888560711699257789724692443005562253876750947512998141038386627270107440770609653002641356909945815388956008108802989714085274707305137238942607184695976061104585616463138550833179061994313001</span></span><br><span class="line"> </span><br><span class="line">c1 = <span class="number">7610322722453047079443720474872221919196409616170900463715520775971671338031226879895595946057052130729813048809964371985633229915284775712365484634088968962459602983518102825136556935858094002153422820286662297483699187024223109733584347392902685648885456921518446394210565694506722593495113630958667534029457337877395709513229018465767883955223738830324593003029092537755651569204434446110769803183256534139173401974244494174824537758709247570465283264661271262071182195145089900136560255503894394006487830136588669698769642743007902987559157825189388207222193510898444504984514323317988508962351643736920200555146</span></span><br><span class="line">c2 = <span class="number">3119053154838971553928067416098801798545681460804163749012722979401809325405090448243564565160778375357332863168425097876406829398313910659509173792289092445211414807953063675138838235861317671536787914285132879175080282526449733478565812539443537771603425798423690458367867186282514625028051516500809249335065063823599125019414210523520485522204939888051097871238674202228223773253503309319406911057369524993832068965167528837522920443022107437635305777295476451701520099123496371907138278243924901290497370881593143444115957430629761147066715266289790002041914290118104879573330033019056939842051243704678905897349</span></span><br><span class="line"> </span><br><span class="line">_, s1, s2 = gmpy2.gcdext(e1, e2)</span><br><span class="line">m = <span class="built_in">pow</span>(c1, s1, n) * <span class="built_in">pow</span>(c2, s2, n) % n</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{C0mmon_Modu1u5_4ttack}</p>
</blockquote>
<h2 id="easyrsa7"><a href="#easyrsa7" class="headerlink" title="easyrsa7"></a>easyrsa7</h2><p>已知n,e,d,求p，且限制了p一定比q小</p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">d = <span class="number">12495308511973910652623749491898775717689839872330893225857471754184286833950555457396766346144556249536728735222857685754538922319947700204296513743484000132952807489879062068621999793723941575853956449161267718077526899734635181954693996426784967633034302178532933380245720314310660287036117637310807271583541166141145740451420760174097158286185064973480233508803111906395734377519011352596218860130017108039035405151349635895136231918677625190396028277162603169032482559716379377326702358991887782015210084095047913077419045377991887425638435427063330609561048615802749597398473717330873124217736802534086944479041</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">21501471247945023957385986200981202127034580573253945001917269504646736497311808880203010975877639629414708583739442948886604457073003529598513380801520530292320751574442159606975791642106967364825414688039752203950188531951603894338202500756766434484224362282059361837451130920521392197434386430615931737588135002801621089197858798212609180442231036645009139031467515635475337350023084707719157350150709164891985025979958184056210185024270522646426342603444220907751731970079324986884040015103377566926573311856154552691617546349866132382390059147340977391239594754921042569239894498937370789106554879045184264661717</span></span><br><span class="line"></span><br><span class="line">k = e * d - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">r = k</span><br><span class="line">t = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    r = r // <span class="number">2</span></span><br><span class="line">    t += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> r % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">success = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">101</span>):</span><br><span class="line">    g = random.randint(<span class="number">0</span>, n)</span><br><span class="line">    y = <span class="built_in">pow</span>(g, r, n)</span><br><span class="line">    <span class="keyword">if</span> y == <span class="number">1</span> <span class="keyword">or</span> y == n - <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, t):</span><br><span class="line">        x = <span class="built_in">pow</span>(y, <span class="number">2</span>, n)</span><br><span class="line">        <span class="keyword">if</span> x == <span class="number">1</span>:</span><br><span class="line">            success = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">elif</span> x == n - <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            y = x</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> success:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> success:</span><br><span class="line">    p = libnum.gcd(y - <span class="number">1</span>, n)</span><br><span class="line">    q = n // p</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;P: &#x27;</span> + <span class="string">&#x27;%s&#x27;</span> % p)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Q: &#x27;</span> + <span class="string">&#x27;%s&#x27;</span> % q)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Cannot compute P and Q&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> q &lt; p:</span><br><span class="line">    p, q = q, p</span><br><span class="line"></span><br><span class="line">flag = hashlib.sha1(long_to_bytes(p)).hexdigest()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;flag is 0ops&#123;%s&#125;&quot;</span> % flag)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{8a63f4919b0c26d5b3da5a240f4155d955bf0180}</p>
</blockquote>
<h2 id="easyrsa8"><a href="#easyrsa8" class="headerlink" title="easyrsa8"></a>easyrsa8</h2><p>给了n,e,c</p>
<p>核心是在于p和q差异过大</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p = getPrime(<span class="number">80</span>)</span><br><span class="line">q = getPrime(<span class="number">432</span>)</span><br></pre></td></tr></table></figure>

<p>查资料发现是用 Pollard-Rho 算法打，但是也看到有文章说yafu可以直接分</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">D:\CTF\Crypto\tools\Crypto\yafu-1.34&gt;yafu-x64.exe &quot;factor(10275748722205396496389299177664654717579047563897261247558570212498253534582237859848573689106662710054899109750787939118654466246703273390268824800910687)&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fac: factoring 10275748722205396496389299177664654717579047563897261247558570212498253534582237859848573689106662710054899109750787939118654466246703273390268824800910687</span><br><span class="line">fac: using pretesting plan: normal</span><br><span class="line">fac: no tune info: using qs/gnfs crossover of 95 digits</span><br><span class="line">div: primes less than 10000</span><br><span class="line">fmt: 1000000 iterations</span><br><span class="line">rho: x^2 + 3, starting 1000 iterations on C155</span><br><span class="line">rho: x^2 + 2, starting 1000 iterations on C155</span><br><span class="line">rho: x^2 + 1, starting 1000 iterations on C155</span><br><span class="line">pm1: starting B1 = 150K, B2 = gmp-ecm default on C155</span><br><span class="line">ecm: 30/30 curves on C155, B1=2K, B2=gmp-ecm default</span><br><span class="line">ecm: 61/74 curves on C155, B1=11K, B2=gmp-ecm default</span><br><span class="line">Total factoring time = 1.7402 seconds</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">***factors found***</span><br><span class="line"></span><br><span class="line">P24 = 964240990462590625020079</span><br><span class="line">P131 = 10656826274597233798672015339959987714288970411993114294750070455199145269683405686176014839132666453889827142667326671439841833553</span><br><span class="line"></span><br><span class="line">ans = 1</span><br></pre></td></tr></table></figure>

<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">964240990462590625020079</span></span><br><span class="line">q = <span class="number">10656826274597233798672015339959987714288970411993114294750070455199145269683405686176014839132666453889827142667326671439841833553</span></span><br><span class="line">n = <span class="number">10275748722205396496389299177664654717579047563897261247558570212498253534582237859848573689106662710054899109750787939118654466246703273390268824800910687</span></span><br><span class="line">phin = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">c = <span class="number">6064670669438337478413429683338698122052425451327188207495708831052458134774707227889508719675312870189288455235480055372940915632836491196158175941138774</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e, phin)</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line">plain = gmpy2.powmod(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(plain)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(plain))</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{612db81d0f2174c1b12b9f306e6f8b46}</p>
</blockquote>
<h2 id="Wiener’s-Attack"><a href="#Wiener’s-Attack" class="headerlink" title="Wiener’s Attack"></a>Wiener’s Attack</h2><p>给了n,e,c,但是e过大</p>
<p>考点是wiener攻击</p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> ContinuedFractions, Arithmetic</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">wiener_hack</span>(<span class="params">e, n</span>):</span><br><span class="line">    frac = ContinuedFractions.rational_to_contfrac(e, n)</span><br><span class="line">    convergents = ContinuedFractions.convergents_from_contfrac(frac)</span><br><span class="line">    <span class="keyword">for</span> (k, d) <span class="keyword">in</span> convergents:</span><br><span class="line">        <span class="keyword">if</span> k != <span class="number">0</span> <span class="keyword">and</span> (e * d - <span class="number">1</span>) % k == <span class="number">0</span>:</span><br><span class="line">            phi = (e * d - <span class="number">1</span>) // k</span><br><span class="line">            s = n - phi + <span class="number">1</span></span><br><span class="line">            discr = s * s - <span class="number">4</span> * n</span><br><span class="line">            <span class="keyword">if</span> (discr &gt;= <span class="number">0</span>):</span><br><span class="line">                t = Arithmetic.is_perfect_square(discr)</span><br><span class="line">                <span class="keyword">if</span> t != -<span class="number">1</span> <span class="keyword">and</span> (s + t) % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;Hacked!&quot;</span>)</span><br><span class="line">                    <span class="keyword">return</span> d</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">11265857811667686251940835041794539249692479656479395836866551619346987849817352370714378952970919265498719895823104842280695794577366085279008969936173160002138799769338267308217848007670511861963831239855114786624725073628674390513017482804020232573320642317631746460347722144917438256219993886165124274212154231414673836757032083713920084703567490023828544468686417352156064691924426914121312685384513191873712046573830919355533351760744168296246620679312744647284663514869368072325096149569219633329964662377931499925279327751485855945142014078647460147419552362252323318945332721112997874535951586012697300850427</span></span><br><span class="line">n = <span class="number">16320462105943859454437961036973770127149563035505518848192394712860170521191431454348662669347180236071222232649172821265270386848725599498442979422920143880689024089196835412303712546771778820308148682648237058220445226248875982752521465239986162785544055315354744787754623441108742892319448236538199216423365534182551620343393701697588479916860518860254263563482489007654339488800979124372756942010334695369161929496648425806354156555377407479804127056609614431512164720223685455799747605533823704660204498103745345312250297797428772620835295218616954118319608347851727030965114424833211935925010450242869857875963</span></span><br><span class="line">d = wiener_hack(e, n)</span><br><span class="line"></span><br><span class="line">c = <span class="number">2966962867846894138392324974009088944861407761095364327510972935066430184915260118902585327579868130448781856813204078789898522652262143195072678899166850421491447844440155457748108738385689725230227340097849379615449164885328773933294398896312295740742904861681441462979161197137258016356653271475994253564405920128095105836096971976346434185111894566304324201992045431302109746373439401384222930021537096598388374741147289306147993673499734701456962463385476164808246131067903653963427936026355790100008894145942981491031312479381023886305270877127680447619481280684338002728302276174321341715466245987710248951288</span></span><br><span class="line"></span><br><span class="line">plain = gmpy2.powmod(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(plain)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(plain))</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{Do_y0u_kn0w_W1en3r5_4ttack}</p>
</blockquote>
<h2 id="guess-game1"><a href="#guess-game1" class="headerlink" title="guess game1"></a>guess game1</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> FLAG</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    win = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">700</span>):</span><br><span class="line">        target = random.getrandbits(<span class="number">32</span>)</span><br><span class="line">        guess = <span class="built_in">int</span>(raw_input(<span class="string">&quot;Give me your number:\n&quot;</span>))</span><br><span class="line">        <span class="keyword">if</span> guess==target:</span><br><span class="line">            win += <span class="number">1</span></span><br><span class="line">            <span class="built_in">print</span> <span class="string">&quot;You are right!&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span> <span class="string">&quot;Try again.&quot;</span></span><br><span class="line">            <span class="built_in">print</span> <span class="string">&quot;Number is %d&quot;</span>%target</span><br><span class="line">        <span class="keyword">if</span> win&gt;=<span class="number">20</span>:</span><br><span class="line">            <span class="built_in">print</span> FLAG</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>一眼randcrack</p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">conn = remote(<span class="string">&#x27;crypto1.0ops.sjtu.cn&#x27;</span>, <span class="number">10000</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">    conn.recvuntil(<span class="string">b&#x27;Give me your number:\n&#x27;</span>)</span><br><span class="line">    conn.sendline(<span class="string">b&#x27;0&#x27;</span>)</span><br><span class="line">    conn.recvuntil(<span class="string">b&#x27;Number is &#x27;</span>)</span><br><span class="line">    res = conn.recvuntil(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br><span class="line">    res = <span class="built_in">str</span>(res)[<span class="number">2</span>:-<span class="number">3</span>]</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;random.txt&quot;</span>, <span class="string">&quot;a&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(res+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> randcrack <span class="keyword">import</span> RandCrack</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&#x27;random.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    l = f.readlines()</span><br><span class="line">l = [<span class="built_in">int</span>(i.strip()) <span class="keyword">for</span> i <span class="keyword">in</span> l]</span><br><span class="line">arr = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(l)):</span><br><span class="line">    arr.append(l[i])</span><br><span class="line"></span><br><span class="line">rc = RandCrack()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> arr:</span><br><span class="line">    rc.submit(i)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    predict = rc.predict_getrandbits(<span class="number">32</span>)</span><br><span class="line">    <span class="built_in">print</span>(predict)</span><br><span class="line">    conn.recvuntil(<span class="string">b&#x27;Give me your number:\n&#x27;</span>)</span><br><span class="line">    conn.sendline(<span class="built_in">str</span>(predict).encode())</span><br><span class="line">    res = conn.recvline()</span><br><span class="line">    <span class="built_in">print</span>(res.decode())</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">19</span>:</span><br><span class="line">        conn.interactive()</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{Mer5enn3_tw1st3r}</p>
</blockquote>
<h2 id="hello-AES"><a href="#hello-AES" class="headerlink" title="hello AES"></a>hello AES</h2><p>加密脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> FLAG</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto <span class="keyword">import</span> Random</span><br><span class="line"></span><br><span class="line">key = <span class="string">&quot;Hello AES!!!!!!!&quot;</span></span><br><span class="line">iv = Random.new().read(AES.block_size)</span><br><span class="line">cipher = AES.new(key, AES.MODE_CFB, iv)</span><br><span class="line">msg = iv + cipher.encrypt(FLAG)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;enc.txt&quot;</span>,<span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(msg)</span><br></pre></td></tr></table></figure>

<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取密文文件</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;enc.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    msg = f.read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提取前16字节作为初始向量(IV)</span></span><br><span class="line">iv = msg[:AES.block_size]  <span class="comment"># AES.block_size = 16</span></span><br><span class="line"><span class="comment"># 剩余部分是真正的密文</span></span><br><span class="line">ciphertext = msg[AES.block_size:]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 硬编码的密钥（与加密时相同）</span></span><br><span class="line">key = <span class="string">b&quot;Hello AES!!!!!!!&quot;</span>  <span class="comment"># 注意：密钥必须是16字节（AES-128）</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建AES解密器（使用相同的密钥、IV和模式）</span></span><br><span class="line"><span class="comment"># 注意：CFB模式解密时用`encrypt`或`decrypt`均可，但语义上建议用`decrypt`</span></span><br><span class="line">cipher = AES.new(key, AES.MODE_CFB, iv)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密密文得到FLAG</span></span><br><span class="line">flag = cipher.decrypt(ciphertext)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag.decode())  <span class="comment"># 输出可读的FLAG字符串</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{e5a06aab08006fbe57870d5946b07cbd}</p>
</blockquote>
<h2 id="chosen-ciphertext"><a href="#chosen-ciphertext" class="headerlink" title="chosen ciphertext"></a>chosen ciphertext</h2><p>选择密文攻击</p>
<p>源码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long, long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> FLAG</span><br><span class="line"></span><br><span class="line">flag_plain = bytes_to_long(FLAG)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    p = getPrime(<span class="number">1024</span>)</span><br><span class="line">    q = getPrime(<span class="number">1024</span>)</span><br><span class="line">    n = p*q</span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">    d = gmpy2.invert(e,phi)</span><br><span class="line">    flag_enc = encrypt(flag_plain,e,n)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;n = %d&quot;</span>%n</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;e = %d&quot;</span>%e</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;encrypted flag = %d&quot;</span>%flag_enc</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;your ciphertext: &quot;</span></span><br><span class="line">    user_enc = <span class="built_in">int</span>(raw_input())</span><br><span class="line">    <span class="keyword">if</span> user_enc==flag_enc:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;NO CHEAT&quot;</span></span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    user_plain = decrypt(user_enc,d,n)</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;your plaintest: &quot;</span></span><br><span class="line">    <span class="built_in">print</span> user_plain</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">p,e,n</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(p,e,n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">c,d,n</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">conn = remote(<span class="string">&#x27;crypto1.0ops.sjtu.cn&#x27;</span>, <span class="number">10001</span>)</span><br><span class="line"></span><br><span class="line">data = conn.recvuntil(<span class="string">b&#x27;\n&#x27;</span>).decode()</span><br><span class="line">n = data[<span class="number">4</span>:]</span><br><span class="line">data = conn.recvuntil(<span class="string">b&#x27;\n&#x27;</span>).decode()</span><br><span class="line">e = data[<span class="number">4</span>:]</span><br><span class="line">data = conn.recvuntil(<span class="string">b&#x27;\n&#x27;</span>).decode()</span><br><span class="line">flag_enc = data[<span class="number">17</span>:]</span><br><span class="line">n = <span class="built_in">int</span>(n)</span><br><span class="line">e = <span class="built_in">int</span>(e)</span><br><span class="line">flag_enc = <span class="built_in">int</span>(flag_enc)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 选择扰动因子 s</span></span><br><span class="line">s_val = <span class="number">2</span></span><br><span class="line"><span class="keyword">while</span> gmpy2.gcd(s_val, n) != <span class="number">1</span>:  <span class="comment"># 确保互质</span></span><br><span class="line">    s_val += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算 s^e mod n</span></span><br><span class="line">s_e = <span class="built_in">pow</span>(s_val, e, n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 构造新密文 c_prime</span></span><br><span class="line">c_prime = (flag_enc * s_e) % n</span><br><span class="line"><span class="comment"># 提交 c_prime</span></span><br><span class="line">conn.send(<span class="built_in">str</span>(c_prime).encode() + <span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 接收解密结果 m_prime</span></span><br><span class="line">data = conn.recvuntil(<span class="string">b&#x27;\n&#x27;</span>).decode()</span><br><span class="line">data = conn.recvuntil(<span class="string">b&#x27;\n&#x27;</span>).decode()</span><br><span class="line">data = conn.recvuntil(<span class="string">b&#x27;\n&#x27;</span>).decode()</span><br><span class="line">m_prime = <span class="built_in">int</span>(data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算 FLAG</span></span><br><span class="line">s_inv = gmpy2.invert(s_val, n)</span><br><span class="line">flag_plain = (m_prime * s_inv) % n</span><br><span class="line">flag = long_to_bytes(flag_plain)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;FLAG:&quot;</span>, flag)</span><br><span class="line"></span><br><span class="line">conn.interactive()</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{ch0s3n_C1ph3rt3xt_4ttack}</p>
</blockquote>
<h2 id="related-message"><a href="#related-message" class="headerlink" title="related message"></a>related message</h2><p>chall.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long, long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> FLAG</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">plain1 = bytes_to_long(FLAG+os.urandom(<span class="number">128</span>))</span><br><span class="line">plain2 = bytes_to_long(FLAG+os.urandom(<span class="number">128</span>))</span><br><span class="line">FYI = plain2-plain1</span><br><span class="line">c1 = <span class="built_in">pow</span>(plain1,e,n)</span><br><span class="line">c2 = <span class="built_in">pow</span>(plain2,e,n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;enc.txt&quot;</span>,<span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">&quot;n = &quot;</span>+<span class="built_in">str</span>(n)+<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">    f.write(<span class="string">&quot;c1 = &quot;</span>+<span class="built_in">str</span>(c1)+<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">    f.write(<span class="string">&quot;c2 = &quot;</span>+<span class="built_in">str</span>(c2)+<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">    f.write(<span class="string">&quot;FYI = &quot;</span>+<span class="built_in">str</span>(FYI)+<span class="string">&quot;\n&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>考点是Franklin-Reiter相关消息攻击</p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">CTF RSA (e=3) — Franklin–Reiter related-message attack</span></span><br><span class="line"><span class="string">Setup:</span></span><br><span class="line"><span class="string">  m1 = FLAG || r1</span></span><br><span class="line"><span class="string">  m2 = FLAG || r2  -&gt;  m2 = m1 + d  where d = FYI = r2 - r1</span></span><br><span class="line"><span class="string">Given n, e=3, c1=m1^3 mod n, c2=m2^3 mod n, d, recover m1 then FLAG.</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys, re</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line"></span><br><span class="line"><span class="comment"># Robust modular inverse (no external deps)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invmod</span>(<span class="params">a, n</span>):</span><br><span class="line">    a %= n</span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;invmod of 0&quot;</span>)</span><br><span class="line">    <span class="comment"># Extended Euclid</span></span><br><span class="line">    t, new_t = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    r, new_r = n, a</span><br><span class="line">    <span class="keyword">while</span> new_r != <span class="number">0</span>:</span><br><span class="line">        q = r // new_r</span><br><span class="line">        t, new_t = new_t, t - q * new_t</span><br><span class="line">        r, new_r = new_r, r - q * new_r</span><br><span class="line">    <span class="keyword">if</span> r != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">f&quot;mod inverse doesn&#x27;t exist; gcd(<span class="subst">&#123;a&#125;</span>, <span class="subst">&#123;n&#125;</span>) = <span class="subst">&#123;r&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> t % n</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_enc</span>(<span class="params">path</span>):</span><br><span class="line">    data = <span class="built_in">open</span>(path, <span class="string">&#x27;rb&#x27;</span>).read().decode().strip()</span><br><span class="line">    vals = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> data.splitlines():</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;=&#x27;</span> <span class="keyword">in</span> line:</span><br><span class="line">            k, v = line.split(<span class="string">&#x27;=&#x27;</span>, <span class="number">1</span>)</span><br><span class="line">            k = k.strip()</span><br><span class="line">            v = v.strip()</span><br><span class="line">            <span class="comment"># allow possible trailing L or commas</span></span><br><span class="line">            v = re.sub(<span class="string">r&#x27;[^0-9\-]&#x27;</span>, <span class="string">&#x27;&#x27;</span>, v)</span><br><span class="line">            vals[k] = <span class="built_in">int</span>(v)</span><br><span class="line">    needed = [<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;c1&#x27;</span>, <span class="string">&#x27;c2&#x27;</span>, <span class="string">&#x27;FYI&#x27;</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">all</span>(k <span class="keyword">in</span> vals <span class="keyword">for</span> k <span class="keyword">in</span> needed):</span><br><span class="line">        <span class="keyword">raise</span> SystemExit(<span class="string">f&quot;enc.txt missing keys; found: <span class="subst">&#123;<span class="built_in">list</span>(vals.keys())&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> vals[<span class="string">&#x27;n&#x27;</span>], vals[<span class="string">&#x27;c1&#x27;</span>], vals[<span class="string">&#x27;c2&#x27;</span>], vals[<span class="string">&#x27;FYI&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Basic poly helpers over Z/nZ (coeffs lowest-degree first)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">poly_trim</span>(<span class="params">p, n</span>):</span><br><span class="line">    p = [c % n <span class="keyword">for</span> c <span class="keyword">in</span> p]</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(p) &gt; <span class="number">1</span> <span class="keyword">and</span> p[-<span class="number">1</span>] % n == <span class="number">0</span>:</span><br><span class="line">        p.pop()</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">poly_deg</span>(<span class="params">p</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">len</span>(p) - <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">poly_add</span>(<span class="params">a, b, n</span>):</span><br><span class="line">    m = <span class="built_in">max</span>(<span class="built_in">len</span>(a), <span class="built_in">len</span>(b))</span><br><span class="line">    out = [(<span class="number">0</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(m)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        ai = a[i] <span class="keyword">if</span> i &lt; <span class="built_in">len</span>(a) <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">        bi = b[i] <span class="keyword">if</span> i &lt; <span class="built_in">len</span>(b) <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">        out[i] = (ai + bi) % n</span><br><span class="line">    <span class="keyword">return</span> poly_trim(out, n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">poly_sub</span>(<span class="params">a, b, n</span>):</span><br><span class="line">    m = <span class="built_in">max</span>(<span class="built_in">len</span>(a), <span class="built_in">len</span>(b))</span><br><span class="line">    out = [(<span class="number">0</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(m)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        ai = a[i] <span class="keyword">if</span> i &lt; <span class="built_in">len</span>(a) <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">        bi = b[i] <span class="keyword">if</span> i &lt; <span class="built_in">len</span>(b) <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">        out[i] = (ai - bi) % n</span><br><span class="line">    <span class="keyword">return</span> poly_trim(out, n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">poly_mul</span>(<span class="params">a, b, n</span>):</span><br><span class="line">    out = [<span class="number">0</span>]*(<span class="built_in">len</span>(a)+<span class="built_in">len</span>(b)-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> i, ai <span class="keyword">in</span> <span class="built_in">enumerate</span>(a):</span><br><span class="line">        <span class="keyword">for</span> j, bj <span class="keyword">in</span> <span class="built_in">enumerate</span>(b):</span><br><span class="line">            out[i+j] = (out[i+j] + ai*bj) % n</span><br><span class="line">    <span class="keyword">return</span> poly_trim(out, n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">poly_scale</span>(<span class="params">a, s, n</span>):</span><br><span class="line">    <span class="keyword">return</span> poly_trim([(ai*s) % n <span class="keyword">for</span> ai <span class="keyword">in</span> a], n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">poly_monic</span>(<span class="params">a, n</span>):</span><br><span class="line">    lc = a[-<span class="number">1</span>] % n</span><br><span class="line">    inv = invmod(lc, n)</span><br><span class="line">    <span class="keyword">return</span> poly_scale(a, inv, n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">poly_divmod</span>(<span class="params">a, b, n</span>):</span><br><span class="line">    <span class="comment"># polynomial long division: a = q*b + r  over Z/nZ, requires lc(b) invertible mod n</span></span><br><span class="line">    a = a[:]</span><br><span class="line">    b = b[:]</span><br><span class="line">    <span class="keyword">if</span> b == [<span class="number">0</span>]:</span><br><span class="line">        <span class="keyword">raise</span> ZeroDivisionError</span><br><span class="line">    q = [<span class="number">0</span>]*(<span class="built_in">max</span>(<span class="number">0</span>, <span class="built_in">len</span>(a)-<span class="built_in">len</span>(b))+<span class="number">1</span>)</span><br><span class="line">    b_lc = b[-<span class="number">1</span>] % n</span><br><span class="line">    inv_b_lc = invmod(b_lc, n)</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(a) &gt;= <span class="built_in">len</span>(b) <span class="keyword">and</span> a != [<span class="number">0</span>]:</span><br><span class="line">        t_deg = <span class="built_in">len</span>(a) - <span class="built_in">len</span>(b)</span><br><span class="line">        coeff = (a[-<span class="number">1</span>] * inv_b_lc) % n</span><br><span class="line">        term = [<span class="number">0</span>]*t_deg + [coeff]</span><br><span class="line">        q = poly_add(q, term, n)</span><br><span class="line">        a = poly_sub(a, poly_mul(b, term, n), n)</span><br><span class="line">    r = a</span><br><span class="line">    <span class="keyword">return</span> poly_trim(q, n), poly_trim(r, n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">poly_gcd</span>(<span class="params">a, b, n</span>):</span><br><span class="line">    <span class="comment"># Normalize to monic at each step if possible; if lc not invertible, raise with hint.</span></span><br><span class="line">    a = poly_trim(a, n)</span><br><span class="line">    b = poly_trim(b, n)</span><br><span class="line">    <span class="comment"># Make both monic if possible</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        a = poly_monic(a, n)</span><br><span class="line">        b = poly_monic(b, n)</span><br><span class="line">    <span class="keyword">except</span> ValueError:</span><br><span class="line">        <span class="comment"># fall through; Euclid will raise later if needed</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">while</span> b != [<span class="number">0</span>]:</span><br><span class="line">        <span class="comment"># ensure divisor lc invertible</span></span><br><span class="line">        <span class="keyword">if</span> gcd(b[-<span class="number">1</span>], n) != <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;Leading coefficient <span class="subst">&#123;b[-<span class="number">1</span>]&#125;</span> not invertible modulo n; try using a CAS (Sage).&quot;</span>)</span><br><span class="line">        _, r = poly_divmod(a, b, n)</span><br><span class="line">        a, b = b, r</span><br><span class="line">    <span class="comment"># make monic</span></span><br><span class="line">    <span class="keyword">if</span> a != [<span class="number">0</span>] <span class="keyword">and</span> gcd(a[-<span class="number">1</span>], n) == <span class="number">1</span>:</span><br><span class="line">        a = poly_monic(a, n)</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve</span>(<span class="params">enc_path=<span class="string">&quot;enc.txt&quot;</span></span>):</span><br><span class="line">    n, c1, c2, d = parse_enc(enc_path)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># f(x) = x^3 - c1</span></span><br><span class="line">    f = [(-c1) % n, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>]       <span class="comment"># const, x, x^2, x^3</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># g(x) = (x + d)^3 - c2 = x^3 + 3dx^2 + 3d^2 x + d^3 - c2</span></span><br><span class="line">    g = [ (<span class="built_in">pow</span>(d,<span class="number">3</span>, n) - c2) % n,</span><br><span class="line">          (<span class="number">3</span> * <span class="built_in">pow</span>(d,<span class="number">2</span>, n)) % n,</span><br><span class="line">          (<span class="number">3</span> * d) % n,</span><br><span class="line">          <span class="number">1</span> ]</span><br><span class="line"></span><br><span class="line">    h = poly_gcd(f, g, n)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(h) != <span class="number">2</span>:  <span class="comment"># expect degree 1: a x + b</span></span><br><span class="line">        <span class="keyword">raise</span> SystemExit(<span class="string">f&quot;Unexpected gcd degree <span class="subst">&#123;<span class="built_in">len</span>(h)-<span class="number">1</span>&#125;</span>. Got: <span class="subst">&#123;h&#125;</span>&quot;</span>)</span><br><span class="line">    a, b = h[<span class="number">1</span>] % n, h[<span class="number">0</span>] % n  <span class="comment"># h = b + a x</span></span><br><span class="line">    m1 = (-b * invmod(a, n)) % n</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Extract FLAG: m1 = FLAG * B + r1, B = 256**128</span></span><br><span class="line">    B = <span class="number">1</span> &lt;&lt; (<span class="number">8</span>*<span class="number">128</span>)</span><br><span class="line">    F = m1 // B</span><br><span class="line">    <span class="comment"># to bytes (strip possible leading zeros from F)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">long_to_bytes</span>(<span class="params">x</span>):</span><br><span class="line">        <span class="comment"># minimal bytes</span></span><br><span class="line">        <span class="keyword">if</span> x == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">b&#x27;\x00&#x27;</span></span><br><span class="line">        out = []</span><br><span class="line">        <span class="keyword">while</span> x:</span><br><span class="line">            out.append(x &amp; <span class="number">0xff</span>)</span><br><span class="line">            x &gt;&gt;= <span class="number">8</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">bytes</span>(<span class="built_in">reversed</span>(out))</span><br><span class="line"></span><br><span class="line">    flag_bytes = long_to_bytes(F)</span><br><span class="line">    <span class="comment"># Try common markers</span></span><br><span class="line">    <span class="keyword">for</span> marker <span class="keyword">in</span> [<span class="string">b&#x27;flag&#123;&#x27;</span>, <span class="string">b&#x27;FLAG&#123;&#x27;</span>, <span class="string">b&#x27;ctf&#123;&#x27;</span>, <span class="string">b&#x27;CTF&#123;&#x27;</span>]:</span><br><span class="line">        i = flag_bytes.find(marker)</span><br><span class="line">        <span class="keyword">if</span> i != -<span class="number">1</span>:</span><br><span class="line">            <span class="comment"># assume ASCII and &#x27;&#125;&#x27; present</span></span><br><span class="line">            j = flag_bytes.find(<span class="string">b&#x27;&#125;&#x27;</span>, i+<span class="number">5</span>)</span><br><span class="line">            <span class="keyword">if</span> j != -<span class="number">1</span>:</span><br><span class="line">                <span class="built_in">print</span>(flag_bytes[i:j+<span class="number">1</span>].decode(errors=<span class="string">&#x27;ignore&#x27;</span>))</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">    <span class="comment"># Fallback: print the hex/bytes for manual inspection</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;FLAG bytes (guess):&quot;</span>, flag_bytes)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;m1 =&quot;</span>, m1)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    enc_path = <span class="string">&quot;enc.txt&quot;</span></span><br><span class="line">    solve(enc_path)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>0ops{202cb962ac59075b964b07152d234b70}</p>
</blockquote>
<!-- flag of hidden posts --></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://sakuraraindrop.github.io">cheng_xing</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://sakuraraindrop.github.io/2025/07/24/SJTU-OJ-CRYPTO/">https://sakuraraindrop.github.io/2025/07/24/SJTU-OJ-CRYPTO/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://sakuraraindrop.github.io" target="_blank">cheng_xing's blog</a>！</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/img/ltx.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/ltx.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">cheng_xing</div><div class="author-info-description">web菜鸡修炼中</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">61</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">147</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/sakuraraindrop"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/sakuraraindrop" target="_blank" title="Github"><i class="fab fa-github" style="color: #hdhfbb;"></i></a><a class="social-icon" href="https://space.bilibili.com/504596197" target="_blank" title="Bilibili"><i class="fab fa-bilibili" style="color: #000000;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#substitution1"><span class="toc-number">1.</span> <span class="toc-text">substitution1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#substitution2"><span class="toc-number">2.</span> <span class="toc-text">substitution2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easyrsa0"><span class="toc-number">3.</span> <span class="toc-text">easyrsa0</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easyrsa1"><span class="toc-number">4.</span> <span class="toc-text">easyrsa1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easyrsa2"><span class="toc-number">5.</span> <span class="toc-text">easyrsa2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easyrsa3"><span class="toc-number">6.</span> <span class="toc-text">easyrsa3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easyrsa4"><span class="toc-number">7.</span> <span class="toc-text">easyrsa4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easyrsa5"><span class="toc-number">8.</span> <span class="toc-text">easyrsa5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easyrsa6"><span class="toc-number">9.</span> <span class="toc-text">easyrsa6</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easyrsa7"><span class="toc-number">10.</span> <span class="toc-text">easyrsa7</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easyrsa8"><span class="toc-number">11.</span> <span class="toc-text">easyrsa8</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Wiener%E2%80%99s-Attack"><span class="toc-number">12.</span> <span class="toc-text">Wiener’s Attack</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#guess-game1"><span class="toc-number">13.</span> <span class="toc-text">guess game1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hello-AES"><span class="toc-number">14.</span> <span class="toc-text">hello AES</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#chosen-ciphertext"><span class="toc-number">15.</span> <span class="toc-text">chosen ciphertext</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#related-message"><span class="toc-number">16.</span> <span class="toc-text">related message</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/17/reverse-learning/" title="reverse-learning">reverse-learning</a><time datetime="2025-10-17T04:52:59.000Z" title="发表于 2025-10-17 12:52:59">2025-10-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/09/hackasat-2020-quals/" title="hackasat-2020-quals">hackasat-2020-quals</a><time datetime="2025-10-09T06:51:05.000Z" title="发表于 2025-10-09 14:51:05">2025-10-09</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/02/20251002%E8%AE%BA%E6%96%87%E7%B2%BE%E8%AF%BB/" title="20251002论文精读">20251002论文精读</a><time datetime="2025-10-02T09:04:55.000Z" title="发表于 2025-10-02 17:04:55">2025-10-02</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/30/hackasat-2022-quals/" title="hackasat-2022-quals">hackasat-2022-quals</a><time datetime="2025-09-30T12:06:48.000Z" title="发表于 2025-09-30 20:06:48">2025-09-30</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/27/20250927%E9%9A%8F%E7%BC%98%E5%88%B7%E9%A2%98/" title="20250927随缘刷题">20250927随缘刷题</a><time datetime="2025-09-27T04:45:15.000Z" title="发表于 2025-09-27 12:45:15">2025-09-27</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/hk.jpg);"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;2025 By cheng_xing</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.0-b1</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const loadMathjax = () => {
    if (!window.MathJax) {
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          tags: 'none',
        },
        chtml: {
          scale: 1.1
        },
        options: {
          enableMenu: true,
          renderActions: {
            findScript: [10, doc => {
              for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
                const display = !!node.type.match(/; *mode=display/)
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
                const text = document.createTextNode('')
                node.parentNode.replaceChild(text, node)
                math.start = {node: text, delim: '', n: 0}
                math.end = {node: text, delim: '', n: 0}
                doc.math.push(math)
              }
            }, '']
          }
        }
      }

      const script = document.createElement('script')
      script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
      script.id = 'MathJax-script'
      script.async = true
      document.head.appendChild(script)
    } else {
      MathJax.startup.document.state(0)
      MathJax.texReset()
      MathJax.typesetPromise()
    }
  }

  btf.addGlobalFn('encrypt', loadMathjax, 'mathjax')
  window.pjax ? loadMathjax() : window.addEventListener('load', loadMathjax)
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>