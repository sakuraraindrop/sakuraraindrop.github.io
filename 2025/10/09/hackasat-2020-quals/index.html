<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>hackasat-2020-quals | cheng_xing's blog</title><meta name="author" content="cheng_xing"><meta name="copyright" content="cheng_xing"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="卫星平台信息安全bus构建challenge镜像 1docker build challenge -t bus:challenge  然后 1socat -v tcp-listen:31340,reuseaddr exec:&quot;docker run --rm -i -e SEED&#x3D;1234 -e FLAG&#x3D;flag&#123;1234&#125;  bus\:challenge&quot;">
<meta property="og:type" content="article">
<meta property="og:title" content="hackasat-2020-quals">
<meta property="og:url" content="https://sakuraraindrop.github.io/2025/10/09/hackasat-2020-quals/index.html">
<meta property="og:site_name" content="cheng_xing&#39;s blog">
<meta property="og:description" content="卫星平台信息安全bus构建challenge镜像 1docker build challenge -t bus:challenge  然后 1socat -v tcp-listen:31340,reuseaddr exec:&quot;docker run --rm -i -e SEED&#x3D;1234 -e FLAG&#x3D;flag&#123;1234&#125;  bus\:challenge&quot;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://sakuraraindrop.github.io/img/ltx.jpg">
<meta property="article:published_time" content="2025-10-09T06:51:05.000Z">
<meta property="article:modified_time" content="2025-10-10T02:07:21.382Z">
<meta property="article:author" content="cheng_xing">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://sakuraraindrop.github.io/img/ltx.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "hackasat-2020-quals",
  "url": "https://sakuraraindrop.github.io/2025/10/09/hackasat-2020-quals/",
  "image": "https://sakuraraindrop.github.io/img/ltx.jpg",
  "datePublished": "2025-10-09T06:51:05.000Z",
  "dateModified": "2025-10-10T02:07:21.382Z",
  "author": [
    {
      "@type": "Person",
      "name": "cheng_xing",
      "url": "https://sakuraraindrop.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/ltx-icon.jpg"><link rel="canonical" href="https://sakuraraindrop.github.io/2025/10/09/hackasat-2020-quals/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'hackasat-2020-quals',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/img/hk.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/ltx.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">61</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">147</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/hk.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/ltx-icon.jpg" alt="Logo"><span class="site-name">cheng_xing's blog</span></a><a class="nav-page-title" href="/"><span class="site-name">hackasat-2020-quals</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">hackasat-2020-quals</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-10-09T06:51:05.000Z" title="发表于 2025-10-09 14:51:05">2025-10-09</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-10-10T02:07:21.382Z" title="更新于 2025-10-10 10:07:21">2025-10-10</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/SAT/">SAT</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="卫星平台信息安全"><a href="#卫星平台信息安全" class="headerlink" title="卫星平台信息安全"></a>卫星平台信息安全</h1><h2 id="bus"><a href="#bus" class="headerlink" title="bus"></a>bus</h2><p>构建challenge镜像</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build challenge -t bus:challenge</span><br></pre></td></tr></table></figure>

<p>然后</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">socat -v tcp-listen:31340,reuseaddr exec:&quot;docker run --rm -i -e SEED=1234 -e FLAG=flag&#123;1234&#125;  bus\:challenge&quot;</span><br></pre></td></tr></table></figure>

<p>后面就能通过nc与31340端口交互</p>
<p>题目告诉我们，正在监听的总线非常繁忙，一些有趣的信息隐藏在总线设备内存中。</p>
<p>连接上题目后，发现回显了下面一大串字符，以NO CARRIER结尾</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">^82+00+00+1f+00+00+00+12+47+40+41+c6+97+e1+3f+89+81+3f+c1+99+1d+a1+c0+20+18+a1+40+5e+42+ac+3c+.^83+00+00+3f+.^82+00+00+3f+00+00+00+20+fa+3f+41+c8+da+e2+3f+a6+64+3f+c1+ff+33+a1+c0+a4+d2+a0+40+de+50+55+40+.^b4+01+c9+61+20+30+33+00+f0+28+65+f5+e6+8f+3c+ba+5b+35+28+c7+5b+8f+6d+f3+ee+a2+57+23+bb+3b+9c+f0+31+a9+ed+80+2e+42+57+.^83+00+00+1f+.^82+00+00+1f+00+00+00+1d+ec+3f+41+d8+04+e5+3f+67+4e+40+c1+38+1b+a1+c0+e1+dd+a0+40+b9+91+91+3c+.^82+00+00+1f+00+00+00+1d+ec+3f+41+d8+04+e5+3f+67+4e+40+c1+38+1b+a1+c0+e1+dd+a0+40+b9+91+91+3c+.^83+00+00+3f+.^82+00+00+3f+00+00+00+da+81+3f+41+50+c7+e3+3f+9c+28+40+c1+77+df+a0+c0+44+1d+a0+40+7f+b7+52+40+.^b4+01+7e+5f+9a+4a+75+69+63+79+20+44+61+74+61+20+30+32+00+90+2e+f3+7b+07+99+eb+9b+43+16+a2+b1+9a+a0+2d+f9+3a+72+f7+8f+cb+d7+e3+80+43+1d+.^83+00+00+1f+.^82+00+00+1f+00+00+00+41+85+40+41+e2+7a+e1+3f+e8+28+40+c1+fc+50+a0+c0+6e+09+9f+40+57+8c+e9+3c+.^82+00+00+1f+00+00+00+41+85+40+41+e2+7a+e1+3f+e8+28+40+c1+fc+50+a0+c0+6e+09+9f+40+57+8c+e9+3c+.^83+00+00+3f+.^82+00+00+3f+00+00+00+ce+79+3f+41+5e+35+e6+3f+5d+a7+3f+c1+4c+81+a0+c0+57+75+9f+40+0b+f3+50+40+.^b4+01+93+99+eb+9b+43+16+a2+b1+9a+a0+2d+f9+3a+72+f7+8f+cb+d7+e3+80+43+1d+12+94+c7+59+78+58+87+6b+d3+8e+04+be+2a+47+d4+cc+f8+6e+6c+26+67+a6+98+5e+4a+75+69+63+79+20+44+61+74+61+20+30+33+00+f0+28+65+.^83+00+00+1f+.^82+00+00+1f+00+00+00+e8+7f+40+41+bf+c7+e1+3f+3c+f0+3f+c1+1a+02+9f+c0+9f+ff+9e+40+a8+59+d3+3c+.^82+00+00+1f+00+00+00+e8+7f+40+41+bf+c7+e1+3f+3c+f0+3f+c1+1a+02+9f+c0+9f+ff+9e+40+a8+59+d3+3c+.^83+00+00+3f+.^82+00+00+3f+00+00+00+49+bc+3f+41+0e+cc+e2+3f+4f+8d+40+c1+a4+81+9f+c0+5c+29+a1+40+ea+53+51+40+.^b4+01+9f+72+f7+8f+cb+d7+e3+80+43+1d+12+94+c7+59+78+58+87+6b+d3+8e+04+be+2a+47+d4+cc+f8+6e+6c+26+67+a6+98+5e+4a+75+69+63+79+20+44+61+74+61+20+30+33+00+f0+28+65+f5+.^83+00+00+1f+.^82+00+00+1f+00+00+00+ff+82+3f+41+e6+d3+e2+3f+51+e5+3f+c1+84+93+a0+c0+89+72+a0+40+bb+a8+9e+3c+.^82+00+00+1f+00+00+00+ff+82+3f+41+e6+d3+e2+3f+51+e5+3f+c1+84+93+a0+c0+89+72+a0+40+bb+a8+9e+3c+.^83+00+00+3f+.^82+00+00+3f+00+00+00+e7+83+40+41+cc+ef+e7+3f+e0+b3+3f+c1+a1+e0+9e+c0+f7+5c+a0+40+08+b6+53+40+.^b4+00+25+7b+91+82+23+fc+65+a6+3a+b0+a1+55+53+eb+5b+d1+8f+be+17+81+cb+6f+35+b6+bf+9e+85+4a+4a+75+69+63+79+20+44+61+74+61+20+.^83+00+00+1f+.^82+00+00+1f+00+00+00+0b+82+3f+41+75+42+e2+3f+1b+7c+3f+c1+b0+c1+a0+c0+4d+c0+9e+40+53+22+b2+bc+.^82+00+00+1f+00+00+00+0b+82+3f+41+75+42+e2+3f+1b+7c+3f+c1+b0+c1+a0+c0+4d+c0+9e+40+53+22+b2+bc+.^83+00+00+3f+.^82+00+00+3f+00+00+00+9c+95+40+41+7e+fc+e8+3f+a3+37+40+c1+cc+78+9f+c0+78+d0+9e+40+8e+fd+51+40+.^b4+01+6e+92+e6+e7+10+ea+d8+a5+70+94+aa+2b+06+6e+84+fe+7c+5f+9a+4a+75+69+63+79+20+44+61+74+61+20+30+32+00+90+2e+f3+7b+07+99+eb+9b+43+16+a2+b1+9a+a0+2d+f9+3a+72+f7+8f+cb+d7+e3+80+43+1d+12+94+c7+.^83+00+00+1f+.^82+00+00+1f+00+00+00+1c+f0+3f+41+6b+5b+e7+3f+8b+78+3f+c1+e3+97+a0+c0+3d+c1+a0+40+b9+f2+d3+bc+.^82+00+00+1f+00+00+00+1c+f0+3f+41+6b+5b+e7+3f+8b+78+3f+c1+e3+97+a0+c0+3d+c1+a0+40+b9+f2+d3+bc+.^83+00+00+3f+.^82+00+00+3f+00+00+00+4a+69+3f+41+05+fb+e9+3f+9d+1b+40+c1+8f+05+a0+c0+a7+08+a0+40+f8+28+51+40+.^b4+00+cf+28+65+f5+e6+8f+3c+ba+5b+35+28+c7+5b+8f+6d+f3+ee+a2+57+23+bb+3b+9c+f0+31+a9+ed+80+2e+42+57+1e+6a+bc+13+50+4b+50+0a+a6+85+32+6d+e0+c2+.^83+00+00+1f+.^82+00+00+1f+00+00+00+46+6c+3f+41+b4+83+e5+3f+32+70+3f+c1+b1+30+a0+c0+d9+d3+a0+40+d9+e9+e1+3c+.^82+00+00+1f+00+00+00+46+6c+3f+41+b4+83+e5+3f+32+70+3f+c1+b1+30+a0+c0+d9+d3+a0+40+d9+e9+e1+3c+.^83+00+00+3f+.^82+00+00+3f+00+00+00+a3+02+40+41+16+a4+e4+3f+ae+6f+40+c1+6e+58+a0+c0+1b+3d+9f+40+b4+be+54+40+.^b4+00+d7+35+28+c7+5b+8f+6d+f3+ee+a2+57+23+bb+3b+9c+f0+31+a9+ed+80+2e+42+57+1e+6a+bc+13+50+4b+50+0a+a6+85+32+6d+e0+c2+da+d3+b0+7c+2b+4a+75+69+63+79+20+44+.^83+00+00+1f+.^82+00+00+1f+00+00+00+9d+8b+3f+41+9f+f0+e8+3f+87+99+3f+c1+e2+e3+9f+c0+0d+a5+9f+40+9c+cb+f6+3c+.^82+00+00+1f+00+00+00+9d+8b+3f+41+9f+f0+e8+3f+87+99+3f+c1+e2+e3+9f+c0+0d+a5+9f+40+9c+cb+f6+3c+.^83+00+00+3f+.^82+00+00+3f+00+00+00+69+fb+3f+41+cd+f3+e5+3f+1e+6b+3f+c1+51+cc+9e+c0+83+0f+a1+40+53+bb+55+40+.^b4+01+c8+74+61+20+30+33+00+f0+28+65+f5+e6+8f+3c+ba+5b+35+28+c7+5b+8f+6d+f3+ee+a2+57+23+bb+3b+9c+f0+31+a9+ed+.^83+00+00+1f+.^82+00+00+1f+00+00+00+14+10+40+41+6d+51+eb+3f+1e+e0+3f+c1+14+39+9f+c0+8a+1f+a0+40+f1+d5+f6+bc+.^82+00+00+1f+00+00+00+14+10+40+41+6d+51+eb+3f+1e+e0+3f+c1+14+39+9f+c0+8a+1f+a0+40+f1+d5+f6+bc+.^83+00+00+3f+.^82+00+00+3f+00+00+00+93+ab+3f+41+d0+e1+e8+3f+9b+7a+3f+c1+5c+dc+9e+c0+d6+bd+9f+40+b5+21+55+40+.^b4+00+4e+d7+ac+75+32+7e+04+f1+95+85+bc+04+bb+72+c4+59+f7+0e+db+9c+c8+9e+bb+14+e2+fe+5b+8c+e6+dd+e5+70+b5+92+e6+e7+10+ea+.^83+00+00+1f+.^82+00+00+1f+00+00+00+0e+a7+3f+41+ce+3c+e4+3f+81+5e+40+c1+ab+9d+9f+c0+16+e4+9e+40+be+5a+73+3c+.^82+00+00+1f+00+00+00+0e+a7+3f+41+ce+3c+e4+3f+81+5e+40+c1+ab+9d+9f+c0+16+e4+9e+40+be+5a+73+3c+.^83+00+00+3f+.^82+00+00+3f+00+00+00+93+32+40+41+cb+04+e6+3f+0f+c1+3f+c1+92+50+a0+c0+60+3f+9f+40+7c+25+54+40+.^b4+00+a5+80+43+1d+12+94+c7+59+78+58+87+6b+d3+8e+04+be+2a+47+d4+cc+f8+6e+6c+26+67+a6+98+5e+4a+75+69+63+79+20+44+61+74+61+20+30+33+00+f0+28+65+f5+e6+8f+.^83+00+00+1f+.^82+00+00+1f+00+00+00+f6+69+40+41+f6+a2+e1+3f+7c+8b+40+c1+a4+c9+9f+c0+90+10+a0+40+71+57+1d+bd+.^82+00+00+1f+00+00+00+f6+69+40+41+f6+a2+e1+3f+7c+8b+40+c1+a4+c9+9f+c0+90+10+a0+40+71+57+1d+bd+.^83+00+00+3f+.^82+00+00+3f+00+00+00+87+03+40+41+2e+20+e3+3f+48+64+40+c1+09+cc+9f+c0+f8+27+a1+40+63+89+53+40+.^b4+00+31+eb+5b+d1+8f+be+17+81+cb+6f+35+b6+bf+9e+85+4a+4a+75+69+63+79+20+44+61+74+61+20+30+31+00+d7+ac+75+32+7e+04+.^83+00+00+1f+.^82+00+00+1f+00+00+00+a3+11+40+41+4d+35+e8+3f+d3+94+40+c1+82+60+9f+c0+ea+cf+a0+40+4e+4f+04+3d+.</span><br><span class="line"></span><br><span class="line">+++</span><br><span class="line">NO CARRIER</span><br></pre></td></tr></table></figure>

<p>根据题目描述，回显的字符串应该是某种总线协议数据，需要参赛者识别是哪种总线协议并对其进行解析，按照协议格式提交请求，以获取隐藏的信息。</p>
<p><strong>背景知识</strong></p>
<p>$I^2C$（Inter-Integrated Circuit，集成电路总线）是一种串行通信总线，使用多主从架构，由飞利浦公司在20世纪80年代为了使用主板，嵌入式系统或手机连接低速周边设备而研发。</p>
<p>$I^2C$仅使用两条线在连接到总线的设备间传送信息，其中一条线为串行数据线（SDA），另一条线为串行时钟线（SCL）。总线上的每个设备都有唯一的地址区分。通常$I^2C$在硬件设计中作为传感器接口和EEPROM存储器的接口使用。</p>
<ol>
<li>基础信号<br>$I^2C$协议的基础信号包括起始信号（START），停止信号（STOP），应答信号（ACK）和非应答信号（NAK）。</li>
</ol>
<ul>
<li>START信号和STOP信号均由主设备产生。所有信息传输都从START信号开始，以STOP信号结束。START信号和STOP信号之间的阶段认为$I^2C$总线处于忙碌（busy）状态。</li>
<li>$I^2C$有完善的应答机制，每个字节后面必须跟一个ACK信号或NAK信号。</li>
</ul>
<ol start="2">
<li>读&#x2F;写时序<br>紧跟START信号之后的是7bit的从设备地址，然后是1bit读&#x2F;写位，该读&#x2F;写位表示主设备想要与从设备进行读（“1”）或写（“0”）操作，如果对应的从设备在总线上，那么它将以ACK信号应答。<br>向指定从设备写入数据的操作时序如下图所示：<br><img src="/2025/10/09/hackasat-2020-quals/1.jpg" alt="alt text"><br>读取从设备数据的操作时序如下图所示：<br><img src="/2025/10/09/hackasat-2020-quals/2.jpg" alt="alt text"><br>注意，本题目读&#x2F;写位实际语义与$I^2C$协议相反，具体见题目解析。</li>
</ol>
<p>可以发现回显的信息是以 <code>^</code> 和 <code>.</code> 两种字符分割的，每行都是以 <code>^</code> 开始，以 <code>.</code> 结束的，因此 <code>^</code> 和 <code>.</code> 应该是控制字符。通过搜索卫星总线常用的总线协议的报文格式，初步判断上述字符串最有可能为$I^2C$协议。下面尝试按$I^2C$来解析。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">^82+00+00+1f+00+00+00+12+47+40+41+c6+97+e1+3f+89+81+3f+c1+99+1d+a1+c0+20+18+a1+40+5e+42+ac+3c+.</span><br><span class="line">^83+00+00+3f+.</span><br><span class="line">^82+00+00+3f+00+00+00+20+fa+3f+41+c8+da+e2+3f+a6+64+3f+c1+ff+33+a1+c0+a4+d2+a0+40+de+50+55+40+.</span><br><span class="line">^b4+01+c9+61+20+30+33+00+f0+28+65+f5+e6+8f+3c+ba+5b+35+28+c7+5b+8f+6d+f3+ee+a2+57+23+bb+3b+9c+f0+31+a9+ed+80+2e+42+57+.</span><br><span class="line">^83+00+00+1f+.</span><br><span class="line">^82+00+00+1f+00+00+00+1d+ec+3f+41+d8+04+e5+3f+67+4e+40+c1+38+1b+a1+c0+e1+dd+a0+40+b9+91+91+3c+.</span><br><span class="line">.....（省略）</span><br></pre></td></tr></table></figure>

<p>若是$I^2C$协议，由上文的背景知识可知，<code>^</code> 为$I^2C$总线START信号，<code>.</code> 为$I^2C$总线STOP信号。<code>^</code> 后面的1字节由7bit从设备地址和最低位的1bit读&#x2F;写位构成。</p>
<p>所有 <code>^</code> 后的第1字节只有 0x82，0x83，0xb4 3种，将从设备地址和1bit读&#x2F;写位从中剥离开，如下表所示。<br><img src="/2025/10/09/hackasat-2020-quals/4.jpg" alt="alt text"></p>
<p>由上表可知，本题的$I^2C$总线上仅有两种从设备，地址分别为0x82和0xb4，为方便，将其分别命名为slave_82，slave_b4。</p>
<p>若按照上表解析回显信息，则仅由 <code>^83</code> 开头的行是读操作，这些行的内容仅有 <code>^83+00+00+3f+.</code> 和 <code>^83+00+00+1f+.</code> 两种，有效字节数仅为4，不可能包含flag{xxxxx}形式的信息。并且这几个字符转换为ASCII后，是非打印字符。因此本题的读&#x2F;写位实际语义与上表不同，将其反过来，如下表所示。<br><img src="/2025/10/09/hackasat-2020-quals/5.jpg" alt="alt text">&#96;</p>
<p>按照上表的语义解析回显信息，各行完成的功能如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">// 从slave_82读取数据</span><br><span class="line">^82+00+00+1f+00+00+00+12+47+40+41+c6+97+e1+3f+89+81+3f+c1+99+1d+a1+c0+20+18+a1+40+5e+42+ac+3c+.</span><br><span class="line"></span><br><span class="line">// 向slave_82写入数据</span><br><span class="line">^83+00+00+3f+.</span><br><span class="line"></span><br><span class="line">// 从slave_82读取数据</span><br><span class="line">^82+00+00+3f+00+00+00+20+fa+3f+41+c8+da+e2+3f+a6+64+3f+c1+ff+33+a1+c0+a4+d2+a0+40+de+50+55+40+.</span><br><span class="line"></span><br><span class="line">// 从slave_b4读取数据</span><br><span class="line">^b4+01+c9+61+20+30+33+00+f0+28+65+f5+e6+8f+3c+ba+5b+35+28+c7+5b+8f+6d+f3+ee+a2+57+23+bb+3b+9c+f0+31+a9+ed+80+2e+42+57+.</span><br><span class="line"></span><br><span class="line">// 向slave_82写入数据</span><br><span class="line">^83+00+00+1f+.</span><br><span class="line"></span><br><span class="line">// 从slave_82读取数据</span><br><span class="line">^82+00+00+1f+00+00+00+1d+ec+3f+41+d8+04+e5+3f+67+4e+40+c1+38+1b+a1+c0+e1+dd+a0+40+b9+91+91+3c+.</span><br><span class="line"></span><br><span class="line">.....（省略）</span><br></pre></td></tr></table></figure>

<p>为便于理解，将上面的操作顺序绘制成图，如下图所示。<br><img src="/2025/10/09/hackasat-2020-quals/6.jpg" alt="alt text"></p>
<p>上图中，每次写操作后都紧跟着一个针对同样地址的读操作（不仅这里分析的前6行如此，在全部的回显信息种都是如此），基本可以确定这是一种确认机制，读操作将修改后的数值打印出来，便于检查写操作是否修改了对应数值。</p>
<p>此外，可以发现所有以 <code>^b4</code> 开头的行都较长，题目的flag可能就藏在地址为0xb4是设备内存中，该设备应为某种存储设备，后面为方便将其命名为EEP。</p>
<p>写操作对应行为 <code>^83+00+00+3f+.</code> ，由$I^2C$的背景知识可知，”00 00 3f”为写入的内容。与对应的读操作行相应位置内容比较，由写操作的”00 00 3f”变为读操作的”00 00 1f”，变化的仅有第3字节，且前2字节始终为0，所以下面只对第3字节进行分析，如下图所示。<br><img src="/2025/10/09/hackasat-2020-quals/7.jpg" alt="alt text"></p>
<p>上图中，每次读取EEP内存数据前，都有一个对slave_82的写操作（写入内容为3f），结合第1行初始时slave_82对应位置为1f，第6行结束时slave_82对应位置也为1f，可以总结出如下的操作步骤。</p>
<ul>
<li>每次读取EEP前，都要对slave_82进行写操作。</li>
<li>每次读取EEP后，slave_82都会被再次写入，恢复其初始状态。</li>
</ul>
<p>很明显，slave_82控制着EEP的开与关，参考卫星设计的有关文献，猜测slave_82为电源控制系统，将其命名为EPS。EEP电源开关打开与关闭时对应的EPS状态如下表所示。<br><img src="/2025/10/09/hackasat-2020-quals/8.jpg" alt="alt text"></p>
<p>由EEP电源开关在打开与关闭两种状态对应的二进制形式的EPS状态可知，表示EPS状态（二进制）的第6位（从右向左数）代表EEP。</p>
<p>题目描述说正在监听的总线非常繁忙，也就是说$I^2C$总线在大部分时间被主设备占用，要获取EEP中的数据，就必须将主设备电源开关关闭释放总线，并将EEP电源开关打开。这可以通过将表示EPS状态（二进制）的第6位（从右向左数）置1，其他位置0来实现。</p>
<p>由于这是一个非常繁忙的总线，在每次轮询期间仅有几秒的停顿时间，因此需要利用这个间隙期发送写EPS的命令，将EPS状态设为0010 0000（仅第6位设置为1），即仅将EEP电源开关打开。</p>
<p>EEP电源开关打开后，读取EEP的全部内存，从中搜寻flag即可。</p>
<p>构建solver镜像</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build solver -t bus:solver</span><br></pre></td></tr></table></figure>

<p>测试</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">socat -v tcp-listen:31340,reuseaddr exec:&quot;docker run --rm -i -e SEED=1234 -e FLAG=flag&#123;1234&#125;  bus\:challenge&quot;</span><br><span class="line"></span><br><span class="line">docker run -it --rm -e &quot;HOST=172.17.0.1&quot; -e &quot;PORT=31340&quot;  bus:solver</span><br></pre></td></tr></table></figure>

<h1 id="地面段信息安全"><a href="#地面段信息安全" class="headerlink" title="地面段信息安全"></a>地面段信息安全</h1><h2 id="verizon"><a href="#verizon" class="headerlink" title="verizon"></a>verizon</h2><p>构建challenge镜像</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build challenge -t verizon:challenge</span><br></pre></td></tr></table></figure>

<p>然后</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">socat -v tcp-listen:31333,reuseaddr exec:&quot;docker run --rm -i -p 31336\:8123 -e SEED=1234 -e FLAG=flag&#123;1234&#125; -e SERVICE_HOST=10.249.10.107 -e SERVICE_PORT=31336 verizon\:challenge&quot;</span><br></pre></td></tr></table></figure>

<p>后面就能通过nc与31333端口交互</p>
<p>本挑战题的背景是LaunchDotCom地面站正在从Carnac1.0卫星接收遥测数据。本挑战题要求根据XTCE定义实现解码器，从而实现对遥测数据的解码。</p>
<p>使用nc连接到靶机后，显示遥测服务正在发送一系列二进制数据，打印出来是乱码，参赛者需要对此二进制数据，根据XTCE定义实现解码，才可得到flag值。<br><img src="/2025/10/09/hackasat-2020-quals/1.png" alt="alt text"></p>
<p>题目还给出了一个XTCE格式的文件telemetry.xtce。XTCE是描述遥测和命令的数据规范，通过该文件可以解析遥测服务发送的二进制数据的含义。</p>
<p>通过快速查看XTCE文件，可以找到flag是如何定义的，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- Parameters used by FLAG Gen  --&gt;</span><br><span class="line">&lt;xtce:Parameter parameterTypeRef=&quot;7BitInteger&quot; name=&quot;FLAG11&quot;/&gt;</span><br><span class="line">&lt;xtce:Parameter parameterTypeRef=&quot;7BitInteger&quot; name=&quot;FLAG12&quot;/&gt;</span><br><span class="line">&lt;xtce:Parameter parameterTypeRef=&quot;7BitInteger&quot; name=&quot;FLAG13&quot;/&gt;</span><br><span class="line">&lt;xtce:Parameter parameterTypeRef=&quot;7BitInteger&quot; name=&quot;FLAG14&quot;/&gt;</span><br><span class="line">&lt;xtce:Parameter parameterTypeRef=&quot;7BitInteger&quot; name=&quot;FLAG15&quot;/&gt;</span><br><span class="line">&lt;xtce:Parameter parameterTypeRef=&quot;7BitInteger&quot; name=&quot;FLAG16&quot;/&gt;</span><br><span class="line">&lt;xtce:Parameter parameterTypeRef=&quot;7BitInteger&quot; name=&quot;FLAG17&quot;/&gt;</span><br><span class="line">&lt;xtce:Parameter parameterTypeRef=&quot;7BitInteger&quot; name=&quot;FLAG18&quot;/&gt;</span><br><span class="line">&lt;xtce:Parameter parameterTypeRef=&quot;7BitInteger&quot; name=&quot;FLAG19&quot;/&gt;</span><br><span class="line">&lt;xtce:Parameter parameterTypeRef=&quot;7BitInteger&quot; name=&quot;FLAG10&quot;/&gt;</span><br><span class="line">&lt;xtce:Parameter parameterTypeRef=&quot;7BitInteger&quot; name=&quot;FLAG1&quot;/&gt;</span><br><span class="line">&lt;xtce:Parameter parameterTypeRef=&quot;7BitInteger&quot; name=&quot;FLAG2&quot;/&gt;</span><br><span class="line">&lt;xtce:Parameter parameterTypeRef=&quot;7BitInteger&quot; name=&quot;FLAG3&quot;/&gt;</span><br><span class="line">&lt;xtce:Parameter parameterTypeRef=&quot;7BitInteger&quot; name=&quot;FLAG4&quot;/&gt;</span><br><span class="line">&lt;xtce:Parameter parameterTypeRef=&quot;7BitInteger&quot; name=&quot;FLAG5&quot;/&gt;</span><br><span class="line">&lt;xtce:Parameter parameterTypeRef=&quot;7BitInteger&quot; name=&quot;FLAG6&quot;/&gt;</span><br><span class="line">&lt;xtce:Parameter parameterTypeRef=&quot;7BitInteger&quot; name=&quot;FLAG7&quot;/&gt;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>可以看出每一个flag中的字符都是7位编码的，但是计算机中8位ASCII码表示一个字符，这意味着原始二进制文件中不会看到有意义的flag。</p>
<p>在SequenceContainer中，我们可以看到包的结构。包头结构如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;xtce:SequenceContainer name=&quot;AbstractTM Packet Header&quot; shortDescription=&quot;CCSDS TM Packet Header&quot; abstract=&quot;true&quot;&gt;</span><br><span class="line">   &lt;xtce:EntryList&gt;</span><br><span class="line">       &lt;xtce:ParameterRefEntry parameterRef=&quot;CCSDS_VERSION&quot;/&gt;</span><br><span class="line">       &lt;xtce:ParameterRefEntry parameterRef=&quot;CCSDS_TYPE&quot;/&gt;</span><br><span class="line">       &lt;xtce:ParameterRefEntry parameterRef=&quot;CCSDS_SEC_HD&quot;/&gt;</span><br><span class="line">       &lt;xtce:ParameterRefEntry parameterRef=&quot;CCSDS_APID&quot;/&gt;</span><br><span class="line">       &lt;xtce:ParameterRefEntry parameterRef=&quot;CCSDS_GP_FLAGS&quot;/&gt;</span><br><span class="line">       &lt;xtce:ParameterRefEntry parameterRef=&quot;CCSDS_SSC&quot;/&gt;</span><br><span class="line">       &lt;xtce:ParameterRefEntry parameterRef=&quot;CCSDS_PLENGTH&quot;/&gt;</span><br><span class="line">   &lt;/xtce:EntryList&gt;</span><br></pre></td></tr></table></figure>

<p>该部分指定了一个名为AbstractTM Packet Header的容器。注意parameterRef参数，它指向ParameterSet部分先前定义的参数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;xtce:ParameterSet&gt;</span><br><span class="line">   &lt;!-- Parameters used by space packet primary header --&gt;</span><br><span class="line">   &lt;xtce:Parameter parameterTypeRef=&quot;3BitInteger&quot; name=&quot;CCSDS_VERSION&quot;/&gt;</span><br><span class="line">   &lt;xtce:Parameter parameterTypeRef=&quot;1BitInteger&quot; name=&quot;CCSDS_TYPE&quot;/&gt;</span><br><span class="line">   &lt;xtce:Parameter parameterTypeRef=&quot;1BitInteger&quot; name=&quot;CCSDS_SEC_HD&quot;/&gt;</span><br><span class="line">   &lt;xtce:Parameter parameterTypeRef=&quot;11BitInteger&quot; name=&quot;CCSDS_APID&quot;/&gt;</span><br><span class="line">   &lt;xtce:Parameter parameterTypeRef=&quot;2BitInteger&quot; name=&quot;CCSDS_GP_FLAGS&quot;/&gt;</span><br><span class="line">   &lt;xtce:Parameter parameterTypeRef=&quot;14BitInteger&quot; name=&quot;CCSDS_SSC&quot;/&gt;</span><br><span class="line">   &lt;xtce:Parameter parameterTypeRef=&quot;2ByteInteger&quot; name=&quot;CCSDS_PLENGTH&quot;/&gt;</span><br></pre></td></tr></table></figure>

<p>从这里我们可以得知，包头结构如下图所示：<br><img src="/2025/10/09/hackasat-2020-quals/3.jpg" alt="alt text"></p>
<p>如果把以上所有的字段加起来，会得到一个6字节长的包头。其中我们观察到CCSDS_APID参数，本题目中APID的含义是应用过程识别符，它能够唯一标识特定类型数据包的类型ID。</p>
<p>查看flag包的格式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"> &lt;xtce:SequenceContainer name=&quot;AbstractFlag Packet&quot; shortDescription=&quot;Flag TM Packet Header&quot; abstract=&quot;true&quot;&gt;</span><br><span class="line">    &lt;xtce:EntryList&gt;</span><br><span class="line">        &lt;xtce:ParameterRefEntry parameterRef=&quot;FLAG1&quot;/&gt;</span><br><span class="line">        &lt;xtce:ParameterRefEntry parameterRef=&quot;FLAG2&quot;/&gt;</span><br><span class="line">        &lt;xtce:ParameterRefEntry parameterRef=&quot;FLAG3&quot;/&gt;</span><br><span class="line">        &lt;xtce:ParameterRefEntry parameterRef=&quot;FLAG4&quot;/&gt;</span><br><span class="line">        &lt;xtce:ParameterRefEntry parameterRef=&quot;FLAG5&quot;/&gt;</span><br><span class="line">        &lt;xtce:ParameterRefEntry parameterRef=&quot;FLAG6&quot;/&gt;</span><br><span class="line">        &lt;xtce:ParameterRefEntry parameterRef=&quot;FLAG7&quot;/&gt; </span><br><span class="line">        &lt;xtce:ParameterRefEntry parameterRef=&quot;FLAG8&quot;/&gt;</span><br><span class="line">        &lt;xtce:ParameterRefEntry parameterRef=&quot;FLAG9&quot;/&gt;</span><br><span class="line">        &lt;xtce:ParameterRefEntry parameterRef=&quot;FLAG10&quot;/&gt;</span><br><span class="line">        &lt;xtce:ParameterRefEntry parameterRef=&quot;FLAG11&quot;/&gt;</span><br><span class="line">        &lt;xtce:ParameterRefEntry parameterRef=&quot;FLAG12&quot;/&gt;</span><br><span class="line">        &lt;xtce:ParameterRefEntry parameterRef=&quot;FLAG13&quot;/&gt;</span><br><span class="line">        &lt;xtce:ParameterRefEntry parameterRef=&quot;FLAG14&quot;/&gt;</span><br><span class="line">        &lt;xtce:ParameterRefEntry parameterRef=&quot;FLAG15&quot;/&gt;</span><br><span class="line">        &lt;xtce:ParameterRefEntry parameterRef=&quot;FLAG16&quot;/&gt;</span><br><span class="line">        &lt;xtce:ParameterRefEntry parameterRef=&quot;FLAG17&quot;/&gt;</span><br><span class="line">        &lt;xtce:ParameterRefEntry parameterRef=&quot;FLAG18&quot;/&gt;</span><br><span class="line">        ......</span><br><span class="line">        &lt;xtce:ParameterRefEntry parameterRef=&quot;FLAG110&quot;/&gt;</span><br><span class="line">        &lt;xtce:ParameterRefEntry parameterRef=&quot;FLAG111&quot;/&gt;</span><br><span class="line">        &lt;xtce:ParameterRefEntry parameterRef=&quot;FLAG112&quot;/&gt;</span><br><span class="line">        &lt;xtce:ParameterRefEntry parameterRef=&quot;FLAG113&quot;/&gt;</span><br><span class="line">        &lt;xtce:ParameterRefEntry parameterRef=&quot;FLAG114&quot;/&gt;</span><br><span class="line">        &lt;xtce:ParameterRefEntry parameterRef=&quot;FLAG115&quot;/&gt;</span><br><span class="line">        &lt;xtce:ParameterRefEntry parameterRef=&quot;FLAG116&quot;/&gt;</span><br><span class="line">        &lt;xtce:ParameterRefEntry parameterRef=&quot;FLAG117&quot;/&gt;</span><br><span class="line">        &lt;xtce:ParameterRefEntry parameterRef=&quot;FLAG118&quot;/&gt;</span><br><span class="line">        &lt;xtce:ParameterRefEntry parameterRef=&quot;FLAG119&quot;/&gt;</span><br><span class="line">        &lt;xtce:ParameterRefEntry parameterRef=&quot;FLAG120&quot;/&gt;</span><br><span class="line"> &lt;/xtce:EntryList&gt;</span><br><span class="line">    &lt;xtce:BaseContainer containerRef=&quot;AbstractTM Packet Header&quot;&gt;</span><br><span class="line">        &lt;xtce:RestrictionCriteria&gt;</span><br><span class="line">            &lt;xtce:ComparisonList&gt;</span><br><span class="line">                &lt;xtce:Comparison parameterRef=&quot;CCSDS_VERSION&quot; value=&quot;0&quot;/&gt;</span><br><span class="line">                &lt;xtce:Comparison parameterRef=&quot;CCSDS_TYPE&quot; value=&quot;0&quot;/&gt;</span><br><span class="line">                &lt;xtce:Comparison parameterRef=&quot;CCSDS_SEC_HD&quot; value=&quot;0&quot;/&gt;</span><br><span class="line">                &lt;xtce:Comparison parameterRef=&quot;CCSDS_APID&quot; value=&quot;102&quot;/&gt;</span><br><span class="line">            &lt;/xtce:ComparisonList&gt;</span><br><span class="line">        &lt;/xtce:RestrictionCriteria&gt;</span><br><span class="line">    &lt;/xtce:BaseContainer&gt;</span><br><span class="line"> &lt;/xtce:SequenceContainer&gt;</span><br><span class="line"> &lt;/xtce:ContainerSet&gt;</span><br><span class="line">&lt;/xtce:TelemetryMetaData&gt;</span><br><span class="line">&lt;/xtce:SpaceSystem&gt;</span><br></pre></td></tr></table></figure>

<p>我们可以在这里看到一个新的部分-RestrictionCriteria（限制标准）。限制标准是一种匹配条件。该部分告诉我们，解析器应该满足哪些条件才能将内容解析为flag包。也就是说，flag包的包头满足以下条件。<br>（1）CCSDS_VERSION为0<br>（2）CCSDS_TYPE为0<br>（3）CCSDS_SEC_HD为0<br>（4）CCSDS_APID为102</p>
<p>因此，这道题目的解题思路可以分为以下4步：<br>（1）根据先前分析的包头结构，解码出包头APID的值<br>（2）取出APID为102的数据包，即flag包<br>（3）针对该数据包，依次提取7bit的字符，在最高位加0，变为8bit的ASCII字符<br>（4）将转换后的字符拼接即可</p>
<p>solve.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> bitstring</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">FLAG_APID = <span class="number">102</span></span><br><span class="line">EPS_APID = <span class="number">103</span></span><br><span class="line">PAYLOAD_APID = <span class="number">105</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    Host = <span class="string">&#x27;10.249.10.107&#x27;</span></span><br><span class="line">    Port = <span class="number">31333</span></span><br><span class="line"></span><br><span class="line">    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    sock.connect((Host, Port))</span><br><span class="line">    </span><br><span class="line">    ticket = os.getenv(<span class="string">&quot;TICKET&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(ticket):</span><br><span class="line">        sock.recv(<span class="number">128</span>)</span><br><span class="line">        sock.send((ticket + <span class="string">&quot;\n&quot;</span>).encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line"></span><br><span class="line">    line = sock.recv(<span class="number">128</span>)</span><br><span class="line">    sock.close()</span><br><span class="line"></span><br><span class="line">    Host, Port = line.split(<span class="string">b&quot; &quot;</span>)[-<span class="number">1</span>].split(<span class="string">b&quot;:&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(Host,Port)</span><br><span class="line">    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    sock.connect((Host, <span class="built_in">int</span>(Port)))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        data = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">while</span> <span class="built_in">len</span>(data) &lt; <span class="number">6</span>:</span><br><span class="line">            data += sock.recv(<span class="number">6</span> - <span class="built_in">len</span>(data))</span><br><span class="line">        </span><br><span class="line">        s = bitstring.BitArray(data)</span><br><span class="line">        version, <span class="built_in">type</span>, sec_header, apid, sequence_flags, sequence_count, data_length = s.unpack(<span class="string">&#x27;uint:3, uint:1, uint:1, uint:11, uint:2, uint:14, uint:16&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;APID: &#123;&#125;\nLength: &#123;&#125;\n&quot;</span>.<span class="built_in">format</span>(apid, data_length))</span><br><span class="line">        data = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> <span class="built_in">len</span>(data) &lt; data_length+<span class="number">1</span>:</span><br><span class="line">            data += sock.recv(data_length+<span class="number">1</span> - <span class="built_in">len</span>(data))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> apid != FLAG_APID:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Ignoring APID we don&#x27;t care about&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        s = bitstring.ConstBitStream(data)</span><br><span class="line">        char = <span class="string">&#x27; &#x27;</span></span><br><span class="line">        flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">while</span> char != <span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">            char = <span class="built_in">chr</span>(s.read(<span class="string">&#x27;uint:7&#x27;</span>))</span><br><span class="line">            flag += char</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h2 id="goose"><a href="#goose" class="headerlink" title="goose"></a>goose</h2><p>构建challenge镜像</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build challenge -t goose:challenge</span><br></pre></td></tr></table></figure>

<p>然后</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">socat -v tcp-listen:31335,reuseaddr exec:&quot;docker run --rm -i -p 31336\:8123 -e SEED=1234 -e FLAG=flag&#123;1234&#125; -e SERVICE_HOST=10.249.10.107 -e SERVICE_PORT=31336 goose\:challenge&quot;</span><br></pre></td></tr></table></figure>

<p>后面就能通过nc与31335端口交互</p>
<p>LaunchDotCom公司有一颗新的卫星-Carnac2.0。卫星地面站正在与其进行遥测数据接收，遥控指令发送。本挑战题要求根据卫星的设计文档，思考如何获取flag。</p>
<p>使用nc连接到靶机后，显示遥测服务正在发送一系列二进制数据，打印出来是乱码，参赛者需要研究这颗新卫星的设计文档，从中解码出flag值。</p>
<p>solve.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> bitstring</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">FLAG_APID = <span class="number">102</span></span><br><span class="line">EPS_APID = <span class="number">103</span></span><br><span class="line">PAYLOAD_APID = <span class="number">105</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">cmdSender</span>:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, APID</span>):</span><br><span class="line">        <span class="variable language_">self</span>.packet_version = <span class="number">0</span></span><br><span class="line">        <span class="variable language_">self</span>.packet_type = <span class="number">1</span> <span class="comment">#command</span></span><br><span class="line">        <span class="variable language_">self</span>.sec_header_flag = <span class="number">0</span> <span class="comment"># no secondary header</span></span><br><span class="line">        <span class="variable language_">self</span>.APID = APID</span><br><span class="line">        <span class="variable language_">self</span>.sequence_flags = <span class="number">3</span> <span class="comment"># its a complete packet, not fragmented</span></span><br><span class="line">        <span class="variable language_">self</span>.packet_sequence_count = random.randint(<span class="number">1000</span>, <span class="number">10000</span>)</span><br><span class="line">        <span class="variable language_">self</span>.packet_data_length = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">sendCMD</span>(<span class="params">self, socket, payload</span>):</span><br><span class="line">        <span class="variable language_">self</span>.packet_data_length = <span class="built_in">len</span>(payload) - <span class="number">1</span></span><br><span class="line">        packet = bitstring.pack(<span class="string">&#x27;uint:3, uint:1, uint:1, uint:11, uint:2, uint:14, uint:16&#x27;</span>,</span><br><span class="line">            <span class="variable language_">self</span>.packet_version, <span class="variable language_">self</span>.packet_type, <span class="variable language_">self</span>.sec_header_flag, <span class="variable language_">self</span>.APID, <span class="variable language_">self</span>.sequence_flags,</span><br><span class="line">            <span class="variable language_">self</span>.packet_sequence_count, <span class="variable language_">self</span>.packet_data_length)</span><br><span class="line">        packethdr = packet.tobytes()</span><br><span class="line">        wholepacket = packethdr + payload</span><br><span class="line">        <span class="variable language_">self</span>.packet_sequence_count += <span class="number">1</span></span><br><span class="line">        socket.send(wholepacket)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    Host = <span class="string">&#x27;10.249.10.107&#x27;</span></span><br><span class="line">    Port = <span class="number">31335</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(Host,Port)</span><br><span class="line">    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    sock.connect((Host, Port))</span><br><span class="line">    </span><br><span class="line">    ticket = os.getenv(<span class="string">&quot;TICKET&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(ticket):</span><br><span class="line">        sock.recv(<span class="built_in">len</span>(<span class="string">&quot;Ticket please:\n&quot;</span>))</span><br><span class="line">        sock.send((ticket+<span class="string">&quot;\n&quot;</span>).encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Sent: &quot;</span> + ticket)</span><br><span class="line"></span><br><span class="line">    line = sock.recv(<span class="number">256</span>)</span><br><span class="line">    sock.close()</span><br><span class="line">    </span><br><span class="line">    Host, Port = line.split(<span class="string">b&quot; &quot;</span>)[-<span class="number">1</span>].split(<span class="string">b&quot;:&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(Host,Port)</span><br><span class="line">    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    sock.connect((Host, <span class="built_in">int</span>(Port)))</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># first enable the flag generator</span></span><br><span class="line">    cmd = cmdSender(EPS_APID)</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    cmd.sendCMD(sock, <span class="string">b&#x27;\x00\x02\x01&#x27;</span>)</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="comment"># now lower the low_pwr_threshold so that subsystem will come on</span></span><br><span class="line">    cmd.sendCMD(sock, <span class="string">b&#x27;\x00\x0c\x03\xde&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        data = sock.recv(<span class="number">6</span>)</span><br><span class="line">        s = bitstring.BitArray(data)</span><br><span class="line">        version, <span class="built_in">type</span>, sec_header, apid, sequence_flags, sequence_count, data_length = s.unpack(<span class="string">&#x27;uint:3, uint:1, uint:1, uint:11, uint:2, uint:14, uint:16&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;APID: &#123;&#125;\nLength: &#123;&#125;\n&quot;</span>.<span class="built_in">format</span>(apid, data_length))</span><br><span class="line">        data = sock.recv(data_length+<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> apid != FLAG_APID:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Ignoring APID we don&#x27;t care about&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        s = bitstring.ConstBitStream(data)</span><br><span class="line">        char = <span class="string">&#x27; &#x27;</span></span><br><span class="line">        flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">while</span> char != <span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">            char = <span class="built_in">chr</span>(s.read(<span class="string">&#x27;uint:7&#x27;</span>))</span><br><span class="line">            flag += char</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h1 id="通信系统信息安全"><a href="#通信系统信息安全" class="headerlink" title="通信系统信息安全"></a>通信系统信息安全</h1><h2 id="phasor"><a href="#phasor" class="headerlink" title="phasor"></a>phasor</h2><p>主办方向参赛者提供了一个challenge.wav文件，其内容是一段SDR（Software Defined Radio，软件无线电）捕获的数据，要求参赛者去解调它，并从中找到flag。</p>
<p>对于这一类题型，我们可以使用Universal Radio Hacker（URH）工具来解调。URH工具是一个用于逆向解析和攻击无线通信协议的开源工具，可以对原始采样信号进行解调解码，将收到的信号映射成bit数据，并将bit数据解析成可读性高的文本。</p>
<h1 id="天体测量信息安全"><a href="#天体测量信息安全" class="headerlink" title="天体测量信息安全"></a>天体测量信息安全</h1><h2 id="matters-of-state"><a href="#matters-of-state" class="headerlink" title="matters_of_state"></a>matters_of_state</h2><p>Dockerfile里要把python-dev换为python3-dev</p>
<p>requirements.txt修改为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">orbitalpy==0.7.0</span><br><span class="line">numpy</span><br><span class="line">represent==1.6.0.post0</span><br></pre></td></tr></table></figure>

<p>先构建docker镜像</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build challenge -t matters_of_state:challenge</span><br></pre></td></tr></table></figure>

<p>然后</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">socat -v tcp-listen:12345,reuseaddr exec:&quot;docker run --rm -i -e SEED=1465500232115169100 -e FLAG=flag&#123;TESTflag1234&#125; matters_of_state\:challenge&quot;</span><br></pre></td></tr></table></figure>

<p>后面就能通过nc与12345端口交互</p>
<p>challenge.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> orbital</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> astropy </span><br><span class="line"><span class="keyword">from</span> timeout <span class="keyword">import</span> timeout,TimeoutError</span><br><span class="line"></span><br><span class="line">to = <span class="built_in">int</span>( os.getenv(<span class="string">&quot;TIMEOUT&quot;</span>,<span class="number">120</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">str_to_vec</span>(<span class="params"> str_in </span>):</span><br><span class="line">    vec =  np.fromstring( str_in , dtype=<span class="built_in">float</span>, count=-<span class="number">1</span> , sep=<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span>( vec.size != <span class="number">3</span> ):</span><br><span class="line">        <span class="keyword">raise</span> <span class="string">&quot;Vector doesnt have 3 elements&quot;</span></span><br><span class="line">    <span class="keyword">return</span> vec</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">single</span>( ):</span><br><span class="line">    pos_tolerance = <span class="number">10.0</span></span><br><span class="line">    vel_tolerance = <span class="number">0.1</span></span><br><span class="line">    correct = <span class="literal">True</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Orbital Elements: &quot;</span>)</span><br><span class="line">    RE = <span class="number">6378.0</span></span><br><span class="line">    a = <span class="number">10.0</span> * RE</span><br><span class="line">    e =  <span class="number">0.3</span> </span><br><span class="line">    i = <span class="number">63.0</span> </span><br><span class="line">    RAAN =  <span class="number">25.0</span> </span><br><span class="line">    peri = <span class="number">78.0</span></span><br><span class="line">    mu = <span class="number">398600.5</span>  <span class="comment"># km^3 / s^2</span></span><br><span class="line">    n = np.sqrt( mu / np.power(a,<span class="number">3</span>))</span><br><span class="line">    M = <span class="number">10.0</span> <span class="comment">#random.random( ) * 360.0</span></span><br><span class="line">    times = [<span class="string">&#x27;2022-01-01T00:00:00&#x27;</span>]</span><br><span class="line">    t = astropy.time.Time(times, <span class="built_in">format</span>=<span class="string">&#x27;isot&#x27;</span>, scale=<span class="string">&#x27;utc&#x27;</span>)    </span><br><span class="line">    orbit = orbital.elements.KeplerianElements( a=a*<span class="number">1000.0</span>, e=e, i=np.deg2rad(i), raan=np.deg2rad(RAAN) , arg_pe=np.deg2rad(peri), M0=np.deg2rad(M), body=orbital.bodies.earth , ref_epoch=t )</span><br><span class="line">    orbit.propagate_anomaly_by(M=<span class="number">0.0</span>)</span><br><span class="line">    pos_truth = orbit.r/<span class="number">1000.0</span></span><br><span class="line">    vel_truth = orbit.v/<span class="number">1000.0</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Given the following orbit elements: &quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;semi-major axis: &#123;&#125; km&quot;</span>.<span class="built_in">format</span>(a))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;eccentricity: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(e))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;inclination: &#123;&#125; deg&quot;</span>.<span class="built_in">format</span>(i))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;RAAN: &#123;&#125; deg&quot;</span>.<span class="built_in">format</span>(RAAN))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Mean anomaly: &#123;&#125; deg&quot;</span>.<span class="built_in">format</span>(M))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Argument of periapsis: &#123;&#125; deg&quot;</span>.<span class="built_in">format</span>(peri))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Time: &#123;&#125;&quot;</span>.<span class="built_in">format</span>( t[<span class="number">0</span>] ))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Find the state vector of the statellite&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Position: X,Y,Z &quot;</span> , flush=<span class="literal">True</span>)</span><br><span class="line">    pos_answer = <span class="built_in">input</span>( )</span><br><span class="line">    p = str_to_vec( pos_answer )</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Velocity: Vx,Vy,Vz&quot;</span>, flush=<span class="literal">True</span>)</span><br><span class="line">    vel_answer = <span class="built_in">input</span>( ) </span><br><span class="line">    v = str_to_vec( vel_answer )</span><br><span class="line">    dP = np.linalg.norm( pos_truth - p )</span><br><span class="line">    dV = np.linalg.norm( vel_truth - v )</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;dP: &#123;&#125; dV: &#123;&#125;&quot;</span>.<span class="built_in">format</span>( dP ,dV ), flush=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">if</span>( dP &gt; pos_tolerance ):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Position incorrect&quot;</span>, flush=<span class="literal">True</span>)</span><br><span class="line">        correct = <span class="literal">False</span> </span><br><span class="line">    <span class="keyword">if</span>( dV &gt; vel_tolerance ):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Velocity incorrect&quot;</span>, flush=<span class="literal">True</span>)</span><br><span class="line">        correct = <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> correct</span><br><span class="line"></span><br><span class="line"><span class="meta">@timeout(<span class="params"> to </span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    N = <span class="number">5</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>( N ):</span><br><span class="line">        ok = single( )</span><br><span class="line">        <span class="keyword">if</span>( <span class="literal">False</span> == ok ):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Wrong&quot;</span>, flush=<span class="literal">True</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;....Later&quot;</span> , flush=<span class="literal">True</span>)</span><br><span class="line">            sys.exit(<span class="number">0</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Correct&quot;</span> , flush=<span class="literal">True</span>)</span><br><span class="line">    flag = os.getenv(<span class="string">&quot;FLAG&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Flag: &#123;&#125;&quot;</span>.<span class="built_in">format</span>( flag ) , flush=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        main()</span><br><span class="line">    <span class="keyword">except</span> TimeoutError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Timeout.....bye&quot;</span>)</span><br><span class="line">    sys.exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<p>源码分析</p>
<p>给出<strong>开普勒轨道要素</strong>与<strong>时间</strong>，让选手在给定公差内返回三维<strong>位置&#x2F;速度</strong>向量（km 和 km&#x2F;s）。</p>
<p>关键点：</p>
<ul>
<li><p>轨道参数（固定示例）：</p>
<ul>
<li>地球半径 $R_E&#x3D;6378\text{ km}$，半长轴 $a&#x3D;10R_E$</li>
<li>偏心率 $e&#x3D;0.3$，倾角 $i&#x3D;63^\circ$</li>
<li>升交点赤经 $\Omega&#x3D;25^\circ$</li>
<li>近地点幅角 $\omega&#x3D;78^\circ$</li>
<li>平近点角 $M&#x3D;10^\circ$</li>
<li>历元 $t&#x3D;$ 2022-01-01T00:00:00 UTC</li>
</ul>
</li>
<li><p>利用 <code>orbital</code> + <code>astropy</code> 构造轨道，并得到“真值” $\mathbf r,\mathbf v$（以 m、m&#x2F;s 返回，随后换算成 km、km&#x2F;s）。</p>
</li>
<li><p>用户需输入：</p>
<ul>
<li>位置 <code>X,Y,Z</code>（km）</li>
<li>速度 <code>Vx,Vy,Vz</code>（km&#x2F;s）</li>
</ul>
</li>
<li><p>评分：</p>
<ul>
<li>位置误差范数 $||\Delta \mathbf r||\le 10 \text{ km}$</li>
<li>速度误差范数 $||\Delta \mathbf v||\le 0.1 \text{ km&#x2F;s}$</li>
<li>若有一项超标，本轮失败并立刻结束；连续答对 N&#x3D;5 轮后打印环境变量 <code>FLAG</code>。</li>
</ul>
</li>
</ul>
<blockquote>
<p>换言之，参赛者只要能把给定六根数按地球二体轨道模型，转换为 ECI 坐标系下的 $\mathbf r,\mathbf v$，并满足阈值，就能通关。</p>
</blockquote>
<p>solver.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> re </span><br><span class="line"><span class="keyword">import</span> sgp4.api <span class="keyword">as</span> sp4</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> helper</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_value</span>(<span class="params"> text , preamble </span>):</span><br><span class="line">    lines = text.split(<span class="string">&quot;\n&quot;</span>) </span><br><span class="line">    out = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">        <span class="keyword">if</span>( preamble <span class="keyword">in</span> line ):</span><br><span class="line">            out = line </span><br><span class="line">    value = re.findall(<span class="string">&quot;\d+\.\d+&quot;</span>, out)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">float</span>(value[<span class="number">0</span>] )</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_date</span>(<span class="params"> text ,preamble</span>):</span><br><span class="line">    lines = text.split(<span class="string">&quot;\n&quot;</span>) </span><br><span class="line">    out = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">        <span class="keyword">if</span>( preamble <span class="keyword">in</span> line ):</span><br><span class="line">            out = line.replace(preamble,<span class="string">&quot;&quot;</span>) </span><br><span class="line">            out = out.replace(<span class="string">&quot;UTC&quot;</span>,<span class="string">&quot;&quot;</span>)</span><br><span class="line">            out = out.strip()</span><br><span class="line">            out=out+<span class="string">&quot;+0000&quot;</span></span><br><span class="line">    date = datetime.datetime.strptime( out  , <span class="string">&#x27;%Y-%m-%d %H:%M:%S%z&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> date</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mean_to_eccentic</span>(<span class="params"> M , e , tol=<span class="number">1e-5</span> </span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>( M &gt; np.pi ):</span><br><span class="line">        M0 = np.pi*<span class="number">2</span> - M </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        M0 = M </span><br><span class="line">    E_guess = np.arange( <span class="number">0</span> , np.pi , tol )</span><br><span class="line">    M_Guess =  E_guess - e*np.sin(E_guess )</span><br><span class="line"></span><br><span class="line">    dM =<span class="built_in">abs</span>( M0 - M_Guess ) </span><br><span class="line">    ind = np.argmin( dM , axis=<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">if</span>( M &gt; np.pi ):</span><br><span class="line">        E = <span class="number">2</span>*np.pi - E_guess[ind]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        E = E_guess[ind]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Eccentric anomaly is: &#123;&#125;&quot;</span>.<span class="built_in">format</span>( E))</span><br><span class="line">    <span class="keyword">return</span> E</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_single</span>(<span class="params"> sock </span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Trying to solve&quot;</span>, flush=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    challenge = sock.read_until([<span class="string">&quot;Find&quot;</span> ,<span class="string">&quot;Flag&quot;</span>,<span class="string">&quot;Wrong&quot;</span>])</span><br><span class="line">    <span class="built_in">print</span>(challenge , flush=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">if</span>( <span class="string">&quot;Wrong&quot;</span> <span class="keyword">in</span> challenge):</span><br><span class="line">        sys.exit(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">if</span>( <span class="string">&quot;Flag&quot;</span> <span class="keyword">in</span> challenge):</span><br><span class="line">        <span class="built_in">print</span>(sock.get_remaining() , flush=<span class="literal">True</span>)</span><br><span class="line">        sys.exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    a = get_value( challenge , <span class="string">&quot;semi-major&quot;</span>)</span><br><span class="line">    e = get_value( challenge , <span class="string">&quot;eccentricity&quot;</span>)</span><br><span class="line">    i = get_value( challenge , <span class="string">&quot;inc&quot;</span>)</span><br><span class="line">    RAAN = get_value( challenge , <span class="string">&quot;RAAN&quot;</span>)</span><br><span class="line">    peri  = get_value(challenge, <span class="string">&quot;Argument&quot;</span>)</span><br><span class="line">    M = get_value(challenge, <span class="string">&quot;Mean&quot;</span>)</span><br><span class="line">    mu = <span class="number">398600.4418</span>  <span class="comment"># km^3 / s^2</span></span><br><span class="line">    <span class="comment">#d  = get_date( challenge , &quot;Time:&quot;)</span></span><br><span class="line">    inc = np.deg2rad( i )</span><br><span class="line">    E = mean_to_eccentic( np.deg2rad(M),  e )</span><br><span class="line">    TA = np.arccos( (np.cos(E)-e)/(<span class="number">1</span>- e*np.cos(E)))</span><br><span class="line">    <span class="built_in">print</span>( <span class="string">&quot;True Anomaly is:  &#123;&#125;&quot;</span>.<span class="built_in">format</span>( TA ))</span><br><span class="line">    R = np.deg2rad( RAAN )</span><br><span class="line">    W = np.deg2rad( peri ) + TA </span><br><span class="line">    </span><br><span class="line">    r = a*(<span class="number">1</span>- e*np.cos(E))</span><br><span class="line">    v = np.sqrt( mu * ( (<span class="number">2</span>/r) - (<span class="number">1</span>/a) ) )</span><br><span class="line">    fpa = np.arctan( e*np.sin(TA ) / (<span class="number">1</span>+ e*np.cos(TA)))</span><br><span class="line">    <span class="keyword">if</span>( TA &gt; np.pi ):</span><br><span class="line">        fpa = -fpa</span><br><span class="line">    D1 = np.array( [np.cos(-W), np.sin(-W), <span class="number">0</span> , -np.sin(-W), np.cos(-W) , <span class="number">0</span> ,<span class="number">0</span> ,<span class="number">0</span> , <span class="number">1</span>]) <span class="comment"># true anomaly rotation and argp</span></span><br><span class="line">    D2 = np.array( [<span class="number">1</span> , <span class="number">0</span>, <span class="number">0</span> , <span class="number">0</span>, np.cos(-inc) , np.sin(-inc) , <span class="number">0</span>, -np.sin(-inc), np.cos(-inc)] ) <span class="comment"># incl rotation</span></span><br><span class="line">    D3 = np.array( [np.cos(-R), np.sin(-R), <span class="number">0</span> , -np.sin(-R), np.cos(-R) , <span class="number">0</span> ,<span class="number">0</span> ,<span class="number">0</span> , <span class="number">1</span>]) <span class="comment"># RAAN rotation</span></span><br><span class="line"></span><br><span class="line">    D1 = D1.reshape(<span class="number">3</span>,<span class="number">3</span>)</span><br><span class="line">    D2 = D2.reshape(<span class="number">3</span>,<span class="number">3</span>)</span><br><span class="line">    D3 = D3.reshape(<span class="number">3</span>,<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">    rot = np.matmul( D3, np.matmul( D2, D1 ))</span><br><span class="line">    rot2 = rot.transpose() </span><br><span class="line">    <span class="built_in">print</span>( <span class="string">&quot;FPA is &#123;&#125;&quot;</span>.<span class="built_in">format</span>( fpa))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Velocity is: &#123;&#125;&quot;</span>.<span class="built_in">format</span>( v))</span><br><span class="line">    v_r = v * np.sin( fpa )</span><br><span class="line">    v_w = v * np.cos( fpa )</span><br><span class="line">    R_VEC = np.array([r , <span class="number">0</span> , <span class="number">0</span> ])</span><br><span class="line">    V_VEC = np.array([v_r , v_w , <span class="number">0</span> ])</span><br><span class="line">    R_VEC = R_VEC.reshape(<span class="number">3</span>,<span class="number">1</span>)</span><br><span class="line">    V_VEC = V_VEC.reshape(<span class="number">3</span>,<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>( V_VEC )</span><br><span class="line"></span><br><span class="line">    position = np.matmul( rot , R_VEC ).reshape(<span class="number">1</span>,<span class="number">3</span>)</span><br><span class="line">    velocity = np.matmul( rot,V_VEC).reshape(<span class="number">1</span>,<span class="number">3</span>)</span><br><span class="line">    position = position[<span class="number">0</span>]</span><br><span class="line">    velocity = velocity[<span class="number">0</span>]</span><br><span class="line">    pos = <span class="string">&quot;&#123;&#125;,&#123;&#125;,&#123;&#125;\n&quot;</span>.<span class="built_in">format</span>( position[<span class="number">0</span>], position[<span class="number">1</span>], position[<span class="number">2</span>])</span><br><span class="line">    vel = <span class="string">&quot;&#123;&#125;,&#123;&#125;,&#123;&#125;\n&quot;</span>.<span class="built_in">format</span>( velocity[<span class="number">0</span>], velocity[<span class="number">1</span>], velocity[<span class="number">2</span>])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;I think the position is: &#123;&#125;&quot;</span>.<span class="built_in">format</span>( pos), flush=<span class="literal">True</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;I think the velocity is: &#123;&#125;&quot;</span>.<span class="built_in">format</span>( vel ), flush=<span class="literal">True</span>)</span><br><span class="line">  </span><br><span class="line">    sock.send( pos )</span><br><span class="line">    sock.send( vel)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">batch_solve</span>(<span class="params">host, port </span>):</span><br><span class="line">    s = helper.TcpReader( host,  port )</span><br><span class="line">    ticket = os.getenv(<span class="string">&quot;CHAL_TICKET&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span>( ticket  != <span class="literal">None</span> ):</span><br><span class="line">        s.read_until(<span class="string">&quot;Ticket please:&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Sending ticket - &#123;&#125;&quot;</span>.<span class="built_in">format</span>( ticket ), flush=<span class="literal">True</span>)</span><br><span class="line">        s.send( ticket)</span><br><span class="line">        s.send( <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        ticket_sent = <span class="literal">True</span></span><br><span class="line">    </span><br><span class="line">    keep_going = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">while</span>( keep_going ):</span><br><span class="line">        solve_single(s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    host = <span class="string">&#x27;10.249.10.107&#x27;</span></span><br><span class="line">    port = <span class="number">12345</span></span><br><span class="line">    batch_solve( host , port ) </span><br></pre></td></tr></table></figure>

<p>解题脚本流程：</p>
<ol>
<li><p>从环境变量获取连接参数：<code>CHAL_HOST</code>、<code>CHAL_PORT</code>。若有工单&#x2F;凭证 <code>CHAL_TICKET</code>，先按服务端提示发送。</p>
</li>
<li><p>轮询读取服务端的挑战文本，判断三种情形：</p>
<ul>
<li>含 <code>Wrong</code>：退出（上一轮答错）</li>
<li>含 <code>Flag</code>：读取并打印剩余内容，退出（通关）</li>
<li>含 <code>Find</code>：这是题面，进入求解。</li>
</ul>
</li>
<li><p>解析题面中的数值：<code>semi-major</code>、<code>eccentricity</code>、<code>inc</code>（倾角）、<code>RAAN</code>、<code>Argument</code>（近地点幅角）、<code>Mean</code>（平近点角）。</p>
</li>
<li><p>以标准地球引力常数 $\mu&#x3D;398600.4418,\text{km}^3&#x2F;\text{s}^2$ 进行<strong>二体问题</strong>求解：</p>
<ul>
<li>$M\to E$（平近点角到偏近点角）</li>
<li>$E\to \nu$（偏近点角到真近点角）</li>
<li>$a,e,\nu\to r,v$（轨道半径与速度模长）</li>
<li>计算<strong>飞行路径角</strong> $\gamma$（Flight Path Angle, FPA），把 (v) 分解为径向与切向分量 $v_r,v_t$</li>
<li>用旋转矩阵把**轨道平面坐标系（PQW&#x2F;Perifocal）**矢量转到 <strong>ECI</strong></li>
</ul>
</li>
<li><p>把得到的 <code>position</code>、<code>velocity</code> 以 “逗号分隔+换行” 的格式回发。</p>
</li>
</ol>
<p>数学推导与公式说明</p>
<p>轨道六根数回顾</p>
<p>给定地球二体模型下的六根数：<br>$$(a, e, i, \Omega, \omega, M)$$<br>其中 $a$ 半长轴、$e$ 偏心率、$i$ 倾角、$\Omega$ 升交点赤经、$\omega$ 近地点幅角、$M$ 平近点角。假设历元即题面时间（脚本中未做历元传播）。</p>
<p>Kepler 方程：求偏近点角 $E$</p>
<p>Kepler 方程（椭圆轨道）：<br>$$M &#x3D; E - e\sin E \quad (0\le E &lt; 2\pi)$$<br>解题脚本函数 <code>mean_to_eccentic(M,e,tol)</code> 用网格枚举在 $[0,\pi]$ 以 <code>tol</code> 为步长近似求解，并对 $M&gt;\pi$ 做对称处理。虽然不如牛顿法精确高效，但在该题误差阈值下通常足够。</p>
<p>偏近点角 $E$ 到真近点角 $\nu$</p>
<p>脚本采用：<br>$$\nu&#x3D;\arccos\left(\frac{\cos E - e}{1-e\cos E}\right)$$<br>然后根据 $M$ 的半周期对称性处理符号&#x2F;象限问题（通过后续对飞行路径角的符号进行修正）。更稳健的办法是用半角公式配合 <code>atan2</code>：<br>$$\tan\frac{\nu}{2}&#x3D;\sqrt{\frac{1+e}{1-e}}\tan\frac{E}{2},\quad<br>\nu&#x3D;2\ \mathrm{atan2}\left(\sqrt{1+e}\sin\frac{E}{2},\ \sqrt{1-e}\cos\frac{E}{2}\right)$$<br><code>atan2</code> 能自动处理象限。</p>
<p>轨道半径 $r$ 与速度模长 $v$</p>
<ul>
<li>轨道半径（椭圆几何关系）：<br>$$r &#x3D; a(1-e\cos E)$$<br>也可写成<br>$$r&#x3D;\frac{p}{1+e\cos\nu},\quad p&#x3D;a(1-e^2)$$</li>
<li>由 <strong>Vis-Viva 方程</strong> 得速度模长：<br>$$v&#x3D;\sqrt{\mu\left(\frac{2}{r}-\frac{1}{a}\right)}$$</li>
</ul>
<p>飞行路径角 $\gamma$ 与速度分解</p>
<p>脚本用：<br>$$\gamma&#x3D;\arctan\left(\frac{e\sin\nu}{1+e\cos\nu}\right)$$<br>若 $\nu&gt;\pi$ 则取负号（相当于在远地点后半周速度方向的径向分量变号）。这与经典关系一致：<br>$$v_r &#x3D; v\sin\gamma,\qquad v_t &#x3D; v\cos\gamma$$<br>用更“教科书”的表达是（直接用 $p&#x3D;a(1-e^2)$）：<br>$$v_r&#x3D;\sqrt{\frac{\mu}{p}}e\sin\nu,\qquad<br>v_t&#x3D;\sqrt{\frac{\mu}{p}}(1+e\cos\nu)$$<br>两种写法等价；脚本选择先求 $v$ 再按 $\gamma$ 分解。</p>
<p>坐标系与旋转（PQW → ECI）</p>
<ul>
<li><strong>PQW&#x2F;Perifocal</strong>（轨道平面）坐标系：<br>$ \hat{\mathbf p} $ 指向近地点、$ \hat{\mathbf q} $ 为轨道切向、$ \hat{\mathbf w}&#x3D;\hat{\mathbf p}\times\hat{\mathbf q} $ 指出轨道面法向。</li>
<li><strong>ECI</strong>：惯性坐标系（地球赤道春分点为参考）。</li>
</ul>
<p>标准从 PQW 到 ECI 的方向余弦矩阵（DCM）是：<br>$$\mathbf C_{PQW\to ECI} &#x3D; R_3(-\Omega),R_1(-i),R_3(-\omega),$$<br>其中<br>$$R_3(\theta)&#x3D;<br>\begin{bmatrix}<br>\cos\theta&amp;\sin\theta&amp;0\newline<br>-\sin\theta&amp;\cos\theta&amp;0\newline<br>0&amp;0&amp;1<br>\end{bmatrix},\quad<br>R_1(\phi)&#x3D;<br>\begin{bmatrix}<br>1&amp;0&amp;0\newline<br>0&amp;\cos\phi&amp;\sin\phi\newline<br>0&amp;-\sin\phi&amp;\cos\phi<br>\end{bmatrix}$$</p>
<p>脚本做了一个<strong>等效</strong>变换：先把真近点角 $\nu$ 并入到第一步旋转<br>$$W &#x3D; \omega + \nu$$<br>然后使用<br>$$\mathbf{rot} &#x3D; R_3(-\Omega),R_1(-i),R_3(-W)$$<br>再令<br>$$\mathbf r_{PQW} &#x3D; \begin{bmatrix} r \newline 0 \newline 0\end{bmatrix},\quad<br>\mathbf v_{PQW} &#x3D; \begin{bmatrix} v_r \newline v_t \newline 0\end{bmatrix}$$<br>最后<br>$$\mathbf r_{ECI}&#x3D;\mathbf{rot},\mathbf r_{PQW},\qquad<br>\mathbf v_{ECI}&#x3D;\mathbf{rot},\mathbf v_{PQW}$$<br>这是完全正确的：将 $\nu$ 并到最后一个 $R_3$ 里等价于先在 PQW 里绕 $\hat{\mathbf w}$ 旋转 $\nu$ 后再做三旋。脚本中 <code>D1,D2,D3</code> 正是这三步的矩阵展开。</p>
<blockquote>
<p>小结：<strong>位置</strong>在 PQW 中位于 $x$ 轴（近地点方向），<strong>速度</strong>在 PQW 中由 $(v_r,v_t,0)$ 表示，随后一次旋转到 ECI。</p>
</blockquote>
<p>脚本实现细节与注意事项</p>
<p>文本解析（<code>get_value</code>，<code>get_date</code>）</p>
<ul>
<li><p><code>get_value(text, preamble)</code>：逐行寻找包含关键前缀的行，用正则 <code>\d+\.\d+</code> 抓取<strong>第一个小数</strong>并转为 <code>float</code>。</p>
<ul>
<li>局限：不支持<strong>整数</strong>（如 <code>10</code> 没有小数点）、负数、科学计数法；若行里有多个数字，它只取第一个。</li>
<li>但题面格式固定、均为小数形式，因此能用。</li>
</ul>
</li>
<li><p><code>get_date</code> 未使用（被注释掉），题面给的时间只作为展示，脚本假定当前历元即题面时间，因此不做传播。</p>
</li>
</ul>
<p>Kepler 方程求解（<code>mean_to_eccentic</code>）</p>
<ul>
<li>采用<strong>网格搜索</strong>（步长 <code>tol</code>），并用对称性把 $[0,2\pi)$ 的问题折半到 $[0,\pi]$。</li>
<li>精度由 <code>tol</code> 控制；容差适当即可满足误差阈值。</li>
</ul>
<p>姿态旋转矩阵构造</p>
<ul>
<li>构造 <code>D1=R3(-W)</code>、<code>D2=R1(-i)</code>、<code>D3=R3(-Ω)</code>，并按 <code>rot = D3 @ (D2 @ D1)</code> 相乘（从右到左依次作用）。</li>
<li>然后 <code>r=rot @ [r,0,0]^T</code>，<code>v=rot @ [v_r,v_t,0]^T</code>，得到 ECI 坐标。</li>
</ul>
<p>解题思路</p>
<ul>
<li><strong>读题面 → 解析六根数</strong></li>
<li><strong>求 $E$</strong>：解 $M&#x3D;E-e\sin E$</li>
<li><strong>求 $\nu$</strong>：由 $E$ 得到真近点角</li>
<li><strong>求 $r,v$</strong>：$r&#x3D;a(1-e\cos E)$，$v&#x3D;\sqrt{\mu(2&#x2F;r-1&#x2F;a)}$</li>
<li><strong>分解速度</strong>：$(v_r,v_t)&#x3D;(v\sin\gamma,,v\cos\gamma)$ 或直接用 $\sqrt{\mu&#x2F;p}$ 公式</li>
<li><strong>坐标变换</strong>：$\mathbf r&#x3D;\mathbf{rot}[r,0,0]^T$，$\mathbf v&#x3D;\mathbf{rot}[v_r,v_t,0]^T$，其中<br>$\mathbf{rot}&#x3D;R_3(-\Omega)R_1(-i)R_3(-(\omega+\nu))$</li>
<li><strong>按协议回填</strong>：格式 <code>x,y,z\n</code> 与 <code>vx,vy,vz\n</code></li>
<li><strong>循环处理直至拿到 Flag</strong></li>
</ul>
<h1 id="其他太空信息安全挑战"><a href="#其他太空信息安全挑战" class="headerlink" title="其他太空信息安全挑战"></a>其他太空信息安全挑战</h1><h2 id="mission"><a href="#mission" class="headerlink" title="mission"></a>mission</h2><p>构建challenge镜像</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build challenge -t mission:challenge</span><br></pre></td></tr></table></figure>

<p>然后</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">socat -v tcp-listen:31344,reuseaddr exec:&quot;docker run --rm -i -e SEED=1234 -e FLAG=flag&#123;1234&#125;  mission\:challenge&quot;</span><br></pre></td></tr></table></figure>

<p>后面就能通过nc与31344端口交互</p>
<p>这是一道关于侦察卫星的挑战题，在给定的背景下，要求制订该卫星的任务规划，实现拍摄并下传特定目标的目的。</p>
<p>用nc连接靶机后会获取很长一段提示信息：<br>（1）基本信息：侦察卫星是USA 224，给出了当前时刻，侦察卫星的TLE，要侦察的目标（伊朗航天港）的经纬度，要求参赛者指定一个卫星拍照计划，从指定时间开始，在48h内取得目标的图像信息，并回传到地面站；还给出了地面站（美国阿拉斯加州费尔班克斯地面站）的坐标，要求图像数据量为120MB</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">##########################</span><br><span class="line">Mission Planning Challenge</span><br><span class="line">##########################</span><br><span class="line">给出了当前时刻</span><br><span class="line">The current time is April 22, 2020 at midnight (2020-04-22T00:00:00Z).</span><br><span class="line">给出了侦察目标（伊朗航天港）</span><br><span class="line">We need to obtain images of the Iranian space port (35.234722 N 53.920833 E) with our satellite within the next 48 hours.</span><br><span class="line">要求设计一个计划用来对目标拍照，同时下传照片</span><br><span class="line">You must design a mission plan that obtains the images and downloads them within the time frame without causing any system failures on the spacecraft, or putting it at risk of continuing operations.</span><br><span class="line">给出了侦察卫星的TLE</span><br><span class="line">The spacecraft in question is USA 224 in the NORAD database with the following TLE:</span><br><span class="line"></span><br><span class="line">1 37348U 11002A   20053.50800700  .00010600  00000-0  95354-4 0    09</span><br><span class="line">2 37348  97.9000 166.7120 0540467 271.5258 235.8003 14.76330431    04</span><br><span class="line"></span><br><span class="line">The TLE and all locations are already known by the simulator, and are provided for your information only.</span><br><span class="line"></span><br><span class="line">Requirements</span><br><span class="line">############</span><br><span class="line">给出了要求的照片大小及接收照片的地面站（美国阿拉斯加州费尔班克斯地面站）的坐标</span><br><span class="line">You need to obtain 120 MB of image data of the target location and downlink it to our ground station in Fairbanks, AK (64.977488 N 147.510697 W).</span><br><span class="line">要求给出48h的卫星任务规划</span><br><span class="line">Your mission will begin at 2020-04-22T00:00:00Z and last 48 hours.</span><br><span class="line">You are submitting a mission plan to a simulator that will ensure the mission plan will not put the spacecraft at risk, and will accomplish the desired objectives.</span><br></pre></td></tr></table></figure>

<p>（2）任务规划格式：每行是一个任务，格式是日期+时间+模式，其中由于模拟器的原因，时间中的“秒”总是为0.卫星平台有以下4种模式。</p>
<ul>
<li>sun_point：太阳能帆板对准太阳，开始充电。</li>
<li>imaging：拍照。</li>
<li>data_downlink：下传照片。</li>
<li>wheel_desaturate：轮去饱和，即使用机载磁传感器使航天器反作用轮去饱和，其中反作用轮用于控制卫星姿态。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">Mission Plan</span><br><span class="line">############</span><br><span class="line">Enter the mission plan into the interface, where each line corresponds to an entry.</span><br><span class="line">You can copy/paste multiple lines at once into the interface.</span><br><span class="line">给出了规划的格式，因为模拟器每分钟执行一次，所以时间种的“秒”总是为0</span><br><span class="line">The simulation runs once per minute, so all entries must have 00 for the seconds field.</span><br><span class="line">Each line must be a timestamp followed by the mode with the format:</span><br><span class="line"></span><br><span class="line">2020-04-22T00:00:00Z sun_point</span><br><span class="line">YYYY-MM-DDThh:mm:00Z next_mode</span><br><span class="line">...</span><br><span class="line">要注意确保平台在此期间是可用的</span><br><span class="line">The mission will run for it&#x27;s full duration, regardless of when the image data if obtained.</span><br><span class="line">You must ensure the bus survives the entire duration.</span><br><span class="line"></span><br><span class="line">Mode Information</span><br><span class="line">################</span><br><span class="line">平台有4种模式</span><br><span class="line">The bus has 4 possible modes:</span><br><span class="line"></span><br><span class="line">- sun_point: Charges the batteries by pointing the panels at the sun.</span><br><span class="line">- imaging: Trains the imager on the target location and begins capturing image data.</span><br><span class="line">- data_downlink: Slews the spacecraft to point it&#x27;s high bandwidth downlink transmitter at the ground station and transmits data to the station.</span><br><span class="line">- wheel_desaturate: Desaturates the spacecraft reaction wheels using the on board magnetorquers.</span><br><span class="line"></span><br><span class="line">Each mode dictates the entire state of the spacecraft.</span><br><span class="line">The required inputs for each mode are already known by the mission planner.</span><br></pre></td></tr></table></figure>

<p>（3）卫星平台信息</p>
<ul>
<li>星载计算机有95MB存储空间，也就是说要拍两次以上才能满足120MB的要求。</li>
<li>所有组件有效工作温度是0-60摄氏度。</li>
<li>反作用轮的最大速度是7000RPM。</li>
<li>在任务执行过程种每分钟会收到一组遥测信息。</li>
<li>需要依据遥测信息不断调整模式，确保卫星平台始终可用。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Bus Information</span><br><span class="line">###############</span><br><span class="line">The onboard computer has 95 MB of storage.</span><br><span class="line">All bus components are rated to operate effectively between 0 and 60 degrees Celsius.</span><br><span class="line">The battery cannot fall below 10% capacity, or it will reduce the life of the spacecraft.</span><br><span class="line">The reaction wheels have a maximum speed of 7000 RPM.</span><br><span class="line">You will received telemetry from the spacecraft throughout the simulated mission duration.</span><br><span class="line">You will need to monitor this telemetry to derive the behavior of each mode.</span><br><span class="line"></span><br><span class="line">########################################################################</span><br></pre></td></tr></table></figure>

<p>（4）对参赛者输入的要求<br>按照日期+时间+模式的格式，一行一行输入卫星任务规划。输入“run”，开始模拟执行该卫星任务规划，验证是否可以按照要求得到目标的图像信息。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Please input mission plan in order by time.</span><br><span class="line">Each line must be a timestamp followed by the mode with the format:</span><br><span class="line"></span><br><span class="line">                    YYYY-MM-DDThh:mm:ssZ new_mode</span><br><span class="line"></span><br><span class="line">Usage:</span><br><span class="line"></span><br><span class="line">   run  -- Starts simulation</span><br><span class="line">   plan -- Lists current plan entries</span><br><span class="line">   exit -- Exits</span><br><span class="line"></span><br><span class="line">Once your plan is executed, it will not be saved, so make note of your plan elsewhere.</span><br></pre></td></tr></table></figure>

<p>构建solver环境</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build solver -t mission:solver</span><br></pre></td></tr></table></figure>

<p>测试</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">socat -v tcp-listen:31344,reuseaddr exec:&quot;docker run --rm -i -e SEED=1234 -e FLAG=flag&#123;1234&#125;  mission\:challenge&quot;</span><br><span class="line"></span><br><span class="line">docker run --rm -e HOST=172.17.0.1 -e PORT=31344 mission:solver</span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://sakuraraindrop.github.io">cheng_xing</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://sakuraraindrop.github.io/2025/10/09/hackasat-2020-quals/">https://sakuraraindrop.github.io/2025/10/09/hackasat-2020-quals/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://sakuraraindrop.github.io" target="_blank">cheng_xing's blog</a>！</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/img/ltx.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related  no-desc" href="/2025/10/02/20251002%E8%AE%BA%E6%96%87%E7%B2%BE%E8%AF%BB/" title="20251002论文精读"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">20251002论文精读</div></div></div></a><a class="pagination-related  no-desc" href="/2025/10/17/reverse-learning/" title="reverse-learning"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">reverse-learning</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/ltx.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">cheng_xing</div><div class="author-info-description">web菜鸡修炼中</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">61</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">147</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/sakuraraindrop"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/sakuraraindrop" target="_blank" title="Github"><i class="fab fa-github" style="color: #hdhfbb;"></i></a><a class="social-icon" href="https://space.bilibili.com/504596197" target="_blank" title="Bilibili"><i class="fab fa-bilibili" style="color: #000000;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%AB%E6%98%9F%E5%B9%B3%E5%8F%B0%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8"><span class="toc-number">1.</span> <span class="toc-text">卫星平台信息安全</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#bus"><span class="toc-number">1.1.</span> <span class="toc-text">bus</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9C%B0%E9%9D%A2%E6%AE%B5%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8"><span class="toc-number">2.</span> <span class="toc-text">地面段信息安全</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#verizon"><span class="toc-number">2.1.</span> <span class="toc-text">verizon</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#goose"><span class="toc-number">2.2.</span> <span class="toc-text">goose</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%80%9A%E4%BF%A1%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8"><span class="toc-number">3.</span> <span class="toc-text">通信系统信息安全</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#phasor"><span class="toc-number">3.1.</span> <span class="toc-text">phasor</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A4%A9%E4%BD%93%E6%B5%8B%E9%87%8F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8"><span class="toc-number">4.</span> <span class="toc-text">天体测量信息安全</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#matters-of-state"><span class="toc-number">4.1.</span> <span class="toc-text">matters_of_state</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E5%A4%AA%E7%A9%BA%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%8C%91%E6%88%98"><span class="toc-number">5.</span> <span class="toc-text">其他太空信息安全挑战</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#mission"><span class="toc-number">5.1.</span> <span class="toc-text">mission</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/17/reverse-learning/" title="reverse-learning">reverse-learning</a><time datetime="2025-10-17T04:52:59.000Z" title="发表于 2025-10-17 12:52:59">2025-10-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/09/hackasat-2020-quals/" title="hackasat-2020-quals">hackasat-2020-quals</a><time datetime="2025-10-09T06:51:05.000Z" title="发表于 2025-10-09 14:51:05">2025-10-09</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/02/20251002%E8%AE%BA%E6%96%87%E7%B2%BE%E8%AF%BB/" title="20251002论文精读">20251002论文精读</a><time datetime="2025-10-02T09:04:55.000Z" title="发表于 2025-10-02 17:04:55">2025-10-02</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/30/hackasat-2022-quals/" title="hackasat-2022-quals">hackasat-2022-quals</a><time datetime="2025-09-30T12:06:48.000Z" title="发表于 2025-09-30 20:06:48">2025-09-30</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/27/20250927%E9%9A%8F%E7%BC%98%E5%88%B7%E9%A2%98/" title="20250927随缘刷题">20250927随缘刷题</a><time datetime="2025-09-27T04:45:15.000Z" title="发表于 2025-09-27 12:45:15">2025-09-27</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/hk.jpg);"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;2025 By cheng_xing</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.0-b1</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const loadMathjax = () => {
    if (!window.MathJax) {
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          tags: 'none',
        },
        chtml: {
          scale: 1.1
        },
        options: {
          enableMenu: true,
          renderActions: {
            findScript: [10, doc => {
              for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
                const display = !!node.type.match(/; *mode=display/)
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
                const text = document.createTextNode('')
                node.parentNode.replaceChild(text, node)
                math.start = {node: text, delim: '', n: 0}
                math.end = {node: text, delim: '', n: 0}
                doc.math.push(math)
              }
            }, '']
          }
        }
      }

      const script = document.createElement('script')
      script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
      script.id = 'MathJax-script'
      script.async = true
      document.head.appendChild(script)
    } else {
      MathJax.startup.document.state(0)
      MathJax.texReset()
      MathJax.typesetPromise()
    }
  }

  btf.addGlobalFn('encrypt', loadMathjax, 'mathjax')
  window.pjax ? loadMathjax() : window.addEventListener('load', loadMathjax)
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>